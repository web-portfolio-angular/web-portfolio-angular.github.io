!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UyQ7:function(t,r,i){"use strict";i.r(r),i.d(r,"CommentsModule",(function(){return q}));var o,c=i("ofXK"),a=i("3Pt+"),s=i("tyNb"),b=i("Wcq6"),m=i("fXoL"),u=i("T/S4"),l=i("IYfF"),f=i("V86y"),d=i("zy28"),p=i("lJxs"),g=((o=function(){function t(n){e(this,t),this.firestore=n}return n(t,[{key:"transform",value:function(e){return this.firestore.getRegistration(e).pipe(Object(p.a)((function(e){return e.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())}))[0].userImg})))}}]),t}()).\u0275fac=function(e){return new(e||o)(m.Lb(u.a))},o.\u0275pipe=m.Kb({name:"getImage",type:o,pure:!0}),o);function y(e,t){1&e&&m.Mb(0,"app-loading-spinner")}function h(e,t){if(1&e&&(m.Qb(0,"div",21),m.Qb(1,"div",9),m.Qb(2,"div",10),m.Mb(3,"img",11),m.ac(4,"async"),m.ac(5,"getImage"),m.Qb(6,"p",12),m.rc(7),m.Pb(),m.Pb(),m.Qb(8,"p",13),m.rc(9),m.ac(10,"date"),m.ac(11,"date"),m.Pb(),m.Pb(),m.Qb(12,"div",14),m.Qb(13,"p",15),m.rc(14),m.Pb(),m.Pb(),m.Pb()),2&e){var n=t.$implicit;m.Ab(3),m.fc("src",m.bc(4,5,m.bc(5,7,n.email)),m.lc),m.Ab(4),m.tc(" ",n.name," "),m.Ab(2),m.uc(" ",m.cc(10,9,n.date.toDate(),"dd.MM.yyyy")," at ",m.cc(11,12,n.date.toDate(),"HH:mm")," "),m.Ab(5),m.sc(n.comment)}}function v(e,t){if(1&e){var n=m.Rb();m.Qb(0,"button",22),m.Xb("click",(function(){m.kc(n);var e=m.Zb().$implicit;return m.Zb().isReply=e.id})),m.rc(1,"Reply"),m.Pb()}}function A(e,t){if(1&e){var n=m.Rb();m.Qb(0,"button",22),m.Xb("click",(function(){return m.kc(n),m.Zb(2).closeReplay()})),m.rc(1,"Close Reply"),m.Pb()}}function P(e,t){if(1&e&&(m.Qb(0,"p",27),m.rc(1),m.Pb()),2&e){var n=m.Zb(3);m.Ab(1),m.sc(n.errorMsgOnReply)}}function Q(e,t){if(1&e){var n=m.Rb();m.Qb(0,"form",23),m.Xb("ngSubmit",(function(){m.kc(n);var e=m.Zb().$implicit,t=m.Zb();return t.onReply(e.id,t.replyForm)})),m.Qb(1,"div"),m.Mb(2,"textarea",24),m.Pb(),m.Qb(3,"div"),m.Qb(4,"button",25),m.rc(5,"Add your comment"),m.Pb(),m.qc(6,P,2,1,"p",26),m.Pb(),m.Pb()}if(2&e){var r=m.Zb(2);m.fc("formGroup",r.replyForm),m.Ab(4),m.fc("disabled",!r.replyForm.valid),m.Ab(2),m.fc("ngIf",r.errorMsgOnReply)}}function M(e,t){if(1&e&&(m.Qb(0,"div",8),m.Qb(1,"div",9),m.Qb(2,"div",10),m.Mb(3,"img",11),m.ac(4,"async"),m.ac(5,"getImage"),m.Qb(6,"p",12),m.rc(7),m.Pb(),m.Pb(),m.Qb(8,"p",13),m.rc(9),m.ac(10,"date"),m.ac(11,"date"),m.Pb(),m.Pb(),m.Qb(12,"div",14),m.Qb(13,"p",15),m.rc(14),m.Pb(),m.Qb(15,"div",16),m.qc(16,h,15,15,"div",17),m.Pb(),m.Qb(17,"div",18),m.qc(18,v,2,0,"button",19),m.qc(19,A,2,0,"button",19),m.Pb(),m.qc(20,Q,7,3,"form",20),m.Pb(),m.Pb()),2&e){var n=t.$implicit,r=m.Zb();m.Ab(3),m.fc("src",m.bc(4,9,m.bc(5,11,n.email)),m.lc),m.Ab(4),m.tc(" ",n.name," "),m.Ab(2),m.uc(" ",m.cc(10,13,n.date.toDate(),"dd.MM.yyyy")," at ",m.cc(11,16,n.date.toDate(),"HH:mm")," "),m.Ab(5),m.sc(n.comment),m.Ab(2),m.fc("ngForOf",n.replies),m.Ab(2),m.fc("ngIf",r.isAuth),m.Ab(1),m.fc("ngIf",r.isReply==n.id),m.Ab(1),m.fc("ngIf",r.isReply==n.id)}}function I(e,t){1&e&&(m.Qb(0,"div",28),m.Qb(1,"p"),m.rc(2,"Please Sign in to add your comment!"),m.Pb(),m.Pb())}function O(e,t){if(1&e&&(m.Qb(0,"p",27),m.rc(1),m.Pb()),2&e){var n=m.Zb(2);m.Ab(1),m.sc(n.errorMsgOnSubmit)}}function F(e,t){if(1&e&&(m.Qb(0,"p",27),m.rc(1),m.Pb()),2&e){var n=m.Zb(2);m.Ab(1),m.sc(n.errorMsgOnloadComments)}}function R(e,t){if(1&e){var n=m.Rb();m.Qb(0,"form",29),m.Xb("ngSubmit",(function(){m.kc(n);var e=m.Zb();return e.onSubmit(e.postForm)})),m.Qb(1,"div"),m.Mb(2,"textarea",30),m.Pb(),m.Qb(3,"div"),m.Qb(4,"button",25),m.rc(5,"Add your comment"),m.Pb(),m.qc(6,O,2,1,"p",26),m.Pb(),m.qc(7,F,2,1,"p",26),m.Pb()}if(2&e){var r=m.Zb();m.fc("formGroup",r.postForm),m.Ab(4),m.fc("disabled",!r.postForm.valid),m.Ab(2),m.fc("ngIf",r.errorMsgOnSubmit),m.Ab(1),m.fc("ngIf",r.errorMsgOnloadComments)}}var S,k,w=((S=function(){function t(n,r,i,o){e(this,t),this.firestore=n,this.formBuilder=r,this.authService=i,this.additionUserInfoService=o,this.isAuth=!1,this.isLoading=!1,this.isReply=null,this.errorMsgOnloadComments=null,this.errorMsgOnSubmit=null,this.errorMsgOnReply=null}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.subUser=this.authService.user.subscribe((function(t){e.isAuth=!!t})),this.additionUserInfoService.getUserAdditionalData(),this.userAdditionalDataSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe((function(t){e.userAdditionalData=t})),this.isLoading=!0,this.firestore.getComments().subscribe((function(t){e.comments=t.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())})),e.isLoading=!1,e.errorMsgOnloadComments=null}),(function(t){e.isLoading=!1,e.errorMsgOnloadComments=t.message})),this.postForm=this.formBuilder.group({commentArea:new a.d(null,a.p.required)}),this.replyForm=this.formBuilder.group({replyArea:new a.d(null,a.p.required)})}},{key:"ngOnDestroy",value:function(){this.subUser.unsubscribe(),this.userAdditionalDataSub.unsubscribe()}},{key:"onSubmit",value:function(e){var t=this;if(this.postForm.valid){var n=this.userAdditionalData[0].name,r=this.userAdditionalData[0].email,i=b.firestore.Timestamp.now();this.firestore.createComment({name:n,email:r,date:i,comment:e.value.commentArea}).then((function(){t.postForm.reset(),t.errorMsgOnSubmit=null})).catch((function(e){t.errorMsgOnSubmit=e.message}))}}},{key:"onReply",value:function(e,t){var n=this;if(this.replyForm.valid){var r=this.userAdditionalData[0].name,i=this.userAdditionalData[0].email,o=b.firestore.Timestamp.now();this.firestore.updateComment({name:r,email:i,date:o,comment:t.value.replyArea,id:e}).then((function(){n.isReply=null,n.replyForm.reset(),n.errorMsgOnReply=null})).catch((function(e){n.errorMsgOnReply=e.message}))}}},{key:"closeReplay",value:function(){this.isReply=null,this.replyForm.reset()}}]),t}()).\u0275fac=function(e){return new(e||S)(m.Lb(u.a),m.Lb(a.c),m.Lb(l.a),m.Lb(f.a))},S.\u0275cmp=m.Fb({type:S,selectors:[["app-comments"]],decls:10,vars:4,consts:[[1,"container"],[1,"comments-container",2,"position","relative"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[1,"comment-header"],[1,"comment-header-left"],[1,"comment-img",3,"src"],[1,"comment-name"],[1,"comment-date"],[1,"comment-content"],[1,"comment-content-text"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply-btns"],["class","btn-default narrow-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"reply"],[1,"btn-default","narrow-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],["class","error-msg",4,"ngIf"],[1,"error-msg"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(e,t){1&e&&(m.Qb(0,"div",0),m.Qb(1,"div",1),m.qc(2,y,1,0,"app-loading-spinner",2),m.Qb(3,"p",3),m.rc(4,"Comments"),m.Pb(),m.Qb(5,"div"),m.qc(6,M,21,19,"div",4),m.Mb(7,"hr",5),m.qc(8,I,3,0,"div",6),m.qc(9,R,8,4,"form",7),m.Pb(),m.Pb(),m.Pb()),2&e&&(m.Ab(2),m.fc("ngIf",t.isLoading),m.Ab(4),m.fc("ngForOf",t.comments),m.Ab(2),m.fc("ngIf",!t.isAuth),m.Ab(1),m.fc("ngIf",t.isAuth&&null==t.isReply))},directives:[c.l,c.k,d.a,a.q,a.l,a.g,a.b,a.k,a.e],pipes:[c.b,g,c.e],encapsulation:2}),S),C=i("PCNd"),q=((k=function t(){e(this,t)}).\u0275mod=m.Jb({type:k}),k.\u0275inj=m.Ib({factory:function(e){return new(e||k)},imports:[[c.c,C.a,a.o,s.e.forChild([{path:"",component:w}])]]}),k)}}])}();