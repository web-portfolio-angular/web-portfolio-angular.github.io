!function(){function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UyQ7:function(n,i,o){"use strict";o.r(i),o.d(i,"CommentsModule",(function(){return q}));var r,c,s,a=o("ofXK"),u=o("3Pt+"),b=o("tyNb"),m=o("Wcq6"),l=o("fXoL"),f=o("T/S4"),d=o("IYfF"),p=o("V86y"),g=o("rL3l"),h=o("B02C"),v=o("zy28"),y=o("lJxs"),R=((r=function(){function n(t){e(this,n),this.firestore=t}return t(n,[{key:"transform",value:function(e,n){return this.firestore.getRegistration(e).pipe(Object(y.a)((function(e){var t=e.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())}));switch(n){case"name":return t[0].name;case"phoneCode":return t[0].phoneCode;case"phone":return t[0].phone;case"userImg":return"url("+t[0].userImg+")"}})))}}]),n}()).\u0275fac=function(e){return new(e||r)(l.Lb(f.a))},r.\u0275pipe=l.Kb({name:"getUserInfo",type:r,pure:!0}),r),w=function(e){return{"background-image":e}},S=((c=function(){function n(t){e(this,n),this.subjectsService=t}return t(n,[{key:"ngOnInit",value:function(){var e=this;this.shownUserSub=this.subjectsService.shownUserSubject.subscribe((function(n){e.shownUser=n}))}},{key:"ngOnDestroy",value:function(){this.shownUserSub.unsubscribe()}},{key:"onShowUserInfo",value:function(e){this.subjectsService.onShowUserInfo(e)}}]),n}()).\u0275fac=function(e){return new(e||c)(l.Lb(g.a))},c.\u0275cmp=l.Fb({type:c,selectors:[["app-comment"]],inputs:{comment:"comment"},decls:14,vars:18,consts:[[1,"comment-header"],[1,"comment-header-left",3,"click"],[1,"comment-img",3,"ngStyle"],[1,"comment-name"],[1,"comment-date"],[1,"comment-content"],[1,"comment-content-text"]],template:function(e,n){1&e&&(l.Rb(0,"div",0),l.Rb(1,"div",1),l.Yb("click",(function(){return n.onShowUserInfo(n.comment.email)})),l.Mb(2,"div",2),l.bc(3,"async"),l.bc(4,"getUserInfo"),l.Rb(5,"p",3),l.wc(6),l.Qb(),l.Qb(),l.Rb(7,"p",4),l.wc(8),l.bc(9,"date"),l.bc(10,"date"),l.Qb(),l.Qb(),l.Rb(11,"div",5),l.Rb(12,"p",6),l.wc(13),l.Qb(),l.Qb()),2&e&&(l.Ab(2),l.gc("ngStyle",l.jc(16,w,l.cc(3,5,l.dc(4,7,n.comment.email,"userImg")))),l.Ab(4),l.yc(" ",n.comment.name," "),l.Ab(2),l.zc(" ",l.dc(9,10,n.comment.date.toDate(),"dd.MM.yyyy")," at ",l.dc(10,13,n.comment.date.toDate(),"HH:mm")," "),l.Ab(5),l.xc(n.comment.comment))},directives:[a.m],pipes:[a.b,R,a.e],encapsulation:2}),c),A=function(e){return{"background-image":e}},I=((s=function(){function n(t){e(this,n),this.subjectsService=t}return t(n,[{key:"ngOnInit",value:function(){}},{key:"closeUserInfo",value:function(){this.subjectsService.overlayClick()}}]),n}()).\u0275fac=function(e){return new(e||s)(l.Lb(g.a))},s.\u0275cmp=l.Fb({type:s,selectors:[["app-comment-user-info"]],inputs:{email:"email"},decls:32,vars:28,consts:[[1,"comment-user-info-container"],[1,"comment-user-info"],[1,"comment-user-info__close-btn",3,"click"],[1,"comment-user-info__avatar",3,"ngStyle"],[1,"comment-user-info__element"],[1,"comment-info-img"],["src","../../assets//img/sign/user.png"],["src","../../assets//img/sign/phone.png"],["src","../../assets//img/sign/email.png"],[3,"href"]],template:function(e,n){1&e&&(l.Rb(0,"div",0),l.Rb(1,"div",1),l.Rb(2,"div",2),l.Yb("click",(function(){return n.closeUserInfo()})),l.wc(3,"X"),l.Qb(),l.Mb(4,"div",3),l.bc(5,"async"),l.bc(6,"getUserInfo"),l.Rb(7,"div",4),l.Rb(8,"div",5),l.Mb(9,"img",6),l.Qb(),l.Rb(10,"div"),l.wc(11),l.bc(12,"async"),l.bc(13,"getUserInfo"),l.Qb(),l.Qb(),l.Rb(14,"div",4),l.Rb(15,"div",5),l.Mb(16,"img",7),l.Qb(),l.Rb(17,"div"),l.Rb(18,"span"),l.wc(19),l.bc(20,"async"),l.bc(21,"getUserInfo"),l.Qb(),l.Rb(22,"span"),l.wc(23),l.bc(24,"async"),l.bc(25,"getUserInfo"),l.Qb(),l.Qb(),l.Qb(),l.Rb(26,"div",4),l.Rb(27,"div",5),l.Mb(28,"img",8),l.Qb(),l.Rb(29,"div"),l.Rb(30,"a",9),l.wc(31),l.Qb(),l.Qb(),l.Qb(),l.Qb(),l.Qb()),2&e&&(l.Ab(4),l.gc("ngStyle",l.jc(26,A,l.cc(5,6,l.dc(6,8,n.email,"userImg")))),l.Ab(7),l.yc(" ",l.cc(12,11,l.dc(13,13,n.email,"name"))," "),l.Ab(8),l.yc(" +",l.cc(20,16,l.dc(21,18,n.email,"phoneCode"))," "),l.Ab(4),l.yc(" ",l.cc(24,21,l.dc(25,23,n.email,"phone"))," "),l.Ab(7),l.hc("href","mailto:",n.email,"",l.pc),l.Ab(1),l.xc(n.email))},directives:[a.m],pipes:[a.b,R],encapsulation:2}),s);function Q(e,n){1&e&&l.Mb(0,"app-loading-spinner")}function U(e,n){if(1&e&&(l.Rb(0,"div",16),l.Mb(1,"app-comment",10),l.Qb()),2&e){var t=n.$implicit;l.Ab(1),l.gc("comment",t)}}function M(e,n){if(1&e){var t=l.Sb();l.Rb(0,"button",17),l.Yb("click",(function(){l.oc(t);var e=l.ac().$implicit;return l.ac().isReply=e.id})),l.wc(1,"Reply "),l.Qb()}}function O(e,n){if(1&e){var t=l.Sb();l.Rb(0,"button",17),l.Yb("click",(function(){return l.oc(t),l.ac(2).closeReplay()})),l.wc(1,"Close Reply "),l.Qb()}}function k(e,n){if(1&e&&(l.Rb(0,"p",22),l.wc(1),l.Qb()),2&e){var t=l.ac(3);l.Ab(1),l.xc(t.errorMsgOnReply)}}function F(e,n){if(1&e){var t=l.Sb();l.Rb(0,"form",18),l.Yb("ngSubmit",(function(){l.oc(t);var e=l.ac().$implicit,n=l.ac();return n.onReply(e.id,n.replyForm)})),l.Rb(1,"div"),l.Rb(2,"textarea",19),l.wc(3,"            "),l.Qb(),l.Qb(),l.Rb(4,"div"),l.Rb(5,"button",20),l.wc(6,"Add your comment"),l.Qb(),l.uc(7,k,2,1,"p",21),l.Qb(),l.Qb()}if(2&e){var i=l.ac().$implicit,o=l.ac();l.gc("formGroup",o.replyForm),l.Ab(5),l.gc("disabled",!o.replyForm.valid),l.Ab(2),l.gc("ngIf",o.errorMsgOnReply&&o.isReply==i.id)}}function C(e,n){if(1&e&&(l.Rb(0,"div",9),l.Mb(1,"app-comment",10),l.Rb(2,"div",11),l.uc(3,U,2,1,"div",12),l.Qb(),l.Rb(4,"div",13),l.uc(5,M,2,0,"button",14),l.uc(6,O,2,0,"button",14),l.Qb(),l.uc(7,F,8,3,"form",15),l.Qb()),2&e){var t=n.$implicit,i=l.ac();l.Ab(1),l.gc("comment",t),l.Ab(2),l.gc("ngForOf",t.replies),l.Ab(2),l.gc("ngIf",i.isAuth),l.Ab(1),l.gc("ngIf",i.isReply==t.id),l.Ab(1),l.gc("ngIf",i.isReply==t.id)}}function j(e,n){if(1&e&&l.Mb(0,"app-comment-user-info",23),2&e){var t=l.ac();l.gc("email",t.shownUser)}}function L(e,n){1&e&&(l.Rb(0,"div",24),l.Rb(1,"p"),l.wc(2,"Please Sign in to add your comment!"),l.Qb(),l.Qb())}function D(e,n){if(1&e&&(l.Rb(0,"p",22),l.wc(1),l.Qb()),2&e){var t=l.ac(2);l.Ab(1),l.xc(t.errorMsgOnSubmit)}}function x(e,n){if(1&e&&(l.Rb(0,"p",22),l.wc(1),l.Qb()),2&e){var t=l.ac(2);l.Ab(1),l.xc(t.errorMsgOnloadComments)}}function Y(e,n){if(1&e){var t=l.Sb();l.Rb(0,"form",25),l.Yb("ngSubmit",(function(){l.oc(t);var e=l.ac();return e.onSubmit(e.postForm)})),l.Rb(1,"div"),l.Mb(2,"textarea",26),l.Qb(),l.Rb(3,"div"),l.Rb(4,"button",20),l.wc(5,"Add your comment"),l.Qb(),l.uc(6,D,2,1,"p",21),l.Qb(),l.uc(7,x,2,1,"p",21),l.Qb()}if(2&e){var i=l.ac();l.gc("formGroup",i.postForm),l.Ab(4),l.gc("disabled",!i.postForm.valid),l.Ab(2),l.gc("ngIf",i.errorMsgOnSubmit),l.Ab(1),l.gc("ngIf",i.errorMsgOnloadComments)}}var G,T,_=((G=function(){function n(t,i,o,r,c,s){e(this,n),this.firestore=t,this.formBuilder=i,this.authService=o,this.additionUserInfoService=r,this.subjectsService=c,this.generateIdService=s,this.isAuth=!1,this.isLoading=!1,this.isReply=null,this.errorMsgOnloadComments=null,this.errorMsgOnSubmit=null,this.errorMsgOnReply=null}return t(n,[{key:"ngOnInit",value:function(){var e=this;this.subUser=this.authService.user.subscribe((function(n){e.isAuth=!!n})),this.additionUserInfoService.getUserAdditionalData(),this.userAdditionalDataSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe((function(n){e.userAdditionalData=n})),this.isLoading=!0,this.firestore.getComments().subscribe((function(n){e.comments=n.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())})),e.isLoading=!1,e.errorMsgOnloadComments=null}),(function(n){e.isLoading=!1,e.errorMsgOnloadComments=n.message})),this.postForm=this.formBuilder.group({commentArea:new u.d(null,u.p.required)}),this.replyForm=this.formBuilder.group({replyArea:new u.d(null,u.p.required)}),this.shownUserSub=this.subjectsService.shownUserSubject.subscribe((function(n){e.shownUser=n})),this.showUserInfoSub=this.subjectsService.showUserInfoSubject.subscribe((function(n){e.showUserInfo=n}))}},{key:"ngOnDestroy",value:function(){this.subUser.unsubscribe(),this.userAdditionalDataSub.unsubscribe(),this.showUserInfoSub.unsubscribe(),this.shownUserSub.unsubscribe()}},{key:"onSubmit",value:function(e){var n=this;if(this.postForm.valid){var t=this.userAdditionalData[0].name,i=this.userAdditionalData[0].email,o=m.firestore.Timestamp.now(),r=e.value.commentArea.trim();""!=r?this.firestore.createComment({name:t,email:i,date:o,comment:r}).then((function(){n.postForm.reset(),n.errorMsgOnSubmit=null})).catch((function(e){n.errorMsgOnSubmit=e.message})):this.postForm.reset()}}},{key:"onReply",value:function(e,n){var t=this;if(this.replyForm.valid){var i=this.userAdditionalData[0].name,o=this.userAdditionalData[0].email,r=m.firestore.Timestamp.now(),c=n.value.replyArea.trim(),s=this.generateIdService.generateId();""!=c?this.firestore.updateComment({name:i,email:o,date:r,comment:c,id:s,commentId:e}).then((function(){t.isReply=null,t.replyForm.reset(),t.errorMsgOnReply=null})).catch((function(e){t.errorMsgOnReply=e.message})):this.replyForm.reset()}}},{key:"closeReplay",value:function(){this.isReply=null,this.replyForm.reset()}}]),n}()).\u0275fac=function(e){return new(e||G)(l.Lb(f.a),l.Lb(u.c),l.Lb(d.a),l.Lb(p.a),l.Lb(g.a),l.Lb(h.a))},G.\u0275cmp=l.Fb({type:G,selectors:[["app-comments"]],decls:11,vars:5,consts:[[1,"container"],[1,"comments-container"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[3,"email",4,"ngIf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[3,"comment"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply-btns"],["class","btn-default narrow-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"reply"],[1,"btn-default","narrow-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],["class","error-msg",4,"ngIf"],[1,"error-msg"],[3,"email"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(e,n){1&e&&(l.Rb(0,"div",0),l.Rb(1,"div",1),l.uc(2,Q,1,0,"app-loading-spinner",2),l.Rb(3,"p",3),l.wc(4,"Comments"),l.Qb(),l.Rb(5,"div"),l.uc(6,C,8,5,"div",4),l.uc(7,j,1,1,"app-comment-user-info",5),l.Qb(),l.Mb(8,"hr",6),l.uc(9,L,3,0,"div",7),l.uc(10,Y,8,4,"form",8),l.Qb(),l.Qb()),2&e&&(l.Ab(2),l.gc("ngIf",n.isLoading),l.Ab(4),l.gc("ngForOf",n.comments),l.Ab(1),l.gc("ngIf",n.showUserInfo),l.Ab(2),l.gc("ngIf",!n.isAuth),l.Ab(1),l.gc("ngIf",n.isAuth&&null==n.isReply))},directives:[a.l,a.k,v.a,S,u.q,u.l,u.g,u.b,u.k,u.e,I],encapsulation:2}),G),$=o("PCNd"),q=((T=function n(){e(this,n)}).\u0275mod=l.Jb({type:T}),T.\u0275inj=l.Ib({factory:function(e){return new(e||T)},imports:[[a.c,$.a,u.o,b.e.forChild([{path:"",component:_}])]]}),T)}}])}();