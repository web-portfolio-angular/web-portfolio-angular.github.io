!function(){function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UyQ7:function(n,i,c){"use strict";c.r(i),c.d(i,"CommentsModule",(function(){return X}));var r,o=c("ofXK"),a=c("3Pt+"),b=c("tyNb"),s=c("Wcq6"),m=c("fXoL"),u=c("T/S4"),l=c("IYfF"),f=c("V86y"),d=c("zy28"),p=c("lJxs"),g=((r=function(){function n(t){e(this,n),this.firestore=t}return t(n,[{key:"transform",value:function(e,n){return this.firestore.getRegistration(e).pipe(Object(p.a)((function(e){var t=e.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())}));switch(n){case"name":return t[0].name;case"phoneCode":return t[0].phoneCode;case"phone":return t[0].phone;case"userImg":return t[0].userImg}})))}}]),n}()).\u0275fac=function(e){return new(e||r)(m.Lb(u.a))},r.\u0275pipe=m.Kb({name:"getImage",type:r,pure:!0}),r);function v(e,n){1&e&&m.Mb(0,"app-loading-spinner")}var h=function(e){return{"background-image":e}};function y(e,n){if(1&e){var t=m.Rb();m.Qb(0,"div",22),m.Qb(1,"div",23),m.Qb(2,"div",24),m.Xb("click",(function(){return m.lc(t),m.Zb(2).closeUserInfo()})),m.sc(3,"X"),m.Pb(),m.Mb(4,"div",25),m.ac(5,"async"),m.ac(6,"getImage"),m.Qb(7,"div",26),m.Qb(8,"div",27),m.Mb(9,"img",28),m.Pb(),m.Qb(10,"div"),m.sc(11),m.ac(12,"async"),m.ac(13,"getImage"),m.Pb(),m.Pb(),m.Qb(14,"div",26),m.Qb(15,"div",27),m.Mb(16,"img",29),m.Pb(),m.Qb(17,"div"),m.Qb(18,"span"),m.sc(19),m.ac(20,"async"),m.ac(21,"getImage"),m.Pb(),m.Qb(22,"span"),m.sc(23),m.ac(24,"async"),m.ac(25,"getImage"),m.Pb(),m.Pb(),m.Pb(),m.Qb(26,"div",26),m.Qb(27,"div",27),m.Mb(28,"img",30),m.Pb(),m.Qb(29,"div"),m.Qb(30,"a",31),m.sc(31),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Qb(32,"div",32),m.Xb("click",(function(){return m.lc(t),m.Zb(2).closeUserInfo()})),m.Pb(),m.Pb()}if(2&e){var i=m.Zb().$implicit;m.Ab(4),m.fc("ngStyle",m.ic(26,h,"url("+m.bc(5,6,m.cc(6,8,i.email,"userImg"))+")")),m.Ab(7),m.uc(" ",m.bc(12,11,m.cc(13,13,i.email,"name"))," "),m.Ab(8),m.uc(" +",m.bc(20,16,m.cc(21,18,i.email,"phoneCode"))," "),m.Ab(4),m.uc(" ",m.bc(24,21,m.cc(25,23,i.email,"phone"))," "),m.Ab(7),m.gc("href","mailto:",i.email,"",m.mc),m.Ab(1),m.tc(i.email)}}function P(e,n){if(1&e){var t=m.Rb();m.Qb(0,"div",22),m.Qb(1,"div",23),m.Qb(2,"div",24),m.Xb("click",(function(){return m.lc(t),m.Zb(3).closeUserInfo()})),m.sc(3,"X"),m.Pb(),m.Mb(4,"div",25),m.ac(5,"async"),m.ac(6,"getImage"),m.Qb(7,"div",26),m.Qb(8,"div",27),m.Mb(9,"img",28),m.Pb(),m.Qb(10,"div"),m.sc(11),m.ac(12,"async"),m.ac(13,"getImage"),m.Pb(),m.Pb(),m.Qb(14,"div",26),m.Qb(15,"div",27),m.Mb(16,"img",29),m.Pb(),m.Qb(17,"div"),m.Qb(18,"span"),m.sc(19),m.ac(20,"async"),m.ac(21,"getImage"),m.Pb(),m.Qb(22,"span"),m.sc(23),m.ac(24,"async"),m.ac(25,"getImage"),m.Pb(),m.Pb(),m.Pb(),m.Qb(26,"div",26),m.Qb(27,"div",27),m.Mb(28,"img",30),m.Pb(),m.Qb(29,"div"),m.Qb(30,"a",31),m.sc(31),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Qb(32,"div",32),m.Xb("click",(function(){return m.lc(t),m.Zb(3).closeUserInfo()})),m.Pb(),m.Pb()}if(2&e){var i=m.Zb().$implicit;m.Ab(4),m.fc("ngStyle",m.ic(26,h,"url("+m.bc(5,6,m.cc(6,8,i.email,"userImg"))+")")),m.Ab(7),m.uc(" ",m.bc(12,11,m.cc(13,13,i.email,"name"))," "),m.Ab(8),m.uc(" +",m.bc(20,16,m.cc(21,18,i.email,"phoneCode"))," "),m.Ab(4),m.uc(" ",m.bc(24,21,m.cc(25,23,i.email,"phone"))," "),m.Ab(7),m.gc("href","mailto:",i.email,"",m.mc),m.Ab(1),m.tc(i.email)}}function Q(e,n){if(1&e){var t=m.Rb();m.Qb(0,"div",33),m.Qb(1,"div",9),m.Qb(2,"div",10),m.Xb("click",(function(){m.lc(t);var e=n.$implicit;return m.Zb(2).onShowUserInfo(e.id)})),m.Mb(3,"div",11),m.ac(4,"async"),m.ac(5,"getImage"),m.Qb(6,"p",12),m.sc(7),m.Pb(),m.Pb(),m.Qb(8,"p",13),m.sc(9),m.ac(10,"date"),m.ac(11,"date"),m.Pb(),m.rc(12,P,33,28,"div",14),m.Pb(),m.Qb(13,"div",15),m.Qb(14,"p",16),m.sc(15),m.Pb(),m.Pb(),m.Pb()}if(2&e){var i=n.$implicit,c=m.Zb(2);m.Ab(3),m.fc("ngStyle",m.ic(17,h,"url("+m.bc(4,6,m.cc(5,8,i.email,"userImg"))+")")),m.Ab(4),m.uc(" ",i.name," "),m.Ab(2),m.vc(" ",m.cc(10,11,i.date.toDate(),"dd.MM.yyyy")," at ",m.cc(11,14,i.date.toDate(),"HH:mm")," "),m.Ab(3),m.fc("ngIf",c.commentId==i.id&&c.showUserInfo),m.Ab(3),m.tc(i.comment)}}function I(e,n){if(1&e){var t=m.Rb();m.Qb(0,"button",34),m.Xb("click",(function(){m.lc(t);var e=m.Zb().$implicit;return m.Zb().isReply=e.id})),m.sc(1,"Reply"),m.Pb()}}function A(e,n){if(1&e){var t=m.Rb();m.Qb(0,"button",34),m.Xb("click",(function(){return m.lc(t),m.Zb(2).closeReplay()})),m.sc(1,"Close Reply"),m.Pb()}}function M(e,n){if(1&e&&(m.Qb(0,"p",39),m.sc(1),m.Pb()),2&e){var t=m.Zb(3);m.Ab(1),m.tc(t.errorMsgOnReply)}}function S(e,n){if(1&e){var t=m.Rb();m.Qb(0,"form",35),m.Xb("ngSubmit",(function(){m.lc(t);var e=m.Zb().$implicit,n=m.Zb();return n.onReply(e.id,n.replyForm)})),m.Qb(1,"div"),m.Mb(2,"textarea",36),m.Pb(),m.Qb(3,"div"),m.Qb(4,"button",37),m.sc(5,"Add your comment"),m.Pb(),m.rc(6,M,2,1,"p",38),m.Pb(),m.Pb()}if(2&e){var i=m.Zb(2);m.fc("formGroup",i.replyForm),m.Ab(4),m.fc("disabled",!i.replyForm.valid),m.Ab(2),m.fc("ngIf",i.errorMsgOnReply)}}function R(e,n){if(1&e){var t=m.Rb();m.Qb(0,"div",8),m.Qb(1,"div",9),m.Qb(2,"div",10),m.Xb("click",(function(){m.lc(t);var e=n.$implicit;return m.Zb().onShowUserInfo(e.id)})),m.Mb(3,"div",11),m.ac(4,"async"),m.ac(5,"getImage"),m.Qb(6,"p",12),m.sc(7),m.Pb(),m.Pb(),m.Qb(8,"p",13),m.sc(9),m.ac(10,"date"),m.ac(11,"date"),m.Pb(),m.rc(12,y,33,28,"div",14),m.Pb(),m.Qb(13,"div",15),m.Qb(14,"p",16),m.sc(15),m.Pb(),m.Qb(16,"div",17),m.rc(17,Q,16,19,"div",18),m.Pb(),m.Qb(18,"div",19),m.rc(19,I,2,0,"button",20),m.rc(20,A,2,0,"button",20),m.Pb(),m.rc(21,S,7,3,"form",21),m.Pb(),m.Pb()}if(2&e){var i=n.$implicit,c=m.Zb();m.Ab(3),m.fc("ngStyle",m.ic(21,h,"url("+m.bc(4,10,m.cc(5,12,i.email,"userImg"))+")")),m.Ab(4),m.uc(" ",i.name," "),m.Ab(2),m.vc(" ",m.cc(10,15,i.date.toDate(),"dd.MM.yyyy")," at ",m.cc(11,18,i.date.toDate(),"HH:mm")," "),m.Ab(3),m.fc("ngIf",c.commentId==i.id&&c.showUserInfo),m.Ab(3),m.tc(i.comment),m.Ab(2),m.fc("ngForOf",i.replies),m.Ab(2),m.fc("ngIf",c.isAuth),m.Ab(1),m.fc("ngIf",c.isReply==i.id),m.Ab(1),m.fc("ngIf",c.isReply==i.id)}}function k(e,n){1&e&&(m.Qb(0,"div",40),m.Qb(1,"p"),m.sc(2,"Please Sign in to add your comment!"),m.Pb(),m.Pb())}function w(e,n){if(1&e&&(m.Qb(0,"p",39),m.sc(1),m.Pb()),2&e){var t=m.Zb(2);m.Ab(1),m.tc(t.errorMsgOnSubmit)}}function O(e,n){if(1&e&&(m.Qb(0,"p",39),m.sc(1),m.Pb()),2&e){var t=m.Zb(2);m.Ab(1),m.tc(t.errorMsgOnloadComments)}}function F(e,n){if(1&e){var t=m.Rb();m.Qb(0,"form",41),m.Xb("ngSubmit",(function(){m.lc(t);var e=m.Zb();return e.onSubmit(e.postForm)})),m.Qb(1,"div"),m.Mb(2,"textarea",42),m.Pb(),m.Qb(3,"div"),m.Qb(4,"button",37),m.sc(5,"Add your comment"),m.Pb(),m.rc(6,w,2,1,"p",38),m.Pb(),m.rc(7,O,2,1,"p",38),m.Pb()}if(2&e){var i=m.Zb();m.fc("formGroup",i.postForm),m.Ab(4),m.fc("disabled",!i.postForm.valid),m.Ab(2),m.fc("ngIf",i.errorMsgOnSubmit),m.Ab(1),m.fc("ngIf",i.errorMsgOnloadComments)}}var Z,C,U=((Z=function(){function n(t,i,c,r){e(this,n),this.firestore=t,this.formBuilder=i,this.authService=c,this.additionUserInfoService=r,this.isAuth=!1,this.isLoading=!1,this.isReply=null,this.errorMsgOnloadComments=null,this.errorMsgOnSubmit=null,this.errorMsgOnReply=null,this.showUserInfo=!1,this.commentId=null}return t(n,[{key:"ngOnInit",value:function(){var e=this;this.subUser=this.authService.user.subscribe((function(n){e.isAuth=!!n})),this.additionUserInfoService.getUserAdditionalData(),this.userAdditionalDataSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe((function(n){e.userAdditionalData=n})),this.isLoading=!0,this.firestore.getComments().subscribe((function(n){e.comments=n.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())})),e.isLoading=!1,e.errorMsgOnloadComments=null}),(function(n){e.isLoading=!1,e.errorMsgOnloadComments=n.message})),this.postForm=this.formBuilder.group({commentArea:new a.d(null,a.p.required)}),this.replyForm=this.formBuilder.group({replyArea:new a.d(null,a.p.required)})}},{key:"ngOnDestroy",value:function(){this.subUser.unsubscribe(),this.userAdditionalDataSub.unsubscribe()}},{key:"onSubmit",value:function(e){var n=this;if(this.postForm.valid){var t=this.userAdditionalData[0].name,i=this.userAdditionalData[0].email,c=s.firestore.Timestamp.now();this.firestore.createComment({name:t,email:i,date:c,comment:e.value.commentArea}).then((function(){n.postForm.reset(),n.errorMsgOnSubmit=null})).catch((function(e){n.errorMsgOnSubmit=e.message}))}}},{key:"onReply",value:function(e,n){var t=this;if(this.replyForm.valid){var i=this.userAdditionalData[0].name,c=this.userAdditionalData[0].email,r=s.firestore.Timestamp.now(),o=n.value.replyArea,a=this.generateReplayId();this.firestore.updateComment({name:i,email:c,date:r,comment:o,id:a,commentId:e}).then((function(){t.isReply=null,t.replyForm.reset(),t.errorMsgOnReply=null})).catch((function(e){t.errorMsgOnReply=e.message}))}}},{key:"generateReplayId",value:function(){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=n.length,i=0;i<20;i++)e+=n.charAt(Math.floor(Math.random()*t));return e}},{key:"closeReplay",value:function(){this.isReply=null,this.replyForm.reset()}},{key:"onShowUserInfo",value:function(e){this.commentId=e,this.showUserInfo=!0}},{key:"closeUserInfo",value:function(){this.commentId=null,this.showUserInfo=!1}}]),n}()).\u0275fac=function(e){return new(e||Z)(m.Lb(u.a),m.Lb(a.c),m.Lb(l.a),m.Lb(f.a))},Z.\u0275cmp=m.Fb({type:Z,selectors:[["app-comments"]],decls:10,vars:4,consts:[[1,"container"],[1,"comments-container",2,"position","relative"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[1,"comment-header"],[1,"comment-header-left",3,"click"],[1,"comment-img",3,"ngStyle"],[1,"comment-name"],[1,"comment-date"],["class","comment-user-info-container",4,"ngIf"],[1,"comment-content"],[1,"comment-content-text"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply-btns"],["class","btn-default narrow-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment-user-info-container"],[1,"comment-user-info"],[1,"comment-user-info__close-btn",3,"click"],[1,"comment-user-info__avatar",3,"ngStyle"],[1,"comment-user-info__element"],[1,"comment-info-img"],["src","../../assets//img/sign/user.png"],["src","../../assets//img/sign/phone.png"],["src","../../assets//img/sign/email.png"],[3,"href"],[1,"comment-user-overlay",3,"click"],[1,"reply"],[1,"btn-default","narrow-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],["class","error-msg",4,"ngIf"],[1,"error-msg"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(e,n){1&e&&(m.Qb(0,"div",0),m.Qb(1,"div",1),m.rc(2,v,1,0,"app-loading-spinner",2),m.Qb(3,"p",3),m.sc(4,"Comments"),m.Pb(),m.Qb(5,"div"),m.rc(6,R,22,23,"div",4),m.Mb(7,"hr",5),m.rc(8,k,3,0,"div",6),m.rc(9,F,8,4,"form",7),m.Pb(),m.Pb(),m.Pb()),2&e&&(m.Ab(2),m.fc("ngIf",n.isLoading),m.Ab(4),m.fc("ngForOf",n.comments),m.Ab(2),m.fc("ngIf",!n.isAuth),m.Ab(1),m.fc("ngIf",n.isAuth&&null==n.isReply))},directives:[o.l,o.k,d.a,o.m,a.q,a.l,a.g,a.b,a.k,a.e],pipes:[o.b,g,o.e],encapsulation:2}),Z),D=c("PCNd"),X=((C=function n(){e(this,n)}).\u0275mod=m.Jb({type:C}),C.\u0275inj=m.Ib({factory:function(e){return new(e||C)},imports:[[o.c,D.a,a.o,b.e.forChild([{path:"",component:U}])]]}),C)}}])}();