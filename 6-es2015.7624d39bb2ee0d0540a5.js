(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UyQ7:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentsModule",(function(){return j}));var s=n("ofXK"),o=n("3Pt+"),r=n("tyNb"),i=n("Wcq6"),c=n("fXoL"),b=n("T/S4"),m=n("IYfF"),a=n("V86y"),u=n("rL3l"),l=n("B02C"),d=n("zy28"),p=n("odcQ");function h(e,t){if(1&e&&(c.Rb(0,"p",8),c.xc(1),c.Qb()),2&e){const e=c.ac();c.Ab(1),c.yc(e.errorMsgOnGetUser)}}const g=function(e){return{"background-image":e}};let f=(()=>{class e{constructor(e,t){this.subjectsService=e,this.firestore=t,this.errorMsgOnGetUser=null}ngOnInit(){this.shownUserSub=this.subjectsService.shownUserSubject.subscribe(e=>{this.shownUser=e})}ngOnDestroy(){this.shownUserSub.unsubscribe()}onShowUserInfo(e){this.firestore.getRegistration(e).subscribe(e=>{const t=e.map(e=>Object.assign({id:e.payload.doc.id},e.payload.doc.data()));this.subjectsService.onShowUserInfo({userImg:t[0].userImg,name:t[0].name,phoneCode:t[0].phoneCode,phone:t[0].phone,email:t[0].email}),this.errorMsgOnGetUser=null},e=>{this.errorMsgOnGetUser=e.message})}}return e.\u0275fac=function(t){return new(t||e)(c.Lb(u.a),c.Lb(b.a))},e.\u0275cmp=c.Fb({type:e,selectors:[["app-comment"]],inputs:{comment:"comment"},decls:15,vars:19,consts:[[1,"comment-header"],[1,"comment-header-left",3,"click"],[1,"comment-img",3,"ngStyle"],[1,"comment-name"],[1,"comment-date"],["class","error-msg",4,"ngIf"],[1,"comment-content"],[1,"comment-content-text"],[1,"error-msg"]],template:function(e,t){1&e&&(c.Rb(0,"div",0),c.Rb(1,"div",1),c.Yb("click",(function(){return t.onShowUserInfo(t.comment.email)})),c.Mb(2,"div",2),c.bc(3,"async"),c.bc(4,"getUserInfo"),c.Rb(5,"p",3),c.xc(6),c.Qb(),c.Qb(),c.Rb(7,"p",4),c.xc(8),c.bc(9,"date"),c.bc(10,"date"),c.Qb(),c.Qb(),c.vc(11,h,2,1,"p",5),c.Rb(12,"div",6),c.Rb(13,"p",7),c.xc(14),c.Qb(),c.Qb()),2&e&&(c.Ab(2),c.gc("ngStyle",c.kc(17,g,c.cc(3,6,c.dc(4,8,t.comment.email,"userImg")))),c.Ab(4),c.zc(" ",t.comment.name," "),c.Ab(2),c.Ac(" ",c.dc(9,11,t.comment.date.toDate(),"dd.MM.yyyy")," at ",c.dc(10,14,t.comment.date.toDate(),"HH:mm")," "),c.Ab(3),c.gc("ngIf",t.errorMsgOnGetUser),c.Ab(3),c.yc(t.comment.comment))},directives:[s.m,s.l],pipes:[s.b,p.a,s.e],encapsulation:2}),e})();const v=function(e){return{"background-image":e}};let y=(()=>{class e{constructor(e){this.subjectsService=e}ngOnInit(){}closeUserInfo(){this.subjectsService.overlayClick()}}return e.\u0275fac=function(t){return new(t||e)(c.Lb(u.a))},e.\u0275cmp=c.Fb({type:e,selectors:[["app-comment-user-info"]],inputs:{shownUser:"shownUser"},decls:22,vars:10,consts:[[1,"comment-user-info-container"],[1,"comment-user-info"],[1,"comment-user-info__close-btn",3,"click"],[1,"comment-user-info__avatar",3,"ngStyle"],[1,"comment-user-info__element"],[1,"comment-info-img"],["src","../../assets//img/sign/user.png"],["src","../../assets//img/sign/phone.png"],[3,"href"],["src","../../assets//img/sign/email.png"]],template:function(e,t){1&e&&(c.Rb(0,"div",0),c.Rb(1,"div",1),c.Rb(2,"div",2),c.Yb("click",(function(){return t.closeUserInfo()})),c.xc(3,"X"),c.Qb(),c.Mb(4,"div",3),c.Rb(5,"div",4),c.Rb(6,"div",5),c.Mb(7,"img",6),c.Qb(),c.Rb(8,"div"),c.xc(9),c.Qb(),c.Qb(),c.Rb(10,"div",4),c.Rb(11,"div",5),c.Mb(12,"img",7),c.Qb(),c.Rb(13,"div"),c.Rb(14,"a",8),c.xc(15),c.Qb(),c.Qb(),c.Qb(),c.Rb(16,"div",4),c.Rb(17,"div",5),c.Mb(18,"img",9),c.Qb(),c.Rb(19,"div"),c.Rb(20,"a",8),c.xc(21),c.Qb(),c.Qb(),c.Qb(),c.Qb(),c.Qb()),2&e&&(c.Ab(4),c.gc("ngStyle",c.kc(8,v,"url("+t.shownUser.userImg+")")),c.Ab(5),c.zc(" ",t.shownUser.name," "),c.Ab(5),c.ic("href","tel:",t.shownUser.phoneCode,"",t.shownUser.phone,"",c.qc),c.Ab(1),c.Ac("+",t.shownUser.phoneCode,"",t.shownUser.phone,""),c.Ab(5),c.hc("href","mailto:",t.shownUser.email,"",c.qc),c.Ab(1),c.yc(t.shownUser.email))},directives:[s.m],encapsulation:2}),e})();function R(e,t){1&e&&c.Mb(0,"app-loading-spinner")}function A(e,t){if(1&e&&(c.Rb(0,"div",16),c.Mb(1,"app-comment",10),c.Qb()),2&e){const e=t.$implicit;c.Ab(1),c.gc("comment",e)}}function S(e,t){if(1&e){const e=c.Sb();c.Rb(0,"button",17),c.Yb("click",(function(){c.pc(e);const t=c.ac().$implicit;return c.ac().isReply=t.id})),c.xc(1,"Reply "),c.Qb()}}function I(e,t){if(1&e){const e=c.Sb();c.Rb(0,"button",17),c.Yb("click",(function(){return c.pc(e),c.ac(2).closeReplay()})),c.xc(1,"Close Reply "),c.Qb()}}function Q(e,t){if(1&e&&(c.Rb(0,"p",22),c.xc(1),c.Qb()),2&e){const e=c.ac(3);c.Ab(1),c.yc(e.errorMsgOnReply)}}function w(e,t){if(1&e){const e=c.Sb();c.Rb(0,"form",18),c.Yb("ngSubmit",(function(){c.pc(e);const t=c.ac().$implicit,n=c.ac();return n.onReply(t.id,n.replyForm)})),c.Rb(1,"div"),c.Rb(2,"textarea",19),c.xc(3,"            "),c.Qb(),c.Qb(),c.Rb(4,"div"),c.Rb(5,"button",20),c.xc(6,"Add your comment"),c.Qb(),c.vc(7,Q,2,1,"p",21),c.Qb(),c.Qb()}if(2&e){const e=c.ac().$implicit,t=c.ac();c.gc("formGroup",t.replyForm),c.Ab(5),c.gc("disabled",!t.replyForm.valid),c.Ab(2),c.gc("ngIf",t.errorMsgOnReply&&t.isReply==e.id)}}function U(e,t){if(1&e&&(c.Rb(0,"div",9),c.Mb(1,"app-comment",10),c.Rb(2,"div",11),c.vc(3,A,2,1,"div",12),c.Qb(),c.Rb(4,"div",13),c.vc(5,S,2,0,"button",14),c.vc(6,I,2,0,"button",14),c.Qb(),c.vc(7,w,8,3,"form",15),c.Qb()),2&e){const e=t.$implicit,n=c.ac();c.Ab(1),c.gc("comment",e),c.Ab(2),c.gc("ngForOf",e.replies),c.Ab(2),c.gc("ngIf",n.isAuth),c.Ab(1),c.gc("ngIf",n.isReply==e.id),c.Ab(1),c.gc("ngIf",n.isReply==e.id)}}function M(e,t){if(1&e&&c.Mb(0,"app-comment-user-info",23),2&e){const e=c.ac();c.gc("shownUser",e.shownUser)}}function O(e,t){1&e&&(c.Rb(0,"div",24),c.Rb(1,"p"),c.xc(2,"Please Sign in to add your comment!"),c.Qb(),c.Qb())}function F(e,t){if(1&e&&(c.Rb(0,"p",22),c.xc(1),c.Qb()),2&e){const e=c.ac(2);c.Ab(1),c.yc(e.errorMsgOnSubmit)}}function x(e,t){if(1&e&&(c.Rb(0,"p",22),c.xc(1),c.Qb()),2&e){const e=c.ac(2);c.Ab(1),c.yc(e.errorMsgOnloadComments)}}function C(e,t){if(1&e){const e=c.Sb();c.Rb(0,"form",25),c.Yb("ngSubmit",(function(){c.pc(e);const t=c.ac();return t.onSubmit(t.postForm)})),c.Rb(1,"div"),c.Mb(2,"textarea",26),c.Qb(),c.Rb(3,"div"),c.Rb(4,"button",20),c.xc(5,"Add your comment"),c.Qb(),c.vc(6,F,2,1,"p",21),c.Qb(),c.vc(7,x,2,1,"p",21),c.Qb()}if(2&e){const e=c.ac();c.gc("formGroup",e.postForm),c.Ab(4),c.gc("disabled",!e.postForm.valid),c.Ab(2),c.gc("ngIf",e.errorMsgOnSubmit),c.Ab(1),c.gc("ngIf",e.errorMsgOnloadComments)}}let k=(()=>{class e{constructor(e,t,n,s,o,r){this.firestore=e,this.formBuilder=t,this.authService=n,this.additionUserInfoService=s,this.subjectsService=o,this.generateIdService=r,this.isAuth=!1,this.isLoading=!1,this.isReply=null,this.errorMsgOnloadComments=null,this.errorMsgOnSubmit=null,this.errorMsgOnReply=null}ngOnInit(){this.subUser=this.authService.user.subscribe(e=>{this.isAuth=!!e}),this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe(e=>{this.userAdditionalData=e}),this.isLoading=!0,this.firestore.getComments().subscribe(e=>{this.comments=e.map(e=>Object.assign({id:e.payload.doc.id},e.payload.doc.data())),this.isLoading=!1,this.errorMsgOnloadComments=null},e=>{this.isLoading=!1,this.errorMsgOnloadComments=e.message}),this.postForm=this.formBuilder.group({commentArea:new o.d(null,o.p.required)}),this.replyForm=this.formBuilder.group({replyArea:new o.d(null,o.p.required)}),this.shownUserSub=this.subjectsService.shownUserSubject.subscribe(e=>{this.shownUser=e}),this.showUserInfoSub=this.subjectsService.showUserInfoSubject.subscribe(e=>{this.showUserInfo=e})}ngOnDestroy(){this.subUser.unsubscribe(),this.showUserInfoSub.unsubscribe(),this.shownUserSub.unsubscribe(),this.userAdditionalInfoSub.unsubscribe()}onSubmit(e){if(!this.postForm.valid)return;const t=this.userAdditionalData[0].name,n=this.userAdditionalData[0].email,s=i.firestore.Timestamp.now(),o=e.value.commentArea.trim();""!=o?this.firestore.createComment({name:t,email:n,date:s,comment:o}).then(()=>{this.postForm.reset(),this.errorMsgOnSubmit=null}).catch(e=>{this.errorMsgOnSubmit=e.message}):this.postForm.reset()}onReply(e,t){if(!this.replyForm.valid)return;const n=this.userAdditionalData[0].name,s=this.userAdditionalData[0].email,o=i.firestore.Timestamp.now(),r=t.value.replyArea.trim(),c=this.generateIdService.generateId();""!=r?this.firestore.updateComment({name:n,email:s,date:o,comment:r,id:c,commentId:e}).then(()=>{this.isReply=null,this.replyForm.reset(),this.errorMsgOnReply=null}).catch(e=>{this.errorMsgOnReply=e.message}):this.replyForm.reset()}closeReplay(){this.isReply=null,this.replyForm.reset()}}return e.\u0275fac=function(t){return new(t||e)(c.Lb(b.a),c.Lb(o.c),c.Lb(m.a),c.Lb(a.a),c.Lb(u.a),c.Lb(l.a))},e.\u0275cmp=c.Fb({type:e,selectors:[["app-comments"]],decls:11,vars:5,consts:[[1,"container"],[1,"comments-container"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[3,"shownUser",4,"ngIf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[3,"comment"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply-btns"],["class","btn-default narrow-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"reply"],[1,"btn-default","narrow-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],["class","error-msg",4,"ngIf"],[1,"error-msg"],[3,"shownUser"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(e,t){1&e&&(c.Rb(0,"div",0),c.Rb(1,"div",1),c.vc(2,R,1,0,"app-loading-spinner",2),c.Rb(3,"p",3),c.xc(4,"Comments"),c.Qb(),c.Rb(5,"div"),c.vc(6,U,8,5,"div",4),c.vc(7,M,1,1,"app-comment-user-info",5),c.Qb(),c.Mb(8,"hr",6),c.vc(9,O,3,0,"div",7),c.vc(10,C,8,4,"form",8),c.Qb(),c.Qb()),2&e&&(c.Ab(2),c.gc("ngIf",t.isLoading),c.Ab(4),c.gc("ngForOf",t.comments),c.Ab(1),c.gc("ngIf",t.showUserInfo),c.Ab(2),c.gc("ngIf",!t.isAuth),c.Ab(1),c.gc("ngIf",t.isAuth&&null==t.isReply))},directives:[s.l,s.k,d.a,f,o.q,o.l,o.g,o.b,o.k,o.e,y],encapsulation:2}),e})();var L=n("PCNd");let j=(()=>{class e{}return e.\u0275mod=c.Jb({type:e}),e.\u0275inj=c.Ib({factory:function(t){return new(t||e)},imports:[[s.c,L.a,o.o,r.e.forChild([{path:"",component:k}])]]}),e})()}}]);