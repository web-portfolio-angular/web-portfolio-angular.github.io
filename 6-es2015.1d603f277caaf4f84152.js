(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UyQ7:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentsModule",(function(){return D}));var s=n("ofXK"),i=n("3Pt+"),c=n("tyNb"),o=n("Wcq6"),r=n("fXoL"),b=n("T/S4"),m=n("IYfF"),a=n("V86y"),u=n("rL3l"),l=n("B02C"),d=n("zy28"),p=n("lJxs");let f=(()=>{class e{constructor(e){this.firestore=e}transform(e,t){return this.firestore.getRegistration(e).pipe(Object(p.a)(e=>{const n=e.map(e=>Object.assign({id:e.payload.doc.id},e.payload.doc.data()));switch(t){case"name":return n[0].name;case"phoneCode":return n[0].phoneCode;case"phone":return n[0].phone;case"userImg":return"url("+n[0].userImg+")"}}))}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(b.a))},e.\u0275pipe=r.Kb({name:"getUserInfo",type:e,pure:!0}),e})();const g=function(e){return{"background-image":e}};let h=(()=>{class e{constructor(e){this.subjectsService=e}ngOnInit(){this.shownUserSub=this.subjectsService.shownUserSubject.subscribe(e=>{this.shownUser=e})}ngOnDestroy(){this.shownUserSub.unsubscribe()}onShowUserInfo(e){this.subjectsService.onShowUserInfo(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(u.a))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-comment"]],inputs:{comment:"comment"},decls:14,vars:18,consts:[[1,"comment-header"],[1,"comment-header-left",3,"click"],[1,"comment-img",3,"ngStyle"],[1,"comment-name"],[1,"comment-date"],[1,"comment-content"],[1,"comment-content-text"]],template:function(e,t){1&e&&(r.Rb(0,"div",0),r.Rb(1,"div",1),r.Yb("click",(function(){return t.onShowUserInfo(t.comment.email)})),r.Mb(2,"div",2),r.bc(3,"async"),r.bc(4,"getUserInfo"),r.Rb(5,"p",3),r.wc(6),r.Qb(),r.Qb(),r.Rb(7,"p",4),r.wc(8),r.bc(9,"date"),r.bc(10,"date"),r.Qb(),r.Qb(),r.Rb(11,"div",5),r.Rb(12,"p",6),r.wc(13),r.Qb(),r.Qb()),2&e&&(r.Ab(2),r.gc("ngStyle",r.jc(16,g,r.cc(3,5,r.dc(4,7,t.comment.email,"userImg")))),r.Ab(4),r.yc(" ",t.comment.name," "),r.Ab(2),r.zc(" ",r.dc(9,10,t.comment.date.toDate(),"dd.MM.yyyy")," at ",r.dc(10,13,t.comment.date.toDate(),"HH:mm")," "),r.Ab(5),r.xc(t.comment.comment))},directives:[s.m],pipes:[s.b,f,s.e],encapsulation:2}),e})();const y=function(e){return{"background-image":e}};let R=(()=>{class e{constructor(e){this.subjectsService=e}ngOnInit(){}closeUserInfo(){this.subjectsService.overlayClick()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(u.a))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-comment-user-info"]],inputs:{email:"email"},decls:32,vars:28,consts:[[1,"comment-user-info-container"],[1,"comment-user-info"],[1,"comment-user-info__close-btn",3,"click"],[1,"comment-user-info__avatar",3,"ngStyle"],[1,"comment-user-info__element"],[1,"comment-info-img"],["src","../../assets//img/sign/user.png"],["src","../../assets//img/sign/phone.png"],["src","../../assets//img/sign/email.png"],[3,"href"]],template:function(e,t){1&e&&(r.Rb(0,"div",0),r.Rb(1,"div",1),r.Rb(2,"div",2),r.Yb("click",(function(){return t.closeUserInfo()})),r.wc(3,"X"),r.Qb(),r.Mb(4,"div",3),r.bc(5,"async"),r.bc(6,"getUserInfo"),r.Rb(7,"div",4),r.Rb(8,"div",5),r.Mb(9,"img",6),r.Qb(),r.Rb(10,"div"),r.wc(11),r.bc(12,"async"),r.bc(13,"getUserInfo"),r.Qb(),r.Qb(),r.Rb(14,"div",4),r.Rb(15,"div",5),r.Mb(16,"img",7),r.Qb(),r.Rb(17,"div"),r.Rb(18,"span"),r.wc(19),r.bc(20,"async"),r.bc(21,"getUserInfo"),r.Qb(),r.Rb(22,"span"),r.wc(23),r.bc(24,"async"),r.bc(25,"getUserInfo"),r.Qb(),r.Qb(),r.Qb(),r.Rb(26,"div",4),r.Rb(27,"div",5),r.Mb(28,"img",8),r.Qb(),r.Rb(29,"div"),r.Rb(30,"a",9),r.wc(31),r.Qb(),r.Qb(),r.Qb(),r.Qb(),r.Qb()),2&e&&(r.Ab(4),r.gc("ngStyle",r.jc(26,y,r.cc(5,6,r.dc(6,8,t.email,"userImg")))),r.Ab(7),r.yc(" ",r.cc(12,11,r.dc(13,13,t.email,"name"))," "),r.Ab(8),r.yc(" +",r.cc(20,16,r.dc(21,18,t.email,"phoneCode"))," "),r.Ab(4),r.yc(" ",r.cc(24,21,r.dc(25,23,t.email,"phone"))," "),r.Ab(7),r.hc("href","mailto:",t.email,"",r.pc),r.Ab(1),r.xc(t.email))},directives:[s.m],pipes:[s.b,f],encapsulation:2}),e})();function v(e,t){1&e&&r.Mb(0,"app-loading-spinner")}function w(e,t){if(1&e&&(r.Rb(0,"div",16),r.Mb(1,"app-comment",10),r.Qb()),2&e){const e=t.$implicit;r.Ab(1),r.gc("comment",e)}}function S(e,t){if(1&e){const e=r.Sb();r.Rb(0,"button",17),r.Yb("click",(function(){r.oc(e);const t=r.ac().$implicit;return r.ac().isReply=t.id})),r.wc(1,"Reply "),r.Qb()}}function A(e,t){if(1&e){const e=r.Sb();r.Rb(0,"button",17),r.Yb("click",(function(){return r.oc(e),r.ac(2).closeReplay()})),r.wc(1,"Close Reply "),r.Qb()}}function I(e,t){if(1&e&&(r.Rb(0,"p",22),r.wc(1),r.Qb()),2&e){const e=r.ac(3);r.Ab(1),r.xc(e.errorMsgOnReply)}}function Q(e,t){if(1&e){const e=r.Sb();r.Rb(0,"form",18),r.Yb("ngSubmit",(function(){r.oc(e);const t=r.ac().$implicit,n=r.ac();return n.onReply(t.id,n.replyForm)})),r.Rb(1,"div"),r.Rb(2,"textarea",19),r.wc(3,"            "),r.Qb(),r.Qb(),r.Rb(4,"div"),r.Rb(5,"button",20),r.wc(6,"Add your comment"),r.Qb(),r.uc(7,I,2,1,"p",21),r.Qb(),r.Qb()}if(2&e){const e=r.ac().$implicit,t=r.ac();r.gc("formGroup",t.replyForm),r.Ab(5),r.gc("disabled",!t.replyForm.valid),r.Ab(2),r.gc("ngIf",t.errorMsgOnReply&&t.isReply==e.id)}}function U(e,t){if(1&e&&(r.Rb(0,"div",9),r.Mb(1,"app-comment",10),r.Rb(2,"div",11),r.uc(3,w,2,1,"div",12),r.Qb(),r.Rb(4,"div",13),r.uc(5,S,2,0,"button",14),r.uc(6,A,2,0,"button",14),r.Qb(),r.uc(7,Q,8,3,"form",15),r.Qb()),2&e){const e=t.$implicit,n=r.ac();r.Ab(1),r.gc("comment",e),r.Ab(2),r.gc("ngForOf",e.replies),r.Ab(2),r.gc("ngIf",n.isAuth),r.Ab(1),r.gc("ngIf",n.isReply==e.id),r.Ab(1),r.gc("ngIf",n.isReply==e.id)}}function M(e,t){if(1&e&&r.Mb(0,"app-comment-user-info",23),2&e){const e=r.ac();r.gc("email",e.shownUser)}}function F(e,t){1&e&&(r.Rb(0,"div",24),r.Rb(1,"p"),r.wc(2,"Please Sign in to add your comment!"),r.Qb(),r.Qb())}function O(e,t){if(1&e&&(r.Rb(0,"p",22),r.wc(1),r.Qb()),2&e){const e=r.ac(2);r.Ab(1),r.xc(e.errorMsgOnSubmit)}}function C(e,t){if(1&e&&(r.Rb(0,"p",22),r.wc(1),r.Qb()),2&e){const e=r.ac(2);r.Ab(1),r.xc(e.errorMsgOnloadComments)}}function j(e,t){if(1&e){const e=r.Sb();r.Rb(0,"form",25),r.Yb("ngSubmit",(function(){r.oc(e);const t=r.ac();return t.onSubmit(t.postForm)})),r.Rb(1,"div"),r.Mb(2,"textarea",26),r.Qb(),r.Rb(3,"div"),r.Rb(4,"button",20),r.wc(5,"Add your comment"),r.Qb(),r.uc(6,O,2,1,"p",21),r.Qb(),r.uc(7,C,2,1,"p",21),r.Qb()}if(2&e){const e=r.ac();r.gc("formGroup",e.postForm),r.Ab(4),r.gc("disabled",!e.postForm.valid),r.Ab(2),r.gc("ngIf",e.errorMsgOnSubmit),r.Ab(1),r.gc("ngIf",e.errorMsgOnloadComments)}}let L=(()=>{class e{constructor(e,t,n,s,i,c){this.firestore=e,this.formBuilder=t,this.authService=n,this.additionUserInfoService=s,this.subjectsService=i,this.generateIdService=c,this.isAuth=!1,this.isLoading=!1,this.isReply=null,this.errorMsgOnloadComments=null,this.errorMsgOnSubmit=null,this.errorMsgOnReply=null}ngOnInit(){this.subUser=this.authService.user.subscribe(e=>{this.isAuth=!!e}),this.additionUserInfoService.getUserAdditionalData(),this.userAdditionalDataSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe(e=>{this.userAdditionalData=e}),this.isLoading=!0,this.firestore.getComments().subscribe(e=>{this.comments=e.map(e=>Object.assign({id:e.payload.doc.id},e.payload.doc.data())),this.isLoading=!1,this.errorMsgOnloadComments=null},e=>{this.isLoading=!1,this.errorMsgOnloadComments=e.message}),this.postForm=this.formBuilder.group({commentArea:new i.d(null,i.p.required)}),this.replyForm=this.formBuilder.group({replyArea:new i.d(null,i.p.required)}),this.shownUserSub=this.subjectsService.shownUserSubject.subscribe(e=>{this.shownUser=e}),this.showUserInfoSub=this.subjectsService.showUserInfoSubject.subscribe(e=>{this.showUserInfo=e})}ngOnDestroy(){this.subUser.unsubscribe(),this.userAdditionalDataSub.unsubscribe(),this.showUserInfoSub.unsubscribe(),this.shownUserSub.unsubscribe()}onSubmit(e){if(!this.postForm.valid)return;const t=this.userAdditionalData[0].name,n=this.userAdditionalData[0].email,s=o.firestore.Timestamp.now(),i=e.value.commentArea.trim();""!=i?this.firestore.createComment({name:t,email:n,date:s,comment:i}).then(()=>{this.postForm.reset(),this.errorMsgOnSubmit=null}).catch(e=>{this.errorMsgOnSubmit=e.message}):this.postForm.reset()}onReply(e,t){if(!this.replyForm.valid)return;const n=this.userAdditionalData[0].name,s=this.userAdditionalData[0].email,i=o.firestore.Timestamp.now(),c=t.value.replyArea.trim(),r=this.generateIdService.generateId();""!=c?this.firestore.updateComment({name:n,email:s,date:i,comment:c,id:r,commentId:e}).then(()=>{this.isReply=null,this.replyForm.reset(),this.errorMsgOnReply=null}).catch(e=>{this.errorMsgOnReply=e.message}):this.replyForm.reset()}closeReplay(){this.isReply=null,this.replyForm.reset()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(b.a),r.Lb(i.c),r.Lb(m.a),r.Lb(a.a),r.Lb(u.a),r.Lb(l.a))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-comments"]],decls:11,vars:5,consts:[[1,"container"],[1,"comments-container"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[3,"email",4,"ngIf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[3,"comment"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply-btns"],["class","btn-default narrow-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"reply"],[1,"btn-default","narrow-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],["class","error-msg",4,"ngIf"],[1,"error-msg"],[3,"email"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(e,t){1&e&&(r.Rb(0,"div",0),r.Rb(1,"div",1),r.uc(2,v,1,0,"app-loading-spinner",2),r.Rb(3,"p",3),r.wc(4,"Comments"),r.Qb(),r.Rb(5,"div"),r.uc(6,U,8,5,"div",4),r.uc(7,M,1,1,"app-comment-user-info",5),r.Qb(),r.Mb(8,"hr",6),r.uc(9,F,3,0,"div",7),r.uc(10,j,8,4,"form",8),r.Qb(),r.Qb()),2&e&&(r.Ab(2),r.gc("ngIf",t.isLoading),r.Ab(4),r.gc("ngForOf",t.comments),r.Ab(1),r.gc("ngIf",t.showUserInfo),r.Ab(2),r.gc("ngIf",!t.isAuth),r.Ab(1),r.gc("ngIf",t.isAuth&&null==t.isReply))},directives:[s.l,s.k,d.a,h,i.q,i.l,i.g,i.b,i.k,i.e,R],encapsulation:2}),e})();var k=n("PCNd");let D=(()=>{class e{}return e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({factory:function(t){return new(t||e)},imports:[[s.c,k.a,i.o,c.e.forChild([{path:"",component:L}])]]}),e})()}}]);