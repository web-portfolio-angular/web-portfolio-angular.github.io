!function(){function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UyQ7:function(n,i,o){"use strict";o.r(i),o.d(i,"CommentsModule",(function(){return T}));var r,c,s,a=o("ofXK"),u=o("3Pt+"),b=o("tyNb"),m=o("Wcq6"),f=o("fXoL"),l=o("T/S4"),d=o("IYfF"),p=o("V86y"),h=o("rL3l"),g=o("zy28"),v=o("lJxs"),y=((r=function(){function n(t){e(this,n),this.firestore=t}return t(n,[{key:"transform",value:function(e,n){return this.firestore.getRegistration(e).pipe(Object(v.a)((function(e){var t=e.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())}));switch(n){case"name":return t[0].name;case"phoneCode":return t[0].phoneCode;case"phone":return t[0].phone;case"userImg":return"url("+t[0].userImg+")"}})))}}]),n}()).\u0275fac=function(e){return new(e||r)(f.Lb(l.a))},r.\u0275pipe=f.Kb({name:"getUserInfo",type:r,pure:!0}),r),A=function(e){return{"background-image":e}},P=((c=function(){function n(t){e(this,n),this.subjectsService=t}return t(n,[{key:"ngOnInit",value:function(){var e=this;this.shownUserSub=this.subjectsService.shownUserSubject.subscribe((function(n){e.shownUser=n}))}},{key:"ngOnDestroy",value:function(){this.shownUserSub.unsubscribe()}},{key:"onShowUserInfo",value:function(e){this.subjectsService.onShowUserInfo(e)}}]),n}()).\u0275fac=function(e){return new(e||c)(f.Lb(h.a))},c.\u0275cmp=f.Fb({type:c,selectors:[["app-comment"]],inputs:{comment:"comment"},decls:14,vars:18,consts:[[1,"comment-header"],[1,"comment-header-left",3,"click"],[1,"comment-img",3,"ngStyle"],[1,"comment-name"],[1,"comment-date"],[1,"comment-content"],[1,"comment-content-text"]],template:function(e,n){1&e&&(f.Qb(0,"div",0),f.Qb(1,"div",1),f.Xb("click",(function(){return n.onShowUserInfo(n.comment.email)})),f.Mb(2,"div",2),f.ac(3,"async"),f.ac(4,"getUserInfo"),f.Qb(5,"p",3),f.uc(6),f.Pb(),f.Pb(),f.Qb(7,"p",4),f.uc(8),f.ac(9,"date"),f.ac(10,"date"),f.Pb(),f.Pb(),f.Qb(11,"div",5),f.Qb(12,"p",6),f.uc(13),f.Pb(),f.Pb()),2&e&&(f.Ab(2),f.fc("ngStyle",f.ic(16,A,f.bc(3,5,f.cc(4,7,n.comment.email,"userImg")))),f.Ab(4),f.wc(" ",n.comment.name," "),f.Ab(2),f.xc(" ",f.cc(9,10,n.comment.date.toDate(),"dd.MM.yyyy")," at ",f.cc(10,13,n.comment.date.toDate(),"HH:mm")," "),f.Ab(5),f.vc(n.comment.comment))},directives:[a.m],pipes:[a.b,y,a.e],encapsulation:2}),c),I=function(e){return{"background-image":e}},S=((s=function(){function n(t){e(this,n),this.subjectsService=t}return t(n,[{key:"ngOnInit",value:function(){}},{key:"closeUserInfo",value:function(){this.subjectsService.overlayClick()}}]),n}()).\u0275fac=function(e){return new(e||s)(f.Lb(h.a))},s.\u0275cmp=f.Fb({type:s,selectors:[["app-comment-user-info"]],inputs:{email:"email"},decls:32,vars:28,consts:[[1,"comment-user-info-container"],[1,"comment-user-info"],[1,"comment-user-info__close-btn",3,"click"],[1,"comment-user-info__avatar",3,"ngStyle"],[1,"comment-user-info__element"],[1,"comment-info-img"],["src","../../assets//img/sign/user.png"],["src","../../assets//img/sign/phone.png"],["src","../../assets//img/sign/email.png"],[3,"href"]],template:function(e,n){1&e&&(f.Qb(0,"div",0),f.Qb(1,"div",1),f.Qb(2,"div",2),f.Xb("click",(function(){return n.closeUserInfo()})),f.uc(3,"X"),f.Pb(),f.Mb(4,"div",3),f.ac(5,"async"),f.ac(6,"getUserInfo"),f.Qb(7,"div",4),f.Qb(8,"div",5),f.Mb(9,"img",6),f.Pb(),f.Qb(10,"div"),f.uc(11),f.ac(12,"async"),f.ac(13,"getUserInfo"),f.Pb(),f.Pb(),f.Qb(14,"div",4),f.Qb(15,"div",5),f.Mb(16,"img",7),f.Pb(),f.Qb(17,"div"),f.Qb(18,"span"),f.uc(19),f.ac(20,"async"),f.ac(21,"getUserInfo"),f.Pb(),f.Qb(22,"span"),f.uc(23),f.ac(24,"async"),f.ac(25,"getUserInfo"),f.Pb(),f.Pb(),f.Pb(),f.Qb(26,"div",4),f.Qb(27,"div",5),f.Mb(28,"img",8),f.Pb(),f.Qb(29,"div"),f.Qb(30,"a",9),f.uc(31),f.Pb(),f.Pb(),f.Pb(),f.Pb(),f.Pb()),2&e&&(f.Ab(4),f.fc("ngStyle",f.ic(26,I,f.bc(5,6,f.cc(6,8,n.email,"userImg")))),f.Ab(7),f.wc(" ",f.bc(12,11,f.cc(13,13,n.email,"name"))," "),f.Ab(8),f.wc(" +",f.bc(20,16,f.cc(21,18,n.email,"phoneCode"))," "),f.Ab(4),f.wc(" ",f.bc(24,21,f.cc(25,23,n.email,"phone"))," "),f.Ab(7),f.gc("href","mailto:",n.email,"",f.oc),f.Ab(1),f.vc(n.email))},directives:[a.m],pipes:[a.b,y],encapsulation:2}),s);function Q(e,n){1&e&&f.Mb(0,"app-loading-spinner")}function w(e,n){if(1&e&&(f.Qb(0,"div",16),f.Mb(1,"app-comment",10),f.Pb()),2&e){var t=n.$implicit;f.Ab(1),f.fc("comment",t)}}function U(e,n){if(1&e){var t=f.Rb();f.Qb(0,"button",17),f.Xb("click",(function(){f.nc(t);var e=f.Zb().$implicit;return f.Zb().isReply=e.id})),f.uc(1,"Reply "),f.Pb()}}function M(e,n){if(1&e){var t=f.Rb();f.Qb(0,"button",17),f.Xb("click",(function(){return f.nc(t),f.Zb(2).closeReplay()})),f.uc(1,"Close Reply "),f.Pb()}}function k(e,n){if(1&e&&(f.Qb(0,"p",22),f.uc(1),f.Pb()),2&e){var t=f.Zb(3);f.Ab(1),f.vc(t.errorMsgOnReply)}}function O(e,n){if(1&e){var t=f.Rb();f.Qb(0,"form",18),f.Xb("ngSubmit",(function(){f.nc(t);var e=f.Zb().$implicit,n=f.Zb();return n.onReply(e.id,n.replyForm)})),f.Qb(1,"div"),f.Qb(2,"textarea",19),f.uc(3,"            "),f.Pb(),f.Pb(),f.Qb(4,"div"),f.Qb(5,"button",20),f.uc(6,"Add your comment"),f.Pb(),f.tc(7,k,2,1,"p",21),f.Pb(),f.Pb()}if(2&e){var i=f.Zb(2);f.fc("formGroup",i.replyForm),f.Ab(5),f.fc("disabled",!i.replyForm.valid),f.Ab(2),f.fc("ngIf",i.errorMsgOnReply)}}function F(e,n){if(1&e&&(f.Qb(0,"div",9),f.Mb(1,"app-comment",10),f.Qb(2,"div",11),f.tc(3,w,2,1,"div",12),f.Pb(),f.Qb(4,"div",13),f.tc(5,U,2,0,"button",14),f.tc(6,M,2,0,"button",14),f.Pb(),f.tc(7,O,8,3,"form",15),f.Pb()),2&e){var t=n.$implicit,i=f.Zb();f.Ab(1),f.fc("comment",t),f.Ab(2),f.fc("ngForOf",t.replies),f.Ab(2),f.fc("ngIf",i.isAuth),f.Ab(1),f.fc("ngIf",i.isReply==t.id),f.Ab(1),f.fc("ngIf",i.isReply==t.id)}}function R(e,n){if(1&e&&f.Mb(0,"app-comment-user-info",23),2&e){var t=f.Zb();f.fc("email",t.shownUser)}}function C(e,n){1&e&&(f.Qb(0,"div",24),f.Qb(1,"p"),f.uc(2,"Please Sign in to add your comment!"),f.Pb(),f.Pb())}function j(e,n){if(1&e&&(f.Qb(0,"p",22),f.uc(1),f.Pb()),2&e){var t=f.Zb(2);f.Ab(1),f.vc(t.errorMsgOnSubmit)}}function L(e,n){if(1&e&&(f.Qb(0,"p",22),f.uc(1),f.Pb()),2&e){var t=f.Zb(2);f.Ab(1),f.vc(t.errorMsgOnloadComments)}}function D(e,n){if(1&e){var t=f.Rb();f.Qb(0,"form",25),f.Xb("ngSubmit",(function(){f.nc(t);var e=f.Zb();return e.onSubmit(e.postForm)})),f.Qb(1,"div"),f.Mb(2,"textarea",26),f.Pb(),f.Qb(3,"div"),f.Qb(4,"button",20),f.uc(5,"Add your comment"),f.Pb(),f.tc(6,j,2,1,"p",21),f.Pb(),f.tc(7,L,2,1,"p",21),f.Pb()}if(2&e){var i=f.Zb();f.fc("formGroup",i.postForm),f.Ab(4),f.fc("disabled",!i.postForm.valid),f.Ab(2),f.fc("ngIf",i.errorMsgOnSubmit),f.Ab(1),f.fc("ngIf",i.errorMsgOnloadComments)}}var Z,X,x=((Z=function(){function n(t,i,o,r,c){e(this,n),this.firestore=t,this.formBuilder=i,this.authService=o,this.additionUserInfoService=r,this.subjectsService=c,this.isAuth=!1,this.isLoading=!1,this.isReply=null,this.errorMsgOnloadComments=null,this.errorMsgOnSubmit=null,this.errorMsgOnReply=null}return t(n,[{key:"ngOnInit",value:function(){var e=this;this.subUser=this.authService.user.subscribe((function(n){e.isAuth=!!n})),this.additionUserInfoService.getUserAdditionalData(),this.userAdditionalDataSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe((function(n){e.userAdditionalData=n})),this.isLoading=!0,this.firestore.getComments().subscribe((function(n){e.comments=n.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())})),e.isLoading=!1,e.errorMsgOnloadComments=null}),(function(n){e.isLoading=!1,e.errorMsgOnloadComments=n.message})),this.postForm=this.formBuilder.group({commentArea:new u.d(null,u.p.required)}),this.replyForm=this.formBuilder.group({replyArea:new u.d(null,u.p.required)}),this.shownUserSub=this.subjectsService.shownUserSubject.subscribe((function(n){e.shownUser=n})),this.showUserInfoSub=this.subjectsService.showUserInfoSubject.subscribe((function(n){e.showUserInfo=n}))}},{key:"ngOnDestroy",value:function(){this.subUser.unsubscribe(),this.userAdditionalDataSub.unsubscribe(),this.showUserInfoSub.unsubscribe(),this.shownUserSub.unsubscribe()}},{key:"onSubmit",value:function(e){var n=this;if(this.postForm.valid){var t=this.userAdditionalData[0].name,i=this.userAdditionalData[0].email,o=m.firestore.Timestamp.now();this.firestore.createComment({name:t,email:i,date:o,comment:e.value.commentArea}).then((function(){n.postForm.reset(),n.errorMsgOnSubmit=null})).catch((function(e){n.errorMsgOnSubmit=e.message}))}}},{key:"onReply",value:function(e,n){var t=this;if(this.replyForm.valid){var i=this.userAdditionalData[0].name,o=this.userAdditionalData[0].email,r=m.firestore.Timestamp.now(),c=n.value.replyArea,s=this.generateReplayId();this.firestore.updateComment({name:i,email:o,date:r,comment:c,id:s,commentId:e}).then((function(){t.isReply=null,t.replyForm.reset(),t.errorMsgOnReply=null})).catch((function(e){t.errorMsgOnReply=e.message}))}}},{key:"generateReplayId",value:function(){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=n.length,i=0;i<20;i++)e+=n.charAt(Math.floor(Math.random()*t));return e}},{key:"closeReplay",value:function(){this.isReply=null,this.replyForm.reset()}}]),n}()).\u0275fac=function(e){return new(e||Z)(f.Lb(l.a),f.Lb(u.c),f.Lb(d.a),f.Lb(p.a),f.Lb(h.a))},Z.\u0275cmp=f.Fb({type:Z,selectors:[["app-comments"]],decls:11,vars:5,consts:[[1,"container"],[1,"comments-container"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[3,"email",4,"ngIf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[3,"comment"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply-btns"],["class","btn-default narrow-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"reply"],[1,"btn-default","narrow-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],["class","error-msg",4,"ngIf"],[1,"error-msg"],[3,"email"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(e,n){1&e&&(f.Qb(0,"div",0),f.Qb(1,"div",1),f.tc(2,Q,1,0,"app-loading-spinner",2),f.Qb(3,"p",3),f.uc(4,"Comments"),f.Pb(),f.Qb(5,"div"),f.tc(6,F,8,5,"div",4),f.tc(7,R,1,1,"app-comment-user-info",5),f.Pb(),f.Mb(8,"hr",6),f.tc(9,C,3,0,"div",7),f.tc(10,D,8,4,"form",8),f.Pb(),f.Pb()),2&e&&(f.Ab(2),f.fc("ngIf",n.isLoading),f.Ab(4),f.fc("ngForOf",n.comments),f.Ab(1),f.fc("ngIf",n.showUserInfo),f.Ab(2),f.fc("ngIf",!n.isAuth),f.Ab(1),f.fc("ngIf",n.isAuth&&null==n.isReply))},directives:[a.l,a.k,g.a,P,u.q,u.l,u.g,u.b,u.k,u.e,S],encapsulation:2}),Z),G=o("PCNd"),T=((X=function n(){e(this,n)}).\u0275mod=f.Jb({type:X}),X.\u0275inj=f.Ib({factory:function(e){return new(e||X)},imports:[[a.c,G.a,u.o,b.e.forChild([{path:"",component:x}])]]}),X)}}])}();