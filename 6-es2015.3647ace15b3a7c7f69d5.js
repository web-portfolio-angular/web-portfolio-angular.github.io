(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UyQ7:function(t,e,n){"use strict";n.r(e),n.d(e,"CommentsModule",(function(){return k}));var o=n("ofXK"),r=n("3Pt+"),i=n("tyNb"),s=n("Wcq6"),b=n("fXoL"),c=n("T/S4"),m=n("IYfF"),a=n("zy28");function l(t,e){1&t&&b.Lb(0,"app-loading-spinner")}function u(t,e){if(1&t&&(b.Nb(0,"div",19),b.Nb(1,"div",9),b.Nb(2,"p",10),b.kc(3),b.Mb(),b.Nb(4,"p",11),b.kc(5),b.Xb(6,"date"),b.Xb(7,"date"),b.Mb(),b.Mb(),b.Nb(8,"div",12),b.Nb(9,"p",13),b.kc(10),b.Mb(),b.Mb(),b.Mb()),2&t){const t=e.$implicit;b.Ab(3),b.mc(" ",t.name," "),b.Ab(2),b.nc(" ",b.Yb(6,4,t.date.toDate(),"dd.MM.yyyy")," at ",b.Yb(7,7,t.date.toDate(),"HH:mm")," "),b.Ab(5),b.lc(t.comment)}}function d(t,e){if(1&t){const t=b.Ob();b.Nb(0,"button",20),b.Ub("click",(function(){b.gc(t);const e=b.Wb().$implicit;return b.Wb().isReply=e.id})),b.kc(1,"Reply"),b.Mb()}}function p(t,e){if(1&t){const t=b.Ob();b.Nb(0,"button",20),b.Ub("click",(function(){return b.gc(t),b.Wb(2).isReply=null})),b.kc(1,"Close Reply"),b.Mb()}}function f(t,e){if(1&t&&(b.Nb(0,"p",25),b.kc(1),b.Mb()),2&t){const t=b.Wb(3);b.Ab(1),b.lc(t.errorMsgOnReply)}}function g(t,e){if(1&t){const t=b.Ob();b.Nb(0,"form",21),b.Ub("ngSubmit",(function(){b.gc(t);const e=b.Wb().$implicit,n=b.Wb();return n.onReply(e.name,e.date,e.comment,e.id,n.replyForm)})),b.Nb(1,"div"),b.Lb(2,"textarea",22),b.Mb(),b.Nb(3,"div"),b.Nb(4,"button",23),b.kc(5,"Add your comment"),b.Mb(),b.jc(6,f,2,1,"p",24),b.Mb(),b.Mb()}if(2&t){const t=b.Wb(2);b.bc("formGroup",t.replyForm),b.Ab(4),b.bc("disabled",!t.replyForm.valid),b.Ab(2),b.bc("ngIf",t.errorMsgOnReply)}}function h(t,e){if(1&t&&(b.Nb(0,"div",8),b.Nb(1,"div",9),b.Nb(2,"p",10),b.kc(3),b.Mb(),b.Nb(4,"p",11),b.kc(5),b.Xb(6,"date"),b.Xb(7,"date"),b.Mb(),b.Mb(),b.Nb(8,"div",12),b.Nb(9,"p",13),b.kc(10),b.Mb(),b.Nb(11,"div",14),b.jc(12,u,11,10,"div",15),b.Mb(),b.Nb(13,"div",16),b.jc(14,d,2,0,"button",17),b.jc(15,p,2,0,"button",17),b.Mb(),b.jc(16,g,7,3,"form",18),b.Mb(),b.Mb()),2&t){const t=e.$implicit,n=b.Wb();b.Ab(3),b.mc(" ",t.name," "),b.Ab(2),b.nc(" ",b.Yb(6,8,t.date.toDate(),"dd.MM.yyyy")," at ",b.Yb(7,11,t.date.toDate(),"HH:mm")," "),b.Ab(5),b.lc(t.comment),b.Ab(2),b.bc("ngForOf",t.replies),b.Ab(2),b.bc("ngIf",n.isAuth),b.Ab(1),b.bc("ngIf",n.isReply==t.id),b.Ab(1),b.bc("ngIf",n.isReply==t.id)}}function y(t,e){1&t&&(b.Nb(0,"div",26),b.Nb(1,"p"),b.kc(2,"Please Sign in to add your comment!"),b.Mb(),b.Mb())}function M(t,e){if(1&t&&(b.Nb(0,"p",25),b.kc(1),b.Mb()),2&t){const t=b.Wb(2);b.Ab(1),b.lc(t.errorMsgOnSubmit)}}function N(t,e){if(1&t&&(b.Nb(0,"p",25),b.kc(1),b.Mb()),2&t){const t=b.Wb(2);b.Ab(1),b.lc(t.errorMsgOnloadComments)}}function A(t,e){if(1&t){const t=b.Ob();b.Nb(0,"form",27),b.Ub("ngSubmit",(function(){b.gc(t);const e=b.Wb();return e.onSubmit(e.postForm)})),b.Nb(1,"div"),b.Lb(2,"textarea",28),b.Mb(),b.Nb(3,"div"),b.Nb(4,"button",23),b.kc(5,"Add your comment"),b.Mb(),b.jc(6,M,2,1,"p",24),b.Mb(),b.jc(7,N,2,1,"p",24),b.Mb()}if(2&t){const t=b.Wb();b.bc("formGroup",t.postForm),b.Ab(4),b.bc("disabled",!t.postForm.valid),b.Ab(2),b.bc("ngIf",t.errorMsgOnSubmit),b.Ab(1),b.bc("ngIf",t.errorMsgOnloadComments)}}let v=(()=>{class t{constructor(t,e,n){this.firestore=t,this.formBuilder=e,this.authService=n,this.isAuth=!1,this.isLoading=!1,this.isReply=null,this.errorMsgOnloadComments=null,this.errorMsgOnSubmit=null,this.errorMsgOnReply=null}ngOnInit(){this.subUser=this.authService.user.subscribe(t=>{this.isAuth=!!t}),this.isLoading=!0,this.firestore.getComments().subscribe(t=>{this.comments=t.map(t=>Object.assign({id:t.payload.doc.id},t.payload.doc.data())),this.isLoading=!1,this.errorMsgOnloadComments=null},t=>{this.isLoading=!1,this.errorMsgOnloadComments=t.message}),this.postForm=this.formBuilder.group({commentArea:new r.d(null,r.n.required)}),this.replyForm=this.formBuilder.group({replyArea:new r.d(null,r.n.required)})}ngOnDestroy(){this.subUser.unsubscribe()}onSubmit(t){if(!this.postForm.valid)return;const e=JSON.parse(localStorage.getItem("userAdditionalData"));if(!e)return;const n=e[0].name,o=s.firestore.Timestamp.now();this.firestore.createComment({name:n,date:o,comment:t.value.commentArea}).then(()=>{this.postForm.reset(),this.errorMsgOnSubmit=null}).catch(t=>{this.errorMsgOnSubmit=t.message})}onReply(t,e,n,o,r){if(!this.replyForm.valid)return;const i=JSON.parse(localStorage.getItem("userAdditionalData"));if(!i)return;const b={name:t,date:e,comment:n,replies:[{name:i[0].name,date:s.firestore.Timestamp.now(),comment:r.value.replyArea}],id:o};this.firestore.updateComment(b).then(()=>{this.isReply=null,this.replyForm.reset(),this.errorMsgOnReply=null}).catch(t=>{this.errorMsgOnReply=t.message})}}return t.\u0275fac=function(e){return new(e||t)(b.Kb(c.a),b.Kb(r.c),b.Kb(m.a))},t.\u0275cmp=b.Eb({type:t,selectors:[["app-comments"]],decls:10,vars:4,consts:[[1,"container"],[1,"comments-container",2,"position","relative"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[1,"comment-header"],[1,"comment-name"],[1,"comment-date"],[1,"comment-content"],[1,"comment-content-text"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply-btns"],["class","btn-default narrow-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"reply"],[1,"btn-default","narrow-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],["class","error-msg",4,"ngIf"],[1,"error-msg"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(t,e){1&t&&(b.Nb(0,"div",0),b.Nb(1,"div",1),b.jc(2,l,1,0,"app-loading-spinner",2),b.Nb(3,"p",3),b.kc(4,"Comments"),b.Mb(),b.Nb(5,"div"),b.jc(6,h,17,14,"div",4),b.Lb(7,"hr",5),b.jc(8,y,3,0,"div",6),b.jc(9,A,8,4,"form",7),b.Mb(),b.Mb(),b.Mb()),2&t&&(b.Ab(2),b.bc("ngIf",e.isLoading),b.Ab(4),b.bc("ngForOf",e.comments),b.Ab(2),b.bc("ngIf",!e.isAuth),b.Ab(1),b.bc("ngIf",e.isAuth&&null==e.isReply))},directives:[o.k,o.j,a.a,r.o,r.k,r.g,r.b,r.j,r.e],pipes:[o.d],encapsulation:2}),t})();var O=n("PCNd");let k=(()=>{class t{}return t.\u0275mod=b.Ib({type:t}),t.\u0275inj=b.Hb({factory:function(e){return new(e||t)},imports:[[o.b,O.a,r.m,i.f.forChild([{path:"",component:v}])]]}),t})()}}]);