!function(){function r(r){return function(r){if(Array.isArray(r))return e(r)}(r)||function(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}(r)||function(r,a){if(!r)return;if("string"==typeof r)return e(r,a);var t=Object.prototype.toString.call(r).slice(8,-1);"Object"===t&&r.constructor&&(t=r.constructor.name);if("Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return e(r,a)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(r,e){(null==e||e>r.length)&&(e=r.length);for(var a=0,t=new Array(e);a<e;a++)t[a]=r[a];return t}function a(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function t(r,e){for(var a=0;a<e.length;a++){var t=e[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function n(r,e,a){return e&&t(r.prototype,e),a&&t(r,a),r}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{F15C:function(e,t,c){"use strict";c.r(t),c.d(t,"SellBuyCarModule",(function(){return xr}));var i,o=c("ofXK"),s=c("tyNb"),l=c("3Pt+"),u=c("d3UM"),g=c("fXoL"),b=c("1XCa"),m=function(){return["buy"]},d=function(){return["sell"]},f=((i=function(){function r(e){a(this,r),this.router=e}return n(r,[{key:"ngOnInit",value:function(){var r=JSON.parse(localStorage.getItem("sell-buy-car-LastVisitedLink"));r&&this.router.navigate([r])}},{key:"saveLastVisitedLinkToLocalStore",value:function(r){localStorage.setItem("sell-buy-car-LastVisitedLink",JSON.stringify("/sell-buy-car/"+r))}}]),r}()).\u0275fac=function(r){return new(r||i)(g.Lb(s.b))},i.\u0275cmp=g.Fb({type:i,selectors:[["app-sell-buy-car"]],decls:9,vars:4,consts:[[1,"container"],[1,"sell-buy-car"],[1,"sell-buy-car__router-links"],["routerLinkActive","categories-active",3,"routerLink","click"]],template:function(r,e){1&r&&(g.Rb(0,"div",0),g.Mb(1,"app-categories-info"),g.Rb(2,"div",1),g.Rb(3,"ul",2),g.Rb(4,"li",3),g.Yb("click",(function(){return e.saveLastVisitedLinkToLocalStore("buy")})),g.xc(5,"Buy Second Hand Car"),g.Qb(),g.Rb(6,"li",3),g.Yb("click",(function(){return e.saveLastVisitedLinkToLocalStore("sell")})),g.xc(7," Sell Your Car"),g.Qb(),g.Qb(),g.Mb(8,"router-outlet"),g.Qb(),g.Qb()),2&r&&(g.Ab(4),g.gc("routerLink",g.jc(2,m)),g.Ab(2),g.gc("routerLink",g.jc(3,d)))},directives:[b.a,s.d,s.c,s.f],encapsulation:2}),i),p=c("2CTM"),h=c("T/S4"),v=c("zy28"),I=c("rL3l"),C=c("V86y"),y=c("Vaw3"),R=c("B02C"),L=c("fk3A"),F=c("odcQ");function Q(r,e){1&r&&g.Mb(0,"app-loading-spinner")}function A(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div"),g.Rb(1,"button",16),g.Yb("click",(function(){return g.pc(a),g.ac().onEdit()})),g.xc(2,"Edit Car"),g.Qb(),g.Qb()}}function S(r,e){if(1&r&&g.Mb(0,"app-car-images",20),2&r){var a=g.ac(2);g.gc("carImgs",a.car.carImages)}}function k(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div",17),g.Rb(1,"button",18),g.Yb("click",(function(){g.pc(a);var r=g.ac();return r.onShowCarImages(r.car.id)})),g.xc(2,"View Images"),g.Qb(),g.vc(3,S,1,1,"app-car-images",19),g.Qb()}if(2&r){var t=g.ac();g.Ab(3),g.gc("ngIf",t.carShowImages&&t.carId==t.car.id)}}function w(r,e){1&r&&(g.Rb(0,"p",21),g.xc(1,"No images uploaded"),g.Qb())}function E(r,e){1&r&&(g.Rb(0,"div"),g.Rb(1,"p",43),g.xc(2,"There are no images uploaded"),g.Qb(),g.Qb())}function M(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div",47),g.Mb(1,"img",28),g.Rb(2,"div",48),g.Yb("click",(function(){g.pc(a);var r=e.index,t=e.$implicit;return g.ac(3).deleteCurrentImages(r,t)})),g.xc(3,"X"),g.Qb(),g.Qb()}if(2&r){var t=e.$implicit;g.Ab(1),g.gc("src",t,g.qc)}}function x(r,e){if(1&r&&(g.Rb(0,"div",44),g.Rb(1,"p",30),g.xc(2,"Current Images"),g.Qb(),g.Rb(3,"div",45),g.vc(4,M,4,1,"div",46),g.Qb(),g.Qb()),2&r){var a=g.ac(2);g.Ab(4),g.gc("ngForOf",a.currentCarImages)}}function _(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div",47),g.Mb(1,"img",28),g.Rb(2,"div",48),g.Yb("click",(function(){g.pc(a);var r=e.index;return g.ac(3).removeCarImg(r)})),g.xc(3,"X"),g.Qb(),g.Qb()}if(2&r){var t=e.$implicit;g.Ab(1),g.gc("src",t,g.qc)}}function U(r,e){if(1&r&&(g.Rb(0,"div",44),g.Rb(1,"p",30),g.xc(2,"New Images"),g.Qb(),g.Rb(3,"div",45),g.vc(4,_,4,1,"div",46),g.Qb(),g.Qb()),2&r){var a=g.ac(2);g.Ab(4),g.gc("ngForOf",a.carImgLocalPaths)}}function D(r,e){if(1&r&&(g.Rb(0,"p",49),g.xc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.yc(a.uploadCarImagesToFirestoreError)}}function T(r,e){if(1&r&&(g.Rb(0,"p",49),g.xc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.yc(a.updateSecondHandCarError)}}function O(r,e){if(1&r&&(g.Rb(0,"p",49),g.xc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.yc(a.setcarImgURLsError)}}function N(r,e){if(1&r&&(g.Rb(0,"p",49),g.xc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.yc(a.deleteOldImgError)}}function j(r,e){if(1&r&&(g.Rb(0,"p",49),g.xc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.yc(a.getCarImgURLError)}}function P(r,e){if(1&r&&(g.Rb(0,"p",49),g.xc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.yc(a.uploadCarImgToFirestoreError)}}function Y(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div",22),g.Rb(1,"form",23),g.Yb("ngSubmit",(function(){g.pc(a);var r=g.ac();return r.submitCarDetailChanges(r.changeCarDetailsForm)})),g.Rb(2,"div",24),g.Rb(3,"input",25,26),g.Yb("change",(function(r){return g.pc(a),g.ac().onChooseCarImg(r)})),g.Qb(),g.Rb(5,"div",27),g.Mb(6,"img",28),g.Qb(),g.Rb(7,"button",16),g.Yb("click",(function(){return g.pc(a),g.nc(4).click()})),g.xc(8,"Change Car Image"),g.Qb(),g.Qb(),g.Mb(9,"hr",4),g.Rb(10,"div",29),g.Rb(11,"p",30),g.xc(12,"Description"),g.Qb(),g.Mb(13,"textarea",31),g.Qb(),g.Rb(14,"div",32),g.Rb(15,"p",30),g.xc(16,"Price"),g.Qb(),g.Mb(17,"input",33),g.Qb(),g.Mb(18,"hr",4),g.Rb(19,"div",34),g.Rb(20,"div"),g.vc(21,E,3,0,"div",1),g.vc(22,x,5,1,"div",35),g.vc(23,U,5,1,"div",35),g.Qb(),g.Rb(24,"div",36),g.Rb(25,"input",37,38),g.Yb("change",(function(r){return g.pc(a),g.ac().onChooseCarImgs(r)})),g.Qb(),g.Rb(27,"button",39),g.Yb("click",(function(){return g.pc(a),g.nc(26).click()})),g.xc(28," Select Images "),g.Qb(),g.Qb(),g.Qb(),g.Mb(29,"hr",4),g.Rb(30,"div",40),g.Rb(31,"button",41),g.xc(32,"Apply Changes"),g.Qb(),g.Rb(33,"button",16),g.Yb("click",(function(){return g.pc(a),g.ac().onCancel()})),g.xc(34,"Cancel"),g.Qb(),g.Qb(),g.Rb(35,"div"),g.vc(36,D,2,1,"p",42),g.vc(37,T,2,1,"p",42),g.vc(38,O,2,1,"p",42),g.vc(39,N,2,1,"p",42),g.vc(40,j,2,1,"p",42),g.vc(41,P,2,1,"p",42),g.Qb(),g.Qb(),g.Qb()}if(2&r){var t=g.ac();g.Ab(1),g.gc("formGroup",t.changeCarDetailsForm),g.Ab(5),g.gc("src",t.carImgLocalPath,g.qc),g.Ab(15),g.gc("ngIf",!t.car.carImages||0==t.currentCarImages.length),g.Ab(1),g.gc("ngIf",t.currentCarImages.length>0),g.Ab(1),g.gc("ngIf",t.carImgLocalPaths.length>0),g.Ab(13),g.gc("ngIf",t.uploadCarImagesToFirestoreError),g.Ab(1),g.gc("ngIf",t.updateSecondHandCarError),g.Ab(1),g.gc("ngIf",t.setcarImgURLsError),g.Ab(1),g.gc("ngIf",t.deleteOldImgError),g.Ab(1),g.gc("ngIf",t.getCarImgURLError),g.Ab(1),g.gc("ngIf",t.uploadCarImgToFirestoreError)}}var q,V=function(r){return{"background-image":r}},H=((q=function(){function e(r,t,n,c,i,o){a(this,e),this.subjectService=r,this.formBuilder=t,this.firestore=n,this.additionUserInfoService=c,this.angularFireStorage=i,this.generateIdService=o,this.isInEditMode=!1,this.ownerEmail=null,this.carFiles=[],this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.currentCarImages=[],this.uploadCarImagesToFirestoreError=null,this.updateSecondHandCarError=null,this.setcarImgURLsError=null,this.isLoading=!1,this.deleteOldImgError=null,this.getCarImgURLError=null,this.uploadCarImgToFirestoreError=null,this.currentImageForDelete=[]}return n(e,[{key:"ngOnInit",value:function(){var e=this;this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe((function(r){e.userAdditionalData=r,e.ownerEmail=e.userAdditionalData[0].email})),this.carShowImagesSub=this.subjectService.carShowImagesSubject.subscribe((function(r){e.carShowImages=r})),this.carIdSub=this.subjectService.carIdSubject.subscribe((function(r){e.carId=r})),this.changeCarDetailsForm=this.formBuilder.group({carImg:new l.d(null),model:new l.d(null),description:new l.d(null,l.p.required),price:new l.d(null,l.p.required),carImgs:new l.d(null)}),this.currentCarImages=r(this.car.carImages),this.carImgLocalPath=this.car.carImg}},{key:"ngOnDestroy",value:function(){this.carShowImagesSub.unsubscribe(),this.carIdSub.unsubscribe(),this.userAdditionalInfoSub.unsubscribe()}},{key:"onShowCarImages",value:function(r){this.subjectService.onShowCarImages(r)}},{key:"submitCarDetailChanges",value:function(r){var e=this;if(r.valid){this.isLoading=!0;var a=this.car.id,t=this.car.carImg,n=this.car.model;this.onUploadCarImageToFirestore(a).then((function(){if(r.value.carImg&&(t=r.value.carImg),e.currentImageForDelete.length>0){for(var c=0;c<e.currentImageForDelete.length;c++)e.firestore.delete(e.currentImageForDelete[c]);e.firestore.setSecondHanCurrentImages({doc:n,id:a,currentImgs:e.currentCarImages})}e.onUploadCarImagesToFirestore(a).then((function(){if(e.carImgNames.length>0)for(var c=0;c<e.carImgNames.length;c++)e.firestore.updateSecondHanImagesCar({doc:n,id:a,img:r.value.carImgs[c]});e.firestore.updateSecondHandCar({carImg:t,description:r.value.description,price:r.value.price,id:a,doc:n}).then((function(){e.isLoading=!1,e.updateSecondHandCarError=null,e.onCancel()}),(function(r){e.updateSecondHandCarError=r.message}))}))}))}}},{key:"onChooseCarImg",value:function(r){var e=this;if(this.carFile=r.target.files[0],this.carFile){var a=new FileReader;a.onload=function(r){e.carImgLocalPath=r.target.result},a.readAsDataURL(r.target.files[0])}else this.carImgLocalPath=this.car.carImg}},{key:"onUploadCarImageToFirestore",value:function(r){var e=this;return new Promise((function(a){e.carFile||a(),e.angularFireStorage.upload("/carsForSell/"+e.changeCarDetailsForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"/"+e.carFile.name,e.carFile).then((function(r){r.ref.getDownloadURL().then((function(r){e.changeCarDetailsForm.value.carImg=r,e.firestore.delete(e.car.carImg).then((function(){e.deleteOldImgError=null})).catch((function(r){e.deleteOldImgError=r.message})),e.getCarImgURLError=null,a()})).catch((function(r){e.getCarImgURLError=r.message})),e.uploadCarImgToFirestoreError=null})).catch((function(r){e.uploadCarImgToFirestoreError=r.message}))}))}},{key:"onChooseCarImgs",value:function(r){for(var e=this,a=0;a<r.target.files.length;a++){this.carFiles.push(r.target.files[a]);var t=new FileReader;t.onload=function(r){e.carImgLocalPaths.push(r.target.result)},t.readAsDataURL(r.target.files[a]),this.carImgNames.push(this.carFiles[a].name)}}},{key:"onUploadCarImagesToFirestore",value:function(r){var e=this;return new Promise((function(a){0==e.carImgNames.length&&a();for(var t=0;t<e.carImgNames.length;t++)e.angularFireStorage.upload("/carsForSell/"+e.changeCarDetailsForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"//carImages/"+e.generateIdService.generateId()+"-"+e.carImgNames[t],e.carFiles[t]).then((function(r){r.ref.getDownloadURL().then((function(r){e.carImgURLs.push(r),e.carImgURLs.length==e.carImgNames.length&&(e.changeCarDetailsForm.value.carImgs=e.carImgURLs,e.setcarImgURLsError=null,a())})).catch((function(r){e.setcarImgURLsError=r.message})),e.uploadCarImagesToFirestoreError=null})).catch((function(r){e.uploadCarImagesToFirestoreError=r.message}))}))}},{key:"onEdit",value:function(){this.changeCarDetailsForm.controls.description.setValue(this.car.description),this.changeCarDetailsForm.controls.price.setValue(this.car.price),this.changeCarDetailsForm.controls.model.setValue(this.car.model),this.isInEditMode=!0}},{key:"removeCarImg",value:function(r){this.carImgLocalPaths.splice(r,1),this.carImgNames.splice(r,1),this.carFiles.splice(r,1),0==this.carFiles&&(this.changeCarDetailsForm.value.carImgs=null)}},{key:"onCancel",value:function(){this.carFiles=[],this.carImgLocalPaths=[],this.carImgNames=[],this.changeCarDetailsForm.controls.carImgs.setValue(""),this.changeCarDetailsForm.controls.carImg.setValue(""),this.carImgLocalPath=this.car.carImg,this.currentCarImages=r(this.car.carImages),this.currentImageForDelete=[],this.isInEditMode=!1}},{key:"deleteCurrentImages",value:function(r,e){this.currentCarImages.splice(r,1),this.currentImageForDelete.push(e)}}]),e}()).\u0275fac=function(r){return new(r||q)(g.Lb(I.a),g.Lb(l.c),g.Lb(h.a),g.Lb(C.a),g.Lb(y.a),g.Lb(R.a))},q.\u0275cmp=g.Fb({type:q,selectors:[["app-buy-car-item"]],inputs:{car:"car"},decls:58,vars:56,consts:[[1,"car-buy-item","car-item"],[4,"ngIf"],[1,"car-buy-item__car-img",3,"ngStyle"],[1,"car-buy-item__model"],[1,"car-item__hr"],[1,"car-buy-item__description"],[1,"car-item__prise"],[1,"add-to-cart"],[1,"car-buy-item__owner-info"],[1,"owner"],[1,"owner-avatar",3,"ngStyle"],[1,"owner-info"],[3,"href"],["class","car-item__images",4,"ngIf"],["class","no-car-images",4,"ngIf"],["class","edit-container",4,"ngIf"],["type","button",1,"btn-default","narrow-btn",3,"click"],[1,"car-item__images"],[1,"btn-default","narrow-btn",3,"click"],[3,"carImgs",4,"ngIf"],[3,"carImgs"],[1,"no-car-images"],[1,"edit-container"],[1,"edit-container__form",3,"formGroup","ngSubmit"],[1,"edit-container__form__car-img"],["formControlName","carImg","type","file","accept",".png,.jpg,.jpeg,.svg,.heic",2,"display","none",3,"change"],["chooseCarImg",""],[1,"car-img-container"],[3,"src"],[1,"edit-container__form__text-area"],[1,"label-el"],["formControlName","description"],[1,"edit-container__form__price"],["type","number","name","price","formControlName","price"],[1,"edit-container__form__car-images"],["class","images-container",4,"ngIf"],[1,"select-images"],["formControlName","carImgs","type","file","accept",".png,.jpg,.jpeg,.svg,.heic","multiple","multiple",2,"display","none",3,"change"],["chooseCarImgs",""],["type","button",1,"btn-default","narrow-btn","ng-star-inserted",3,"click"],[1,"edit-container__form__buttons"],["type","submit",1,"btn-default","narrow-btn","submit"],["class","error-msg",4,"ngIf"],[1,"label-el","no-images"],[1,"images-container"],[1,"images"],["class","img-element",4,"ngFor","ngForOf"],[1,"img-element"],[3,"click"],[1,"error-msg"]],template:function(r,e){1&r&&(g.Rb(0,"div",0),g.vc(1,Q,1,0,"app-loading-spinner",1),g.Mb(2,"div",2),g.Rb(3,"div",3),g.Rb(4,"p"),g.xc(5),g.Qb(),g.Rb(6,"p"),g.xc(7),g.Qb(),g.Qb(),g.Mb(8,"hr",4),g.Rb(9,"div",5),g.Rb(10,"p"),g.xc(11),g.Qb(),g.Qb(),g.Mb(12,"hr",4),g.Rb(13,"div",6),g.Rb(14,"div"),g.Rb(15,"p"),g.xc(16),g.Qb(),g.Qb(),g.Rb(17,"div",7),g.Rb(18,"p"),g.xc(19,"Add to Cart"),g.Qb(),g.Qb(),g.Qb(),g.Mb(20,"hr",4),g.Rb(21,"div",8),g.Rb(22,"div",9),g.Rb(23,"p"),g.xc(24,"Owner"),g.Qb(),g.vc(25,A,3,0,"div",1),g.Qb(),g.Mb(26,"div",10),g.bc(27,"async"),g.bc(28,"getUserInfo"),g.Rb(29,"div",11),g.Rb(30,"p"),g.xc(31),g.bc(32,"async"),g.bc(33,"getUserInfo"),g.Qb(),g.Rb(34,"p"),g.xc(35," Phone: "),g.Rb(36,"a",12),g.bc(37,"async"),g.bc(38,"getUserInfo"),g.bc(39,"async"),g.bc(40,"getUserInfo"),g.xc(41),g.bc(42,"async"),g.bc(43,"getUserInfo"),g.bc(44,"async"),g.bc(45,"getUserInfo"),g.Qb(),g.Qb(),g.Rb(46,"p"),g.xc(47,"Email: "),g.Rb(48,"a",12),g.xc(49),g.Qb(),g.Qb(),g.Qb(),g.Qb(),g.Rb(50,"div"),g.Rb(51,"p"),g.xc(52),g.bc(53,"date"),g.Qb(),g.Qb(),g.Rb(54,"div"),g.vc(55,k,4,1,"div",13),g.vc(56,w,2,0,"p",14),g.Qb(),g.vc(57,Y,42,11,"div",15),g.Qb()),2&r&&(g.Ab(1),g.gc("ngIf",e.isLoading),g.Ab(1),g.gc("ngStyle",g.kc(52,V,"url('"+(null==e.car?null:e.car.carImg)+"')")),g.Ab(3),g.yc(e.car.model),g.Ab(2),g.yc(e.car.year),g.Ab(4),g.yc(e.car.description),g.Ab(5),g.zc("$ ",e.car.price,""),g.Ab(9),g.gc("ngIf",e.ownerEmail==e.car.owner),g.Ab(1),g.gc("ngStyle",g.kc(54,V,g.cc(27,19,g.dc(28,21,e.car.owner,"userImg")))),g.Ab(5),g.zc("Name: ",g.cc(32,24,g.dc(33,26,e.car.owner,"name")),""),g.Ab(5),g.ic("href","tel:\n              ",g.cc(37,29,g.dc(38,31,e.car.owner,"phoneCode")),"\n              ",g.cc(39,34,g.dc(40,36,e.car.owner,"phone")),"",g.qc),g.Ab(5),g.Ac(" +",g.cc(42,39,g.dc(43,41,e.car.owner,"phoneCode"))," ",g.cc(44,44,g.dc(45,46,e.car.owner,"phone"))," "),g.Ab(7),g.hc("href","mailto:",e.car.owner,"",g.qc),g.Ab(1),g.yc(e.car.owner),g.Ab(3),g.zc("Created: ",g.dc(53,49,e.car.date.toDate(),"dd.MM.yyyy"),""),g.Ab(3),g.gc("ngIf",e.car.carImages.length>0),g.Ab(1),g.gc("ngIf",0==e.car.carImages.length),g.Ab(1),g.gc("ngIf",e.isInEditMode))},directives:[o.l,o.m,v.a,L.a,l.q,l.l,l.g,l.b,l.k,l.e,l.n,o.k],pipes:[o.b,F.a,o.e],encapsulation:2}),q);function $(r,e){1&r&&(g.Rb(0,"div"),g.Mb(1,"app-loading-spinner"),g.Qb())}function B(r,e){1&r&&g.Mb(0,"app-buy-car-item",6),2&r&&g.gc("car",e.$implicit)}function J(r,e){if(1&r&&(g.Rb(0,"div",4),g.vc(1,B,1,1,"app-buy-car-item",5),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.gc("ngForOf",a.audiCars)}}function X(r,e){if(1&r&&(g.Rb(0,"p",7),g.xc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.yc(a.errorMsg)}}var z,G=((z=function(){function r(e){a(this,r),this.firestore=e,this.isLoading=!0,this.errorMsg=null}return n(r,[{key:"ngOnInit",value:function(){var r=this;this.firestore.getSecondHandAudi().subscribe((function(e){r.audiCars=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.isLoading=!1,r.errorMsg=null}),(function(e){r.isLoading=!1,r.errorMsg=e.message}))}}]),r}()).\u0275fac=function(r){return new(r||z)(g.Lb(h.a))},z.\u0275cmp=g.Fb({type:z,selectors:[["app-audi"]],decls:4,vars:3,consts:[[1,"cars-container"],[4,"ngIf"],["class","cars",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"cars"],[3,"car",4,"ngFor","ngForOf"],[3,"car"],[1,"error-msg"]],template:function(r,e){1&r&&(g.Rb(0,"div",0),g.vc(1,$,2,0,"div",1),g.vc(2,J,2,1,"div",2),g.vc(3,X,2,1,"p",3),g.Qb()),2&r&&(g.Ab(1),g.gc("ngIf",e.isLoading),g.Ab(1),g.gc("ngIf",!e.isLoading),g.Ab(1),g.gc("ngIf",e.errorMsg))},directives:[o.l,v.a,o.k,H],encapsulation:2}),z);function K(r,e){1&r&&(g.Rb(0,"div"),g.Mb(1,"app-loading-spinner"),g.Qb())}function W(r,e){1&r&&g.Mb(0,"app-buy-car-item",6),2&r&&g.gc("car",e.$implicit)}function Z(r,e){if(1&r&&(g.Rb(0,"div",4),g.vc(1,W,1,1,"app-buy-car-item",5),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.gc("ngForOf",a.bmwCars)}}function rr(r,e){if(1&r&&(g.Rb(0,"p",7),g.xc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.yc(a.errorMsg)}}var er,ar=((er=function(){function r(e){a(this,r),this.firestore=e,this.isLoading=!0,this.errorMsg=null}return n(r,[{key:"ngOnInit",value:function(){var r=this;this.firestore.getSecondHandBMW().subscribe((function(e){r.bmwCars=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.isLoading=!1,r.errorMsg=null}),(function(e){r.isLoading=!1,r.errorMsg=e.message}))}}]),r}()).\u0275fac=function(r){return new(r||er)(g.Lb(h.a))},er.\u0275cmp=g.Fb({type:er,selectors:[["app-bmw"]],decls:4,vars:3,consts:[[1,"cars-container"],[4,"ngIf"],["class","cars",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"cars"],[3,"car",4,"ngFor","ngForOf"],[3,"car"],[1,"error-msg"]],template:function(r,e){1&r&&(g.Rb(0,"div",0),g.vc(1,K,2,0,"div",1),g.vc(2,Z,2,1,"div",2),g.vc(3,rr,2,1,"p",3),g.Qb()),2&r&&(g.Ab(1),g.gc("ngIf",e.isLoading),g.Ab(1),g.gc("ngIf",!e.isLoading),g.Ab(1),g.gc("ngIf",e.errorMsg))},directives:[o.l,v.a,o.k,H],encapsulation:2}),er),tr=c("Wcq6"),nr=c("kmnG"),cr=c("FKr1");function ir(r,e){1&r&&g.Mb(0,"app-loading-spinner")}function or(r,e){if(1&r&&(g.Rb(0,"p",28),g.xc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.yc(a.getCarModelsError)}}function sr(r,e){if(1&r&&(g.Rb(0,"p",28),g.xc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.yc(a.getCarManufactureYearError)}}function lr(r,e){if(1&r&&(g.Rb(0,"mat-option",29),g.xc(1),g.Qb()),2&r){var a=e.$implicit;g.gc("value",a.name),g.Ab(1),g.zc(" ",a.name," ")}}function ur(r,e){1&r&&(g.Rb(0,"p",30),g.xc(1," The field is required! "),g.Qb())}function gr(r,e){if(1&r&&(g.Rb(0,"mat-option",29),g.xc(1),g.Qb()),2&r){var a=e.$implicit;g.gc("value",a.year),g.Ab(1),g.zc(" ",a.year," ")}}function br(r,e){1&r&&(g.Rb(0,"p",30),g.xc(1," The field is required! "),g.Qb())}function mr(r,e){1&r&&(g.Rb(0,"p",30),g.xc(1," The field is required! "),g.Qb())}function dr(r,e){1&r&&(g.Rb(0,"p",30),g.xc(1," Please enter information about the condition of your car! "),g.Qb())}function fr(r,e){if(1&r&&(g.Rb(0,"div",15),g.Mb(1,"img",16),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.gc("src",a.carDefaultImg,g.qc)}}function pr(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div",33),g.Mb(1,"img",16),g.Rb(2,"div",34),g.Yb("click",(function(){g.pc(a);var r=e.index;return g.ac(2).removeCarImg(r)})),g.xc(3,"X"),g.Qb(),g.Qb()}if(2&r){var t=e.$implicit;g.Ab(1),g.gc("src",t,g.qc)}}function hr(r,e){if(1&r&&(g.Rb(0,"div",31),g.vc(1,pr,4,1,"div",32),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.gc("ngForOf",a.carImgLocalPaths)}}function vr(r,e){if(1&r&&(g.Rb(0,"p",28),g.xc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.yc(a.sellCarError)}}function Ir(r,e){if(1&r&&(g.Rb(0,"p",28),g.xc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.yc(a.uploadCarImgToFirestoreError)}}function Cr(r,e){if(1&r&&(g.Rb(0,"p",28),g.xc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.yc(a.uploadCarImagesToFirestoreError)}}function yr(r,e){if(1&r&&(g.Rb(0,"p",28),g.xc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.yc(a.getCarImgURLError)}}function Rr(r,e){if(1&r&&(g.Rb(0,"p",28),g.xc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.yc(a.getcarImgURLsError)}}var Lr,Fr=function(r){return{"invalid no-border":r}},Qr=((Lr=function(){function r(e,t,n,c,i,o){a(this,r),this.formBuilder=e,this.firestore=t,this.additionUserInfoService=n,this.angularFireStorage=c,this.generateIdService=i,this.router=o,this.carDefaultImg="../../../assets/img/cell-buy-car/upload-img.png",this.carImgLocalPath=this.carDefaultImg,this.carFiles=[],this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.carModels=[],this.carManufactureYears=[],this.getCarModelsError=null,this.getCarManufactureYearError=null,this.sellCarError=null,this.uploadCarImgToFirestoreError=null,this.uploadCarImagesToFirestoreError=null,this.getCarImgURLError=null,this.getcarImgURLsError=null,this.isLoading=!1}return n(r,[{key:"ngOnInit",value:function(){var r=this;this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe((function(e){r.userAdditionalData=e})),this.sellCarForm=this.formBuilder.group({model:new l.d(null,l.p.required),year:new l.d(null,l.p.required),carImg:new l.d(null,l.p.required),description:new l.d(null,l.p.required),price:new l.d(null,l.p.required),carImgs:new l.d(null)}),this.firestore.getSecondHandCarsLink().subscribe((function(e){r.carModels=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.getCarModelsError=null}),(function(e){r.getCarModelsError=e.message})),this.firestore.getCarManufactureYear().subscribe((function(e){r.carManufactureYears=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.getCarManufactureYearError=null}),(function(e){r.getCarManufactureYearError=e.message}))}},{key:"ngOnDestroy",value:function(){this.userAdditionalInfoSub.unsubscribe()}},{key:"onSubmit",value:function(r){var e=this;if(r.valid){this.isLoading=!0;var a=this.generateIdService.generateId();this.onUploadCarImgToFirestore(a).then((function(){e.onUploadCarImagesToFirestore(a).then((function(){var t=r.value.model,n=r.value.year,c=r.value.carImg,i=r.value.description.trim(),o=r.value.price,s=e.userAdditionalData[0].email,l=tr.firestore.Timestamp.now();e.firestore.setSecondHandCar({model:t,year:n,carImg:c,description:i,price:o,owner:s,id:a,date:l,carImages:r.value.carImgs}).then((function(){e.isLoading=!1,e.sellCarForm.reset(),localStorage.setItem("sell-buy-car/buy-LastVisitedLink",JSON.stringify("/sell-buy-car/buy/"+t.toLowerCase())),e.router.navigate(["/sell-buy-car/buy/"+t.toLowerCase()]),e.carImgNames=[],e.carImgLocalPaths=[],e.carImgURLs=[],e.carImgLocalPath=e.carDefaultImg,e.sellCarError=null})).catch((function(r){e.sellCarError=r.message}))}))}))}}},{key:"onChooseCarImg",value:function(r){var e=this;if(this.carFile=r.target.files[0],this.carFile){var a=new FileReader;a.onload=function(r){e.carImgLocalPath=r.target.result},a.readAsDataURL(r.target.files[0])}else this.carImgLocalPath=this.carDefaultImg}},{key:"onUploadCarImgToFirestore",value:function(r){var e=this;return new Promise((function(a){e.angularFireStorage.upload("/carsForSell/"+e.sellCarForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"/"+e.carFile.name,e.carFile).then((function(r){r.ref.getDownloadURL().then((function(r){e.sellCarForm.value.carImg=r,e.getCarImgURLError=null,a()})).catch((function(r){e.getCarImgURLError=r.message})),e.uploadCarImgToFirestoreError=null})).catch((function(r){e.uploadCarImgToFirestoreError=r.message}))}))}},{key:"onChooseCarImgs",value:function(r){for(var e=this,a=0;a<r.target.files.length;a++){this.carFiles.push(r.target.files[a]);var t=new FileReader;t.onload=function(r){e.carImgLocalPaths.push(r.target.result)},t.readAsDataURL(r.target.files[a]),this.carImgNames.push(this.carFiles[a].name)}}},{key:"onUploadCarImagesToFirestore",value:function(r){var e=this;return new Promise((function(a){0==e.carImgNames.length&&(e.sellCarForm.value.carImgs=e.carImgURLs,a());for(var t=0;t<e.carImgNames.length;t++)e.angularFireStorage.upload("/carsForSell/"+e.sellCarForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"//carImages/"+e.generateIdService.generateId()+"-"+e.carImgNames[t],e.carFiles[t]).then((function(r){r.ref.getDownloadURL().then((function(r){e.carImgURLs.push(r),e.carImgURLs.length==e.carImgNames.length&&(e.sellCarForm.value.carImgs=e.carImgURLs,e.getcarImgURLsError=null,a())})).catch((function(r){e.getcarImgURLsError=r.message})),e.uploadCarImagesToFirestoreError=null})).catch((function(r){e.uploadCarImagesToFirestoreError=r.message}))}))}},{key:"removeCarImg",value:function(r){this.carImgLocalPaths.splice(r,1),this.carImgNames.splice(r,1),this.carFiles.splice(r,1),0==this.carFiles&&(this.sellCarForm.value.carImgs=null)}}]),r}()).\u0275fac=function(r){return new(r||Lr)(g.Lb(l.c),g.Lb(h.a),g.Lb(C.a),g.Lb(y.a),g.Lb(R.a),g.Lb(s.b))},Lr.\u0275cmp=g.Fb({type:Lr,selectors:[["app-sell-car"]],decls:60,vars:25,consts:[[1,"sell-car-container"],[4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"sell-car-container__form",3,"formGroup","ngSubmit"],[1,"sell-car-container__form__drop-downs"],[1,"sell-car-container__form__drop-downs__el"],[1,"el-label"],[3,"ngClass"],["formControlName","model"],[3,"value",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],["formControlName","year"],[1,"sell-car-container__form__drop-downs__el","price"],["type","number","name","price","formControlName","price"],[1,"sell-car-container__form__hr"],[1,"defaut-img"],[3,"src"],["formControlName","carImg","type","file","accept",".png,.jpg,.jpeg,.svg,.heic",2,"display","none",3,"change"],["chooseCarImg",""],["type","button",1,"button","btn-default","narrow-btn","ng-star-inserted",3,"click"],[1,"info-text"],["placeholder","Description...","formControlName","description",1,"textarea"],[1,"sell-car-container__form__car-images"],["class","defaut-img",4,"ngIf"],["class","img-container",4,"ngIf"],["formControlName","carImgs","type","file","accept",".png,.jpg,.jpeg,.svg,.heic","multiple","multiple",2,"display","none",3,"change"],["chooseCarImgs",""],["type","submit",1,"button","btn-default","narrow-btn","ng-star-inserted",3,"disabled"],[1,"error-msg"],[3,"value"],[1,"error"],[1,"img-container"],["class","img-element",4,"ngFor","ngForOf"],[1,"img-element"],[3,"click"]],template:function(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div",0),g.vc(1,ir,1,0,"app-loading-spinner",1),g.Rb(2,"div"),g.vc(3,or,2,1,"p",2),g.vc(4,sr,2,1,"p",2),g.Qb(),g.Rb(5,"form",3),g.Yb("ngSubmit",(function(){return e.onSubmit(e.sellCarForm)})),g.Rb(6,"div",4),g.Rb(7,"div",5),g.Rb(8,"p",6),g.xc(9,"Model"),g.Qb(),g.Rb(10,"mat-form-field",7),g.Rb(11,"mat-select",8),g.vc(12,lr,2,2,"mat-option",9),g.Qb(),g.Qb(),g.vc(13,ur,2,0,"p",10),g.Qb(),g.Rb(14,"div",5),g.Rb(15,"p",6),g.xc(16,"Year"),g.Qb(),g.Rb(17,"mat-form-field",7),g.Rb(18,"mat-select",11),g.vc(19,gr,2,2,"mat-option",9),g.Qb(),g.Qb(),g.vc(20,br,2,0,"p",10),g.Qb(),g.Rb(21,"div",12),g.Rb(22,"p",6),g.xc(23,"Price"),g.Qb(),g.Mb(24,"input",13),g.vc(25,mr,2,0,"p",10),g.Qb(),g.Qb(),g.Mb(26,"hr",14),g.Rb(27,"div"),g.Rb(28,"div",15),g.Mb(29,"img",16),g.Qb(),g.Rb(30,"input",17,18),g.Yb("change",(function(r){return e.onChooseCarImg(r)})),g.Qb(),g.Rb(32,"button",19),g.Yb("click",(function(){return g.pc(a),g.nc(31).click()})),g.xc(33,"Ch\u043eose Image"),g.Qb(),g.Rb(34,"p",20),g.xc(35,"(The field is mandatory)"),g.Qb(),g.Qb(),g.Mb(36,"hr",14),g.Rb(37,"div"),g.Mb(38,"textarea",21),g.vc(39,dr,2,0,"p",10),g.Qb(),g.Mb(40,"hr",14),g.Rb(41,"div",22),g.vc(42,fr,2,1,"div",23),g.vc(43,hr,2,1,"div",24),g.Rb(44,"button",19),g.Yb("click",(function(){return g.pc(a),g.nc(49).click()})),g.xc(45,"Ch\u043eose Images"),g.Qb(),g.Rb(46,"p",20),g.xc(47,"(You could add images later)"),g.Qb(),g.Rb(48,"input",25,26),g.Yb("change",(function(r){return e.onChooseCarImgs(r)})),g.Qb(),g.Qb(),g.Mb(50,"hr",14),g.Rb(51,"div"),g.Rb(52,"button",27),g.xc(53,"Add to the Shop"),g.Qb(),g.Qb(),g.Rb(54,"div"),g.vc(55,vr,2,1,"p",2),g.vc(56,Ir,2,1,"p",2),g.vc(57,Cr,2,1,"p",2),g.vc(58,yr,2,1,"p",2),g.vc(59,Rr,2,1,"p",2),g.Qb(),g.Qb(),g.Qb()}2&r&&(g.Ab(1),g.gc("ngIf",e.isLoading),g.Ab(2),g.gc("ngIf",e.getCarModelsError),g.Ab(1),g.gc("ngIf",e.getCarManufactureYearError),g.Ab(1),g.gc("formGroup",e.sellCarForm),g.Ab(5),g.gc("ngClass",g.kc(21,Fr,!e.sellCarForm.get("model").valid&&e.sellCarForm.get("model").touched)),g.Ab(2),g.gc("ngForOf",e.carModels),g.Ab(1),g.gc("ngIf",!e.sellCarForm.get("model").valid&&e.sellCarForm.get("model").touched),g.Ab(4),g.gc("ngClass",g.kc(23,Fr,!e.sellCarForm.get("year").valid&&e.sellCarForm.get("year").touched)),g.Ab(2),g.gc("ngForOf",e.carManufactureYears),g.Ab(1),g.gc("ngIf",!e.sellCarForm.get("year").valid&&e.sellCarForm.get("year").touched),g.Ab(5),g.gc("ngIf",!e.sellCarForm.get("price").valid&&e.sellCarForm.get("price").touched),g.Ab(4),g.gc("src",e.carImgLocalPath,g.qc),g.Ab(10),g.gc("ngIf",!e.sellCarForm.get("description").valid&&e.sellCarForm.get("description").touched),g.Ab(3),g.gc("ngIf",0==e.carImgLocalPaths.length),g.Ab(1),g.gc("ngIf",e.carImgLocalPaths.length>0),g.Ab(9),g.gc("disabled",!e.sellCarForm.valid),g.Ab(3),g.gc("ngIf",e.sellCarError),g.Ab(1),g.gc("ngIf",e.uploadCarImgToFirestoreError),g.Ab(1),g.gc("ngIf",e.uploadCarImagesToFirestoreError),g.Ab(1),g.gc("ngIf",e.getCarImgURLError),g.Ab(1),g.gc("ngIf",e.getcarImgURLsError))},directives:[o.l,l.q,l.l,l.g,nr.b,o.j,u.a,l.k,l.e,o.k,l.n,l.b,v.a,cr.f],encapsulation:2}),Lr),Ar=c("XupT");function Sr(r,e){if(1&r&&(g.Rb(0,"p",2),g.xc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.yc(a.getCarLinksErrorMsg)}}var kr,wr,Er=((kr=function(){function r(e,t,n){a(this,r),this.firestore=e,this.subjectsService=t,this.router=n,this.carLinks=[]}return n(r,[{key:"ngOnInit",value:function(){var r=this;this.isLoadingSub=this.subjectsService.isLoadingSubject.subscribe((function(e){r.isLoading=e})),this.firestore.getSecondHandCarsLink().subscribe((function(e){r.carLinks=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.subjectsService.loaded(),r.getCarLinksErrorMsg=null}),(function(e){r.subjectsService.loaded(),r.getCarLinksErrorMsg=e.message}));var e=JSON.parse(localStorage.getItem("sell-buy-car/buy-LastVisitedLink")),a=JSON.parse(localStorage.getItem("sell-buy-car-LastVisitedLink"));e&&"/sell-buy-car/buy"==a.toString()&&this.router.navigate([e])}},{key:"ngOnDestroy",value:function(){this.isLoadingSub.unsubscribe()}}]),r}()).\u0275fac=function(r){return new(r||kr)(g.Lb(h.a),g.Lb(I.a),g.Lb(s.b))},kr.\u0275cmp=g.Fb({type:kr,selectors:[["app-buy-car"]],decls:3,vars:3,consts:[["class","error-msg",4,"ngIf"],[3,"carLinks","currentLink"],[1,"error-msg"]],template:function(r,e){1&r&&(g.Rb(0,"div"),g.vc(1,Sr,2,1,"p",0),g.Mb(2,"app-categories-router",1),g.Qb()),2&r&&(g.Ab(1),g.gc("ngIf",e.getCarLinksErrorMsg),g.Ab(1),g.gc("carLinks",e.carLinks)("currentLink","sell-buy-car/buy"))},directives:[o.l,Ar.a],encapsulation:2}),kr),Mr=c("PCNd"),xr=((wr=function r(){a(this,r)}).\u0275mod=g.Jb({type:wr}),wr.\u0275inj=g.Ib({factory:function(r){return new(r||wr)},imports:[[o.c,l.o,Mr.a,u.b,s.e.forChild([{path:"",component:f,canActivate:[p.a],children:[{path:"buy",component:Er,children:[{path:"audi",component:G},{path:"bmw",component:ar},{path:"**",redirectTo:"audi"}]},{path:"sell",component:Qr},{path:"**",redirectTo:"buy"}]}])]]}),wr)}}])}();