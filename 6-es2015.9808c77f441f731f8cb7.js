(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UyQ7:function(t,e,n){"use strict";n.r(e),n.d(e,"CommentsModule",(function(){return R}));var r=n("ofXK"),i=n("3Pt+"),o=n("tyNb"),s=n("Wcq6"),c=n("fXoL"),a=n("T/S4"),b=n("IYfF"),m=n("V86y"),l=n("zy28"),d=n("lJxs");let u=(()=>{class t{constructor(t){this.firestore=t}transform(t){return this.firestore.getRegistration(t).pipe(Object(d.a)(t=>t.map(t=>Object.assign({id:t.payload.doc.id},t.payload.doc.data()))[0].userImg))}}return t.\u0275fac=function(e){return new(e||t)(c.Lb(a.a))},t.\u0275pipe=c.Kb({name:"getImage",type:t,pure:!0}),t})();function p(t,e){1&t&&c.Mb(0,"app-loading-spinner")}function f(t,e){if(1&t&&(c.Qb(0,"div",21),c.Qb(1,"div",9),c.Qb(2,"div",10),c.Mb(3,"img",11),c.ac(4,"async"),c.ac(5,"getImage"),c.Qb(6,"p",12),c.rc(7),c.Pb(),c.Pb(),c.Qb(8,"p",13),c.rc(9),c.ac(10,"date"),c.ac(11,"date"),c.Pb(),c.Pb(),c.Qb(12,"div",14),c.Qb(13,"p",15),c.rc(14),c.Pb(),c.Pb(),c.Pb()),2&t){const t=e.$implicit;c.Ab(3),c.fc("src",c.bc(4,5,c.bc(5,7,t.email)),c.lc),c.Ab(4),c.tc(" ",t.name," "),c.Ab(2),c.uc(" ",c.cc(10,9,t.date.toDate(),"dd.MM.yyyy")," at ",c.cc(11,12,t.date.toDate(),"HH:mm")," "),c.Ab(5),c.sc(t.comment)}}function g(t,e){if(1&t){const t=c.Rb();c.Qb(0,"button",22),c.Xb("click",(function(){c.kc(t);const e=c.Zb().$implicit;return c.Zb().isReply=e.id})),c.rc(1,"Reply"),c.Pb()}}function h(t,e){if(1&t){const t=c.Rb();c.Qb(0,"button",22),c.Xb("click",(function(){return c.kc(t),c.Zb(2).closeReplay()})),c.rc(1,"Close Reply"),c.Pb()}}function y(t,e){if(1&t&&(c.Qb(0,"p",27),c.rc(1),c.Pb()),2&t){const t=c.Zb(3);c.Ab(1),c.sc(t.errorMsgOnReply)}}function A(t,e){if(1&t){const t=c.Rb();c.Qb(0,"form",23),c.Xb("ngSubmit",(function(){c.kc(t);const e=c.Zb().$implicit,n=c.Zb();return n.onReply(e.id,n.replyForm)})),c.Qb(1,"div"),c.Mb(2,"textarea",24),c.Pb(),c.Qb(3,"div"),c.Qb(4,"button",25),c.rc(5,"Add your comment"),c.Pb(),c.qc(6,y,2,1,"p",26),c.Pb(),c.Pb()}if(2&t){const t=c.Zb(2);c.fc("formGroup",t.replyForm),c.Ab(4),c.fc("disabled",!t.replyForm.valid),c.Ab(2),c.fc("ngIf",t.errorMsgOnReply)}}function P(t,e){if(1&t&&(c.Qb(0,"div",8),c.Qb(1,"div",9),c.Qb(2,"div",10),c.Mb(3,"img",11),c.ac(4,"async"),c.ac(5,"getImage"),c.Qb(6,"p",12),c.rc(7),c.Pb(),c.Pb(),c.Qb(8,"p",13),c.rc(9),c.ac(10,"date"),c.ac(11,"date"),c.Pb(),c.Pb(),c.Qb(12,"div",14),c.Qb(13,"p",15),c.rc(14),c.Pb(),c.Qb(15,"div",16),c.qc(16,f,15,15,"div",17),c.Pb(),c.Qb(17,"div",18),c.qc(18,g,2,0,"button",19),c.qc(19,h,2,0,"button",19),c.Pb(),c.qc(20,A,7,3,"form",20),c.Pb(),c.Pb()),2&t){const t=e.$implicit,n=c.Zb();c.Ab(3),c.fc("src",c.bc(4,9,c.bc(5,11,t.email)),c.lc),c.Ab(4),c.tc(" ",t.name," "),c.Ab(2),c.uc(" ",c.cc(10,13,t.date.toDate(),"dd.MM.yyyy")," at ",c.cc(11,16,t.date.toDate(),"HH:mm")," "),c.Ab(5),c.sc(t.comment),c.Ab(2),c.fc("ngForOf",t.replies),c.Ab(2),c.fc("ngIf",n.isAuth),c.Ab(1),c.fc("ngIf",n.isReply==t.id),c.Ab(1),c.fc("ngIf",n.isReply==t.id)}}function v(t,e){1&t&&(c.Qb(0,"div",28),c.Qb(1,"p"),c.rc(2,"Please Sign in to add your comment!"),c.Pb(),c.Pb())}function Q(t,e){if(1&t&&(c.Qb(0,"p",27),c.rc(1),c.Pb()),2&t){const t=c.Zb(2);c.Ab(1),c.sc(t.errorMsgOnSubmit)}}function M(t,e){if(1&t&&(c.Qb(0,"p",27),c.rc(1),c.Pb()),2&t){const t=c.Zb(2);c.Ab(1),c.sc(t.errorMsgOnloadComments)}}function I(t,e){if(1&t){const t=c.Rb();c.Qb(0,"form",29),c.Xb("ngSubmit",(function(){c.kc(t);const e=c.Zb();return e.onSubmit(e.postForm)})),c.Qb(1,"div"),c.Mb(2,"textarea",30),c.Pb(),c.Qb(3,"div"),c.Qb(4,"button",25),c.rc(5,"Add your comment"),c.Pb(),c.qc(6,Q,2,1,"p",26),c.Pb(),c.qc(7,M,2,1,"p",26),c.Pb()}if(2&t){const t=c.Zb();c.fc("formGroup",t.postForm),c.Ab(4),c.fc("disabled",!t.postForm.valid),c.Ab(2),c.fc("ngIf",t.errorMsgOnSubmit),c.Ab(1),c.fc("ngIf",t.errorMsgOnloadComments)}}let O=(()=>{class t{constructor(t,e,n,r){this.firestore=t,this.formBuilder=e,this.authService=n,this.additionUserInfoService=r,this.isAuth=!1,this.isLoading=!1,this.isReply=null,this.errorMsgOnloadComments=null,this.errorMsgOnSubmit=null,this.errorMsgOnReply=null}ngOnInit(){this.subUser=this.authService.user.subscribe(t=>{this.isAuth=!!t}),this.additionUserInfoService.getUserAdditionalData(),this.userAdditionalDataSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe(t=>{this.userAdditionalData=t}),this.isLoading=!0,this.firestore.getComments().subscribe(t=>{this.comments=t.map(t=>Object.assign({id:t.payload.doc.id},t.payload.doc.data())),this.isLoading=!1,this.errorMsgOnloadComments=null},t=>{this.isLoading=!1,this.errorMsgOnloadComments=t.message}),this.postForm=this.formBuilder.group({commentArea:new i.d(null,i.p.required)}),this.replyForm=this.formBuilder.group({replyArea:new i.d(null,i.p.required)})}ngOnDestroy(){this.subUser.unsubscribe(),this.userAdditionalDataSub.unsubscribe()}onSubmit(t){if(!this.postForm.valid)return;const e=this.userAdditionalData[0].name,n=this.userAdditionalData[0].email,r=s.firestore.Timestamp.now();this.firestore.createComment({name:e,email:n,date:r,comment:t.value.commentArea}).then(()=>{this.postForm.reset(),this.errorMsgOnSubmit=null}).catch(t=>{this.errorMsgOnSubmit=t.message})}onReply(t,e){if(!this.replyForm.valid)return;const n=this.userAdditionalData[0].name,r=this.userAdditionalData[0].email,i=s.firestore.Timestamp.now();this.firestore.updateComment({name:n,email:r,date:i,comment:e.value.replyArea,id:t}).then(()=>{this.isReply=null,this.replyForm.reset(),this.errorMsgOnReply=null}).catch(t=>{this.errorMsgOnReply=t.message})}closeReplay(){this.isReply=null,this.replyForm.reset()}}return t.\u0275fac=function(e){return new(e||t)(c.Lb(a.a),c.Lb(i.c),c.Lb(b.a),c.Lb(m.a))},t.\u0275cmp=c.Fb({type:t,selectors:[["app-comments"]],decls:10,vars:4,consts:[[1,"container"],[1,"comments-container",2,"position","relative"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[1,"comment-header"],[1,"comment-header-left"],[1,"comment-img",3,"src"],[1,"comment-name"],[1,"comment-date"],[1,"comment-content"],[1,"comment-content-text"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply-btns"],["class","btn-default narrow-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"reply"],[1,"btn-default","narrow-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],["class","error-msg",4,"ngIf"],[1,"error-msg"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(t,e){1&t&&(c.Qb(0,"div",0),c.Qb(1,"div",1),c.qc(2,p,1,0,"app-loading-spinner",2),c.Qb(3,"p",3),c.rc(4,"Comments"),c.Pb(),c.Qb(5,"div"),c.qc(6,P,21,19,"div",4),c.Mb(7,"hr",5),c.qc(8,v,3,0,"div",6),c.qc(9,I,8,4,"form",7),c.Pb(),c.Pb(),c.Pb()),2&t&&(c.Ab(2),c.fc("ngIf",e.isLoading),c.Ab(4),c.fc("ngForOf",e.comments),c.Ab(2),c.fc("ngIf",!e.isAuth),c.Ab(1),c.fc("ngIf",e.isAuth&&null==e.isReply))},directives:[r.l,r.k,l.a,i.q,i.l,i.g,i.b,i.k,i.e],pipes:[r.b,u,r.e],encapsulation:2}),t})();var F=n("PCNd");let R=(()=>{class t{}return t.\u0275mod=c.Jb({type:t}),t.\u0275inj=c.Ib({factory:function(e){return new(e||t)},imports:[[r.c,F.a,i.o,o.e.forChild([{path:"",component:O}])]]}),t})()}}]);