(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{F15C:function(r,e,a){"use strict";a.r(e),a.d(e,"SellBuyCarModule",(function(){return Fr}));var t=a("ofXK"),c=a("tyNb"),i=a("3Pt+"),s=a("d3UM"),n=a("fXoL"),o=a("1XCa");const l=function(){return["buy"]},g=function(){return["sell"]};let b=(()=>{class r{constructor(r){this.router=r}ngOnInit(){}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(c.b))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-sell-buy-car"]],decls:9,vars:4,consts:[[1,"container"],[1,"sell-buy-car"],[1,"sell-buy-car__router-links"],["routerLinkActive","categories-active",3,"routerLink"]],template:function(r,e){1&r&&(n.Rb(0,"div",0),n.Mb(1,"app-categories-info"),n.Rb(2,"div",1),n.Rb(3,"ul",2),n.Rb(4,"li",3),n.xc(5,"Buy Second Hand Car"),n.Qb(),n.Rb(6,"li",3),n.xc(7," Sell Your Car"),n.Qb(),n.Qb(),n.Mb(8,"router-outlet"),n.Qb(),n.Qb()),2&r&&(n.Ab(4),n.gc("routerLink",n.jc(2,l)),n.Ab(2),n.gc("routerLink",n.jc(3,g)))},directives:[o.a,c.d,c.c,c.f],encapsulation:2}),r})();var m=a("2CTM"),d=a("T/S4"),u=a("zy28"),h=a("rL3l"),p=a("V86y"),f=a("Vaw3"),I=a("B02C"),v=a("fk3A"),C=a("odcQ");function R(r,e){1&r&&n.Mb(0,"app-loading-spinner")}function F(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div"),n.Rb(1,"button",16),n.Yb("click",(function(){return n.pc(r),n.ac().onEdit()})),n.xc(2,"Edit Car"),n.Qb(),n.Qb()}}function L(r,e){if(1&r&&n.Mb(0,"app-car-images",20),2&r){const r=n.ac(2);n.gc("carImgs",r.car.carImages)}}function Q(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div",17),n.Rb(1,"button",18),n.Yb("click",(function(){n.pc(r);const e=n.ac();return e.onShowCarImages(e.car.id)})),n.xc(2,"View Images"),n.Qb(),n.vc(3,L,1,1,"app-car-images",19),n.Qb()}if(2&r){const r=n.ac();n.Ab(3),n.gc("ngIf",r.carShowImages&&r.carId==r.car.id)}}function y(r,e){1&r&&(n.Rb(0,"p",21),n.xc(1,"No images uploaded"),n.Qb())}function A(r,e){1&r&&(n.Rb(0,"div"),n.Rb(1,"p",43),n.xc(2,"There are no images uploaded"),n.Qb(),n.Qb())}function S(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div",47),n.Mb(1,"img",28),n.Rb(2,"div",48),n.Yb("click",(function(){n.pc(r);const a=e.index,t=e.$implicit;return n.ac(3).deleteCurrentImages(a,t)})),n.xc(3,"X"),n.Qb(),n.Qb()}if(2&r){const r=e.$implicit;n.Ab(1),n.gc("src",r,n.qc)}}function w(r,e){if(1&r&&(n.Rb(0,"div",44),n.Rb(1,"p",30),n.xc(2,"Current Images"),n.Qb(),n.Rb(3,"div",45),n.vc(4,S,4,1,"div",46),n.Qb(),n.Qb()),2&r){const r=n.ac(2);n.Ab(4),n.gc("ngForOf",r.currentCarImages)}}function E(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div",47),n.Mb(1,"img",28),n.Rb(2,"div",48),n.Yb("click",(function(){n.pc(r);const a=e.index;return n.ac(3).removeCarImg(a)})),n.xc(3,"X"),n.Qb(),n.Qb()}if(2&r){const r=e.$implicit;n.Ab(1),n.gc("src",r,n.qc)}}function M(r,e){if(1&r&&(n.Rb(0,"div",44),n.Rb(1,"p",30),n.xc(2,"New Images"),n.Qb(),n.Rb(3,"div",45),n.vc(4,E,4,1,"div",46),n.Qb(),n.Qb()),2&r){const r=n.ac(2);n.Ab(4),n.gc("ngForOf",r.carImgLocalPaths)}}function x(r,e){if(1&r&&(n.Rb(0,"p",49),n.xc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.yc(r.uploadCarImagesToFirestoreError)}}function _(r,e){if(1&r&&(n.Rb(0,"p",49),n.xc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.yc(r.updateSecondHandCarError)}}function U(r,e){if(1&r&&(n.Rb(0,"p",49),n.xc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.yc(r.setcarImgURLsError)}}function k(r,e){if(1&r&&(n.Rb(0,"p",49),n.xc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.yc(r.deleteOldImgError)}}function D(r,e){if(1&r&&(n.Rb(0,"p",49),n.xc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.yc(r.getCarImgURLError)}}function T(r,e){if(1&r&&(n.Rb(0,"p",49),n.xc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.yc(r.uploadCarImgToFirestoreError)}}function N(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div",22),n.Rb(1,"form",23),n.Yb("ngSubmit",(function(){n.pc(r);const e=n.ac();return e.submitCarDetailChanges(e.changeCarDetailsForm)})),n.Rb(2,"div",24),n.Rb(3,"input",25,26),n.Yb("change",(function(e){return n.pc(r),n.ac().onChooseCarImg(e)})),n.Qb(),n.Rb(5,"div",27),n.Mb(6,"img",28),n.Qb(),n.Rb(7,"button",16),n.Yb("click",(function(){return n.pc(r),n.nc(4).click()})),n.xc(8,"Change Car Image"),n.Qb(),n.Qb(),n.Mb(9,"hr",4),n.Rb(10,"div",29),n.Rb(11,"p",30),n.xc(12,"Description"),n.Qb(),n.Mb(13,"textarea",31),n.Qb(),n.Rb(14,"div",32),n.Rb(15,"p",30),n.xc(16,"Price"),n.Qb(),n.Mb(17,"input",33),n.Qb(),n.Mb(18,"hr",4),n.Rb(19,"div",34),n.Rb(20,"div"),n.vc(21,A,3,0,"div",1),n.vc(22,w,5,1,"div",35),n.vc(23,M,5,1,"div",35),n.Qb(),n.Rb(24,"div",36),n.Rb(25,"input",37,38),n.Yb("change",(function(e){return n.pc(r),n.ac().onChooseCarImgs(e)})),n.Qb(),n.Rb(27,"button",39),n.Yb("click",(function(){return n.pc(r),n.nc(26).click()})),n.xc(28," Select Images "),n.Qb(),n.Qb(),n.Qb(),n.Mb(29,"hr",4),n.Rb(30,"div",40),n.Rb(31,"button",41),n.xc(32,"Apply Changes"),n.Qb(),n.Rb(33,"button",16),n.Yb("click",(function(){return n.pc(r),n.ac().onCancel()})),n.xc(34,"Cancel"),n.Qb(),n.Qb(),n.Rb(35,"div"),n.vc(36,x,2,1,"p",42),n.vc(37,_,2,1,"p",42),n.vc(38,U,2,1,"p",42),n.vc(39,k,2,1,"p",42),n.vc(40,D,2,1,"p",42),n.vc(41,T,2,1,"p",42),n.Qb(),n.Qb(),n.Qb()}if(2&r){const r=n.ac();n.Ab(1),n.gc("formGroup",r.changeCarDetailsForm),n.Ab(5),n.gc("src",r.carImgLocalPath,n.qc),n.Ab(15),n.gc("ngIf",!r.car.carImages||0==r.currentCarImages.length),n.Ab(1),n.gc("ngIf",r.currentCarImages.length>0),n.Ab(1),n.gc("ngIf",r.carImgLocalPaths.length>0),n.Ab(13),n.gc("ngIf",r.uploadCarImagesToFirestoreError),n.Ab(1),n.gc("ngIf",r.updateSecondHandCarError),n.Ab(1),n.gc("ngIf",r.setcarImgURLsError),n.Ab(1),n.gc("ngIf",r.deleteOldImgError),n.Ab(1),n.gc("ngIf",r.getCarImgURLError),n.Ab(1),n.gc("ngIf",r.uploadCarImgToFirestoreError)}}const O=function(r){return{"background-image":r}};let P=(()=>{class r{constructor(r,e,a,t,c,i){this.subjectService=r,this.formBuilder=e,this.firestore=a,this.additionUserInfoService=t,this.angularFireStorage=c,this.generateIdService=i,this.isInEditMode=!1,this.ownerEmail=null,this.carFiles=[],this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.currentCarImages=[],this.uploadCarImagesToFirestoreError=null,this.updateSecondHandCarError=null,this.setcarImgURLsError=null,this.isLoading=!1,this.deleteOldImgError=null,this.getCarImgURLError=null,this.uploadCarImgToFirestoreError=null,this.currentImageForDelete=[]}ngOnInit(){this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe(r=>{this.userAdditionalData=r,this.ownerEmail=this.userAdditionalData[0].email}),this.carShowImagesSub=this.subjectService.carShowImagesSubject.subscribe(r=>{this.carShowImages=r}),this.carIdSub=this.subjectService.carIdSubject.subscribe(r=>{this.carId=r}),this.changeCarDetailsForm=this.formBuilder.group({carImg:new i.d(null),model:new i.d(null),description:new i.d(null,i.p.required),price:new i.d(null,i.p.required),carImgs:new i.d(null)}),this.currentCarImages=[...this.car.carImages],this.carImgLocalPath=this.car.carImg}ngOnDestroy(){this.carShowImagesSub.unsubscribe(),this.carIdSub.unsubscribe(),this.userAdditionalInfoSub.unsubscribe()}onShowCarImages(r){this.subjectService.onShowCarImages(r)}submitCarDetailChanges(r){if(!r.valid)return;this.isLoading=!0;const e=this.car.id;let a=this.car.carImg;const t=this.car.model;this.onUploadCarImageToFirestore(e).then(()=>{if(r.value.carImg&&(a=r.value.carImg),this.currentImageForDelete.length>0){for(let r=0;r<this.currentImageForDelete.length;r++)this.firestore.delete(this.currentImageForDelete[r]);this.firestore.setSecondHanCurrentImages({doc:t,id:e,currentImgs:this.currentCarImages})}this.onUploadCarImagesToFirestore(e).then(()=>{if(this.carImgNames.length>0)for(let a=0;a<this.carImgNames.length;a++)this.firestore.updateSecondHanImagesCar({doc:t,id:e,img:r.value.carImgs[a]});this.firestore.updateSecondHandCar({carImg:a,description:r.value.description,price:r.value.price,id:e,doc:t}).then(()=>{this.isLoading=!1,this.updateSecondHandCarError=null,this.onCancel()},r=>{this.updateSecondHandCarError=r.message})})})}onChooseCarImg(r){if(this.carFile=r.target.files[0],this.carFile){const e=new FileReader;e.onload=r=>{this.carImgLocalPath=r.target.result},e.readAsDataURL(r.target.files[0])}else this.carImgLocalPath=this.car.carImg}onUploadCarImageToFirestore(r){return new Promise(e=>{this.carFile||e(),this.angularFireStorage.upload("/carsForSell/"+this.changeCarDetailsForm.value.model+"/"+this.userAdditionalData[0].email+"/"+r+"/"+this.carFile.name,this.carFile).then(r=>{r.ref.getDownloadURL().then(r=>{this.changeCarDetailsForm.value.carImg=r,this.firestore.delete(this.car.carImg).then(()=>{this.deleteOldImgError=null}).catch(r=>{this.deleteOldImgError=r.message}),this.getCarImgURLError=null,e()}).catch(r=>{this.getCarImgURLError=r.message}),this.uploadCarImgToFirestoreError=null}).catch(r=>{this.uploadCarImgToFirestoreError=r.message})})}onChooseCarImgs(r){for(let e=0;e<r.target.files.length;e++){this.carFiles.push(r.target.files[e]);const a=new FileReader;a.onload=r=>{this.carImgLocalPaths.push(r.target.result)},a.readAsDataURL(r.target.files[e]),this.carImgNames.push(this.carFiles[e].name)}}onUploadCarImagesToFirestore(r){return new Promise(e=>{0==this.carImgNames.length&&e();for(let a=0;a<this.carImgNames.length;a++)this.angularFireStorage.upload("/carsForSell/"+this.changeCarDetailsForm.value.model+"/"+this.userAdditionalData[0].email+"/"+r+"//carImages/"+this.generateIdService.generateId()+"-"+this.carImgNames[a],this.carFiles[a]).then(r=>{r.ref.getDownloadURL().then(r=>{this.carImgURLs.push(r),this.carImgURLs.length==this.carImgNames.length&&(this.changeCarDetailsForm.value.carImgs=this.carImgURLs,this.setcarImgURLsError=null,e())}).catch(r=>{this.setcarImgURLsError=r.message}),this.uploadCarImagesToFirestoreError=null}).catch(r=>{this.uploadCarImagesToFirestoreError=r.message})})}onEdit(){this.changeCarDetailsForm.controls.description.setValue(this.car.description),this.changeCarDetailsForm.controls.price.setValue(this.car.price),this.changeCarDetailsForm.controls.model.setValue(this.car.model),this.isInEditMode=!0}removeCarImg(r){this.carImgLocalPaths.splice(r,1),this.carImgNames.splice(r,1),this.carFiles.splice(r,1),0==this.carFiles&&(this.changeCarDetailsForm.value.carImgs=null)}onCancel(){this.carFiles=[],this.carImgLocalPaths=[],this.carImgNames=[],this.changeCarDetailsForm.controls.carImgs.setValue(""),this.changeCarDetailsForm.controls.carImg.setValue(""),this.carImgLocalPath=this.car.carImg,this.currentCarImages=[...this.car.carImages],this.currentImageForDelete=[],this.isInEditMode=!1}deleteCurrentImages(r,e){this.currentCarImages.splice(r,1),this.currentImageForDelete.push(e)}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(h.a),n.Lb(i.c),n.Lb(d.a),n.Lb(p.a),n.Lb(f.a),n.Lb(I.a))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-buy-car-item"]],inputs:{car:"car"},decls:58,vars:56,consts:[[1,"car-buy-item","car-item"],[4,"ngIf"],[1,"car-buy-item__car-img",3,"ngStyle"],[1,"car-buy-item__model"],[1,"car-item__hr"],[1,"car-buy-item__description"],[1,"car-item__prise"],[1,"add-to-cart"],[1,"car-buy-item__owner-info"],[1,"owner"],[1,"owner-avatar",3,"ngStyle"],[1,"owner-info"],[3,"href"],["class","car-item__images",4,"ngIf"],["class","no-car-images",4,"ngIf"],["class","edit-container",4,"ngIf"],["type","button",1,"btn-default","narrow-btn",3,"click"],[1,"car-item__images"],[1,"btn-default","narrow-btn",3,"click"],[3,"carImgs",4,"ngIf"],[3,"carImgs"],[1,"no-car-images"],[1,"edit-container"],[1,"edit-container__form",3,"formGroup","ngSubmit"],[1,"edit-container__form__car-img"],["formControlName","carImg","type","file","accept",".png,.jpg,.jpeg,.svg,.heic",2,"display","none",3,"change"],["chooseCarImg",""],[1,"car-img-container"],[3,"src"],[1,"edit-container__form__text-area"],[1,"label-el"],["formControlName","description"],[1,"edit-container__form__price"],["type","number","name","price","formControlName","price"],[1,"edit-container__form__car-images"],["class","images-container",4,"ngIf"],[1,"select-images"],["formControlName","carImgs","type","file","accept",".png,.jpg,.jpeg,.svg,.heic","multiple","multiple",2,"display","none",3,"change"],["chooseCarImgs",""],["type","button",1,"btn-default","narrow-btn","ng-star-inserted",3,"click"],[1,"edit-container__form__buttons"],["type","submit",1,"btn-default","narrow-btn","submit"],["class","error-msg",4,"ngIf"],[1,"label-el","no-images"],[1,"images-container"],[1,"images"],["class","img-element",4,"ngFor","ngForOf"],[1,"img-element"],[3,"click"],[1,"error-msg"]],template:function(r,e){1&r&&(n.Rb(0,"div",0),n.vc(1,R,1,0,"app-loading-spinner",1),n.Mb(2,"div",2),n.Rb(3,"div",3),n.Rb(4,"p"),n.xc(5),n.Qb(),n.Rb(6,"p"),n.xc(7),n.Qb(),n.Qb(),n.Mb(8,"hr",4),n.Rb(9,"div",5),n.Rb(10,"p"),n.xc(11),n.Qb(),n.Qb(),n.Mb(12,"hr",4),n.Rb(13,"div",6),n.Rb(14,"div"),n.Rb(15,"p"),n.xc(16),n.Qb(),n.Qb(),n.Rb(17,"div",7),n.Rb(18,"p"),n.xc(19,"Add to Cart"),n.Qb(),n.Qb(),n.Qb(),n.Mb(20,"hr",4),n.Rb(21,"div",8),n.Rb(22,"div",9),n.Rb(23,"p"),n.xc(24,"Owner"),n.Qb(),n.vc(25,F,3,0,"div",1),n.Qb(),n.Mb(26,"div",10),n.bc(27,"async"),n.bc(28,"getUserInfo"),n.Rb(29,"div",11),n.Rb(30,"p"),n.xc(31),n.bc(32,"async"),n.bc(33,"getUserInfo"),n.Qb(),n.Rb(34,"p"),n.xc(35," Phone: "),n.Rb(36,"a",12),n.bc(37,"async"),n.bc(38,"getUserInfo"),n.bc(39,"async"),n.bc(40,"getUserInfo"),n.xc(41),n.bc(42,"async"),n.bc(43,"getUserInfo"),n.bc(44,"async"),n.bc(45,"getUserInfo"),n.Qb(),n.Qb(),n.Rb(46,"p"),n.xc(47,"Email: "),n.Rb(48,"a",12),n.xc(49),n.Qb(),n.Qb(),n.Qb(),n.Qb(),n.Rb(50,"div"),n.Rb(51,"p"),n.xc(52),n.bc(53,"date"),n.Qb(),n.Qb(),n.Rb(54,"div"),n.vc(55,Q,4,1,"div",13),n.vc(56,y,2,0,"p",14),n.Qb(),n.vc(57,N,42,11,"div",15),n.Qb()),2&r&&(n.Ab(1),n.gc("ngIf",e.isLoading),n.Ab(1),n.gc("ngStyle",n.kc(52,O,"url('"+(null==e.car?null:e.car.carImg)+"')")),n.Ab(3),n.yc(e.car.model),n.Ab(2),n.yc(e.car.year),n.Ab(4),n.yc(e.car.description),n.Ab(5),n.zc("$ ",e.car.price,""),n.Ab(9),n.gc("ngIf",e.ownerEmail==e.car.owner),n.Ab(1),n.gc("ngStyle",n.kc(54,O,n.cc(27,19,n.dc(28,21,e.car.owner,"userImg")))),n.Ab(5),n.zc("Name: ",n.cc(32,24,n.dc(33,26,e.car.owner,"name")),""),n.Ab(5),n.ic("href","tel:\n              ",n.cc(37,29,n.dc(38,31,e.car.owner,"phoneCode")),"\n              ",n.cc(39,34,n.dc(40,36,e.car.owner,"phone")),"",n.qc),n.Ab(5),n.Ac(" +",n.cc(42,39,n.dc(43,41,e.car.owner,"phoneCode"))," ",n.cc(44,44,n.dc(45,46,e.car.owner,"phone"))," "),n.Ab(7),n.hc("href","mailto:",e.car.owner,"",n.qc),n.Ab(1),n.yc(e.car.owner),n.Ab(3),n.zc("Created: ",n.dc(53,49,e.car.date.toDate(),"dd.MM.yyyy"),""),n.Ab(3),n.gc("ngIf",e.car.carImages.length>0),n.Ab(1),n.gc("ngIf",0==e.car.carImages.length),n.Ab(1),n.gc("ngIf",e.isInEditMode))},directives:[t.l,t.m,u.a,v.a,i.q,i.l,i.g,i.b,i.k,i.e,i.n,t.k],pipes:[t.b,C.a,t.e],encapsulation:2}),r})();function j(r,e){1&r&&(n.Rb(0,"div"),n.Mb(1,"app-loading-spinner"),n.Qb())}function Y(r,e){1&r&&n.Mb(0,"app-buy-car-item",6),2&r&&n.gc("car",e.$implicit)}function q(r,e){if(1&r&&(n.Rb(0,"div",4),n.vc(1,Y,1,1,"app-buy-car-item",5),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.gc("ngForOf",r.audiCars)}}function H(r,e){if(1&r&&(n.Rb(0,"p",7),n.xc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.yc(r.errorMsg)}}let V=(()=>{class r{constructor(r){this.firestore=r,this.isLoading=!0,this.errorMsg=null}ngOnInit(){this.firestore.getSecondHandAudi().subscribe(r=>{this.audiCars=r.map(r=>Object.assign({id:r.payload.doc.id},r.payload.doc.data())),this.isLoading=!1,this.errorMsg=null},r=>{this.isLoading=!1,this.errorMsg=r.message})}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(d.a))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-audi"]],decls:4,vars:3,consts:[[1,"cars-container"],[4,"ngIf"],["class","cars",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"cars"],[3,"car",4,"ngFor","ngForOf"],[3,"car"],[1,"error-msg"]],template:function(r,e){1&r&&(n.Rb(0,"div",0),n.vc(1,j,2,0,"div",1),n.vc(2,q,2,1,"div",2),n.vc(3,H,2,1,"p",3),n.Qb()),2&r&&(n.Ab(1),n.gc("ngIf",e.isLoading),n.Ab(1),n.gc("ngIf",!e.isLoading),n.Ab(1),n.gc("ngIf",e.errorMsg))},directives:[t.l,u.a,t.k,P],encapsulation:2}),r})();function $(r,e){1&r&&(n.Rb(0,"div"),n.Mb(1,"app-loading-spinner"),n.Qb())}function B(r,e){1&r&&n.Mb(0,"app-buy-car-item",6),2&r&&n.gc("car",e.$implicit)}function X(r,e){if(1&r&&(n.Rb(0,"div",4),n.vc(1,B,1,1,"app-buy-car-item",5),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.gc("ngForOf",r.bmwCars)}}function z(r,e){if(1&r&&(n.Rb(0,"p",7),n.xc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.yc(r.errorMsg)}}let G=(()=>{class r{constructor(r){this.firestore=r,this.isLoading=!0,this.errorMsg=null}ngOnInit(){this.firestore.getSecondHandBMW().subscribe(r=>{this.bmwCars=r.map(r=>Object.assign({id:r.payload.doc.id},r.payload.doc.data())),this.isLoading=!1,this.errorMsg=null},r=>{this.isLoading=!1,this.errorMsg=r.message})}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(d.a))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-bmw"]],decls:4,vars:3,consts:[[1,"cars-container"],[4,"ngIf"],["class","cars",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"cars"],[3,"car",4,"ngFor","ngForOf"],[3,"car"],[1,"error-msg"]],template:function(r,e){1&r&&(n.Rb(0,"div",0),n.vc(1,$,2,0,"div",1),n.vc(2,X,2,1,"div",2),n.vc(3,z,2,1,"p",3),n.Qb()),2&r&&(n.Ab(1),n.gc("ngIf",e.isLoading),n.Ab(1),n.gc("ngIf",!e.isLoading),n.Ab(1),n.gc("ngIf",e.errorMsg))},directives:[t.l,u.a,t.k,P],encapsulation:2}),r})();var J=a("Wcq6"),K=a("kmnG"),W=a("FKr1");function Z(r,e){1&r&&n.Mb(0,"app-loading-spinner")}function rr(r,e){if(1&r&&(n.Rb(0,"p",28),n.xc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.yc(r.getCarModelsError)}}function er(r,e){if(1&r&&(n.Rb(0,"p",28),n.xc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.yc(r.getCarManufactureYearError)}}function ar(r,e){if(1&r&&(n.Rb(0,"mat-option",29),n.xc(1),n.Qb()),2&r){const r=e.$implicit;n.gc("value",r.name),n.Ab(1),n.zc(" ",r.name," ")}}function tr(r,e){1&r&&(n.Rb(0,"p",30),n.xc(1," The field is required! "),n.Qb())}function cr(r,e){if(1&r&&(n.Rb(0,"mat-option",29),n.xc(1),n.Qb()),2&r){const r=e.$implicit;n.gc("value",r.year),n.Ab(1),n.zc(" ",r.year," ")}}function ir(r,e){1&r&&(n.Rb(0,"p",30),n.xc(1," The field is required! "),n.Qb())}function sr(r,e){1&r&&(n.Rb(0,"p",30),n.xc(1," The field is required! "),n.Qb())}function nr(r,e){1&r&&(n.Rb(0,"p",30),n.xc(1," Please enter information about the condition of your car! "),n.Qb())}function or(r,e){if(1&r&&(n.Rb(0,"div",15),n.Mb(1,"img",16),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.gc("src",r.carDefaultImg,n.qc)}}function lr(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div",33),n.Mb(1,"img",16),n.Rb(2,"div",34),n.Yb("click",(function(){n.pc(r);const a=e.index;return n.ac(2).removeCarImg(a)})),n.xc(3,"X"),n.Qb(),n.Qb()}if(2&r){const r=e.$implicit;n.Ab(1),n.gc("src",r,n.qc)}}function gr(r,e){if(1&r&&(n.Rb(0,"div",31),n.vc(1,lr,4,1,"div",32),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.gc("ngForOf",r.carImgLocalPaths)}}function br(r,e){if(1&r&&(n.Rb(0,"p",28),n.xc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.yc(r.sellCarError)}}function mr(r,e){if(1&r&&(n.Rb(0,"p",28),n.xc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.yc(r.uploadCarImgToFirestoreError)}}function dr(r,e){if(1&r&&(n.Rb(0,"p",28),n.xc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.yc(r.uploadCarImagesToFirestoreError)}}function ur(r,e){if(1&r&&(n.Rb(0,"p",28),n.xc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.yc(r.getCarImgURLError)}}function hr(r,e){if(1&r&&(n.Rb(0,"p",28),n.xc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.yc(r.getcarImgURLsError)}}const pr=function(r){return{"invalid no-border":r}};let fr=(()=>{class r{constructor(r,e,a,t,c,i){this.formBuilder=r,this.firestore=e,this.additionUserInfoService=a,this.angularFireStorage=t,this.generateIdService=c,this.router=i,this.carDefaultImg="../../../assets/img/cell-buy-car/upload-img.png",this.carImgLocalPath=this.carDefaultImg,this.carFiles=[],this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.carModels=[],this.carManufactureYears=[],this.getCarModelsError=null,this.getCarManufactureYearError=null,this.sellCarError=null,this.uploadCarImgToFirestoreError=null,this.uploadCarImagesToFirestoreError=null,this.getCarImgURLError=null,this.getcarImgURLsError=null,this.isLoading=!1}ngOnInit(){this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe(r=>{this.userAdditionalData=r}),this.sellCarForm=this.formBuilder.group({model:new i.d(null,i.p.required),year:new i.d(null,i.p.required),carImg:new i.d(null,i.p.required),description:new i.d(null,i.p.required),price:new i.d(null,i.p.required),carImgs:new i.d(null)}),this.firestore.getSecondHandCarsLink().subscribe(r=>{this.carModels=r.map(r=>Object.assign({id:r.payload.doc.id},r.payload.doc.data())),this.getCarModelsError=null},r=>{this.getCarModelsError=r.message}),this.firestore.getCarManufactureYear().subscribe(r=>{this.carManufactureYears=r.map(r=>Object.assign({id:r.payload.doc.id},r.payload.doc.data())),this.getCarManufactureYearError=null},r=>{this.getCarManufactureYearError=r.message})}ngOnDestroy(){this.userAdditionalInfoSub.unsubscribe()}onSubmit(r){if(!r.valid)return;this.isLoading=!0;const e=this.generateIdService.generateId();this.onUploadCarImgToFirestore(e).then(()=>{this.onUploadCarImagesToFirestore(e).then(()=>{const a=r.value.model,t=r.value.year,c=r.value.carImg,i=r.value.description.trim(),s=r.value.price,n=this.userAdditionalData[0].email,o=J.firestore.Timestamp.now();this.firestore.setSecondHandCar({model:a,year:t,carImg:c,description:i,price:s,owner:n,id:e,date:o,carImages:r.value.carImgs}).then(()=>{this.isLoading=!1,this.sellCarForm.reset(),localStorage.setItem("sell-buy-car/buy-LastVisitedLink",JSON.stringify("/sell-buy-car/buy/"+a.toLowerCase())),this.router.navigate(["/sell-buy-car/buy/"+a.toLowerCase()]),this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.carImgLocalPath=this.carDefaultImg,this.sellCarError=null}).catch(r=>{this.sellCarError=r.message})})})}onChooseCarImg(r){if(this.carFile=r.target.files[0],this.carFile){const e=new FileReader;e.onload=r=>{this.carImgLocalPath=r.target.result},e.readAsDataURL(r.target.files[0])}else this.carImgLocalPath=this.carDefaultImg}onUploadCarImgToFirestore(r){return new Promise(e=>{this.angularFireStorage.upload("/carsForSell/"+this.sellCarForm.value.model+"/"+this.userAdditionalData[0].email+"/"+r+"/"+this.carFile.name,this.carFile).then(r=>{r.ref.getDownloadURL().then(r=>{this.sellCarForm.value.carImg=r,this.getCarImgURLError=null,e()}).catch(r=>{this.getCarImgURLError=r.message}),this.uploadCarImgToFirestoreError=null}).catch(r=>{this.uploadCarImgToFirestoreError=r.message})})}onChooseCarImgs(r){for(let e=0;e<r.target.files.length;e++){this.carFiles.push(r.target.files[e]);const a=new FileReader;a.onload=r=>{this.carImgLocalPaths.push(r.target.result)},a.readAsDataURL(r.target.files[e]),this.carImgNames.push(this.carFiles[e].name)}}onUploadCarImagesToFirestore(r){return new Promise(e=>{0==this.carImgNames.length&&(this.sellCarForm.value.carImgs=this.carImgURLs,e());for(let a=0;a<this.carImgNames.length;a++)this.angularFireStorage.upload("/carsForSell/"+this.sellCarForm.value.model+"/"+this.userAdditionalData[0].email+"/"+r+"//carImages/"+this.generateIdService.generateId()+"-"+this.carImgNames[a],this.carFiles[a]).then(r=>{r.ref.getDownloadURL().then(r=>{this.carImgURLs.push(r),this.carImgURLs.length==this.carImgNames.length&&(this.sellCarForm.value.carImgs=this.carImgURLs,this.getcarImgURLsError=null,e())}).catch(r=>{this.getcarImgURLsError=r.message}),this.uploadCarImagesToFirestoreError=null}).catch(r=>{this.uploadCarImagesToFirestoreError=r.message})})}removeCarImg(r){this.carImgLocalPaths.splice(r,1),this.carImgNames.splice(r,1),this.carFiles.splice(r,1),0==this.carFiles&&(this.sellCarForm.value.carImgs=null)}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(i.c),n.Lb(d.a),n.Lb(p.a),n.Lb(f.a),n.Lb(I.a),n.Lb(c.b))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-sell-car"]],decls:60,vars:25,consts:[[1,"sell-car-container"],[4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"sell-car-container__form",3,"formGroup","ngSubmit"],[1,"sell-car-container__form__drop-downs"],[1,"sell-car-container__form__drop-downs__el"],[1,"el-label"],[3,"ngClass"],["formControlName","model"],[3,"value",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],["formControlName","year"],[1,"sell-car-container__form__drop-downs__el","price"],["type","number","name","price","formControlName","price"],[1,"sell-car-container__form__hr"],[1,"defaut-img"],[3,"src"],["formControlName","carImg","type","file","accept",".png,.jpg,.jpeg,.svg,.heic",2,"display","none",3,"change"],["chooseCarImg",""],["type","button",1,"button","btn-default","narrow-btn","ng-star-inserted",3,"click"],[1,"info-text"],["placeholder","Description...","formControlName","description",1,"textarea"],[1,"sell-car-container__form__car-images"],["class","defaut-img",4,"ngIf"],["class","img-container",4,"ngIf"],["formControlName","carImgs","type","file","accept",".png,.jpg,.jpeg,.svg,.heic","multiple","multiple",2,"display","none",3,"change"],["chooseCarImgs",""],["type","submit",1,"button","btn-default","narrow-btn","ng-star-inserted",3,"disabled"],[1,"error-msg"],[3,"value"],[1,"error"],[1,"img-container"],["class","img-element",4,"ngFor","ngForOf"],[1,"img-element"],[3,"click"]],template:function(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div",0),n.vc(1,Z,1,0,"app-loading-spinner",1),n.Rb(2,"div"),n.vc(3,rr,2,1,"p",2),n.vc(4,er,2,1,"p",2),n.Qb(),n.Rb(5,"form",3),n.Yb("ngSubmit",(function(){return e.onSubmit(e.sellCarForm)})),n.Rb(6,"div",4),n.Rb(7,"div",5),n.Rb(8,"p",6),n.xc(9,"Model"),n.Qb(),n.Rb(10,"mat-form-field",7),n.Rb(11,"mat-select",8),n.vc(12,ar,2,2,"mat-option",9),n.Qb(),n.Qb(),n.vc(13,tr,2,0,"p",10),n.Qb(),n.Rb(14,"div",5),n.Rb(15,"p",6),n.xc(16,"Year"),n.Qb(),n.Rb(17,"mat-form-field",7),n.Rb(18,"mat-select",11),n.vc(19,cr,2,2,"mat-option",9),n.Qb(),n.Qb(),n.vc(20,ir,2,0,"p",10),n.Qb(),n.Rb(21,"div",12),n.Rb(22,"p",6),n.xc(23,"Price"),n.Qb(),n.Mb(24,"input",13),n.vc(25,sr,2,0,"p",10),n.Qb(),n.Qb(),n.Mb(26,"hr",14),n.Rb(27,"div"),n.Rb(28,"div",15),n.Mb(29,"img",16),n.Qb(),n.Rb(30,"input",17,18),n.Yb("change",(function(r){return e.onChooseCarImg(r)})),n.Qb(),n.Rb(32,"button",19),n.Yb("click",(function(){return n.pc(r),n.nc(31).click()})),n.xc(33,"Ch\u043eose Image"),n.Qb(),n.Rb(34,"p",20),n.xc(35,"(The field is mandatory)"),n.Qb(),n.Qb(),n.Mb(36,"hr",14),n.Rb(37,"div"),n.Mb(38,"textarea",21),n.vc(39,nr,2,0,"p",10),n.Qb(),n.Mb(40,"hr",14),n.Rb(41,"div",22),n.vc(42,or,2,1,"div",23),n.vc(43,gr,2,1,"div",24),n.Rb(44,"button",19),n.Yb("click",(function(){return n.pc(r),n.nc(49).click()})),n.xc(45,"Ch\u043eose Images"),n.Qb(),n.Rb(46,"p",20),n.xc(47,"(You could add images later)"),n.Qb(),n.Rb(48,"input",25,26),n.Yb("change",(function(r){return e.onChooseCarImgs(r)})),n.Qb(),n.Qb(),n.Mb(50,"hr",14),n.Rb(51,"div"),n.Rb(52,"button",27),n.xc(53,"Add to the Shop"),n.Qb(),n.Qb(),n.Rb(54,"div"),n.vc(55,br,2,1,"p",2),n.vc(56,mr,2,1,"p",2),n.vc(57,dr,2,1,"p",2),n.vc(58,ur,2,1,"p",2),n.vc(59,hr,2,1,"p",2),n.Qb(),n.Qb(),n.Qb()}2&r&&(n.Ab(1),n.gc("ngIf",e.isLoading),n.Ab(2),n.gc("ngIf",e.getCarModelsError),n.Ab(1),n.gc("ngIf",e.getCarManufactureYearError),n.Ab(1),n.gc("formGroup",e.sellCarForm),n.Ab(5),n.gc("ngClass",n.kc(21,pr,!e.sellCarForm.get("model").valid&&e.sellCarForm.get("model").touched)),n.Ab(2),n.gc("ngForOf",e.carModels),n.Ab(1),n.gc("ngIf",!e.sellCarForm.get("model").valid&&e.sellCarForm.get("model").touched),n.Ab(4),n.gc("ngClass",n.kc(23,pr,!e.sellCarForm.get("year").valid&&e.sellCarForm.get("year").touched)),n.Ab(2),n.gc("ngForOf",e.carManufactureYears),n.Ab(1),n.gc("ngIf",!e.sellCarForm.get("year").valid&&e.sellCarForm.get("year").touched),n.Ab(5),n.gc("ngIf",!e.sellCarForm.get("price").valid&&e.sellCarForm.get("price").touched),n.Ab(4),n.gc("src",e.carImgLocalPath,n.qc),n.Ab(10),n.gc("ngIf",!e.sellCarForm.get("description").valid&&e.sellCarForm.get("description").touched),n.Ab(3),n.gc("ngIf",0==e.carImgLocalPaths.length),n.Ab(1),n.gc("ngIf",e.carImgLocalPaths.length>0),n.Ab(9),n.gc("disabled",!e.sellCarForm.valid),n.Ab(3),n.gc("ngIf",e.sellCarError),n.Ab(1),n.gc("ngIf",e.uploadCarImgToFirestoreError),n.Ab(1),n.gc("ngIf",e.uploadCarImagesToFirestoreError),n.Ab(1),n.gc("ngIf",e.getCarImgURLError),n.Ab(1),n.gc("ngIf",e.getcarImgURLsError))},directives:[t.l,i.q,i.l,i.g,K.b,t.j,s.a,i.k,i.e,t.k,i.n,i.b,u.a,W.f],encapsulation:2}),r})();var Ir=a("XupT");function vr(r,e){if(1&r&&(n.Rb(0,"p",2),n.xc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.yc(r.getCarLinksErrorMsg)}}let Cr=(()=>{class r{constructor(r,e,a){this.firestore=r,this.subjectsService=e,this.router=a,this.carLinks=[]}ngOnInit(){this.isLoadingSub=this.subjectsService.isLoadingSubject.subscribe(r=>{this.isLoading=r}),this.firestore.getSecondHandCarsLink().subscribe(r=>{this.carLinks=r.map(r=>Object.assign({id:r.payload.doc.id},r.payload.doc.data())),this.subjectsService.loaded(),this.getCarLinksErrorMsg=null},r=>{this.subjectsService.loaded(),this.getCarLinksErrorMsg=r.message});const r=JSON.parse(localStorage.getItem("sell-buy-car/buy-LastVisitedLink"));r&&this.router.navigate([r])}ngOnDestroy(){this.isLoadingSub.unsubscribe()}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(d.a),n.Lb(h.a),n.Lb(c.b))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-buy-car"]],decls:3,vars:3,consts:[["class","error-msg",4,"ngIf"],[3,"carLinks","currentLink"],[1,"error-msg"]],template:function(r,e){1&r&&(n.Rb(0,"div"),n.vc(1,vr,2,1,"p",0),n.Mb(2,"app-categories-router",1),n.Qb()),2&r&&(n.Ab(1),n.gc("ngIf",e.getCarLinksErrorMsg),n.Ab(1),n.gc("carLinks",e.carLinks)("currentLink","sell-buy-car/buy"))},directives:[t.l,Ir.a],encapsulation:2}),r})();var Rr=a("PCNd");let Fr=(()=>{class r{}return r.\u0275mod=n.Jb({type:r}),r.\u0275inj=n.Ib({factory:function(e){return new(e||r)},imports:[[t.c,i.o,Rr.a,s.b,c.e.forChild([{path:"",component:b,canActivate:[m.a],children:[{path:"buy",component:Cr,children:[{path:"audi",component:V},{path:"bmw",component:G},{path:"**",redirectTo:"audi"}]},{path:"sell",component:fr},{path:"**",redirectTo:"buy"}]}])]]}),r})()}}]);