!function(){function r(r){return function(r){if(Array.isArray(r))return e(r)}(r)||function(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}(r)||function(r,a){if(!r)return;if("string"==typeof r)return e(r,a);var t=Object.prototype.toString.call(r).slice(8,-1);"Object"===t&&r.constructor&&(t=r.constructor.name);if("Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return e(r,a)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(r,e){(null==e||e>r.length)&&(e=r.length);for(var a=0,t=new Array(e);a<e;a++)t[a]=r[a];return t}function a(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function t(r,e){for(var a=0;a<e.length;a++){var t=e[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function n(r,e,a){return e&&t(r.prototype,e),a&&t(r,a),r}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{F15C:function(e,t,c){"use strict";c.r(t),c.d(t,"SellBuyCarModule",(function(){return Er}));var i,o=c("ofXK"),s=c("tyNb"),l=c("3Pt+"),u=c("d3UM"),g=c("fXoL"),b=c("1XCa"),m=function(){return["buy"]},d=function(){return["sell"]},f=((i=function(){function r(e){a(this,r),this.router=e}return n(r,[{key:"ngOnInit",value:function(){var r=JSON.parse(localStorage.getItem("sell-buy-car-LastVisitedLink"));r&&this.router.navigate([r])}},{key:"saveLastVisitedLinkToLocalStore",value:function(r){localStorage.setItem("sell-buy-car-LastVisitedLink",JSON.stringify("/sell-buy-car/"+r))}}]),r}()).\u0275fac=function(r){return new(r||i)(g.Lb(s.b))},i.\u0275cmp=g.Fb({type:i,selectors:[["app-sell-buy-car"]],decls:9,vars:4,consts:[[1,"container"],[1,"sell-buy-car"],[1,"sell-buy-car__router-links"],["routerLinkActive","categories-active",3,"routerLink","click"]],template:function(r,e){1&r&&(g.Rb(0,"div",0),g.Mb(1,"app-categories-info"),g.Rb(2,"div",1),g.Rb(3,"ul",2),g.Rb(4,"li",3),g.Yb("click",(function(){return e.saveLastVisitedLinkToLocalStore("buy")})),g.wc(5,"Buy Second Hand Car"),g.Qb(),g.Rb(6,"li",3),g.Yb("click",(function(){return e.saveLastVisitedLinkToLocalStore("sell")})),g.wc(7," Sell Your Car"),g.Qb(),g.Qb(),g.Mb(8,"router-outlet"),g.Qb(),g.Qb()),2&r&&(g.Ab(4),g.gc("routerLink",g.ic(2,m)),g.Ab(2),g.gc("routerLink",g.ic(3,d)))},directives:[b.a,s.d,s.c,s.f],encapsulation:2}),i),p=c("2CTM"),h=c("T/S4"),I=c("zy28"),v=c("rL3l"),C=c("V86y"),R=c("Vaw3"),L=c("B02C"),y=c("fk3A"),w=c("odcQ");function F(r,e){1&r&&g.Mb(0,"app-loading-spinner")}function A(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div"),g.Rb(1,"button",6),g.Yb("click",(function(){return g.oc(a),g.ac().onEdit()})),g.wc(2,"Edit"),g.Qb(),g.Qb()}}function Q(r,e){if(1&r&&g.Mb(0,"app-car-images",10),2&r){var a=g.ac(2);g.gc("carImgs",a.car.carImages)}}function S(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div",7),g.Rb(1,"button",8),g.Yb("click",(function(){g.oc(a);var r=g.ac();return r.onShowCarImages(r.car.id)})),g.wc(2,"View Images"),g.Qb(),g.uc(3,Q,1,1,"app-car-images",9),g.Qb()}if(2&r){var t=g.ac();g.Ab(3),g.gc("ngIf",t.carShowImages&&t.carId==t.car.id)}}function k(r,e){1&r&&(g.Rb(0,"p"),g.wc(1,"There are no images uploaded"),g.Qb())}function E(r,e){1&r&&(g.Rb(0,"div"),g.Rb(1,"p"),g.wc(2,"There are no images uploaded"),g.Qb(),g.Qb())}function M(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div"),g.Mb(1,"img",15),g.Rb(2,"div",24),g.Yb("click",(function(){g.oc(a);var r=e.index,t=e.$implicit;return g.ac(3).deleteCurrentImages(r,t)})),g.wc(3,"X"),g.Qb(),g.Qb()}if(2&r){var t=e.$implicit;g.Ab(1),g.gc("src",t,g.pc)}}function U(r,e){if(1&r&&(g.Rb(0,"div"),g.Rb(1,"p"),g.wc(2,"Current Images"),g.Qb(),g.uc(3,M,4,1,"div",23),g.Qb()),2&r){var a=g.ac(2);g.Ab(3),g.gc("ngForOf",a.currentCarImages)}}function D(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div"),g.Mb(1,"img",15),g.Rb(2,"div",24),g.Yb("click",(function(){g.oc(a);var r=e.index;return g.ac(3).removeCarImg(r)})),g.wc(3,"X"),g.Qb(),g.Qb()}if(2&r){var t=e.$implicit;g.Ab(1),g.gc("src",t,g.pc)}}function O(r,e){if(1&r&&(g.Rb(0,"div"),g.Rb(1,"p"),g.wc(2,"New Images"),g.Qb(),g.Rb(3,"div"),g.uc(4,D,4,1,"div",23),g.Qb(),g.Qb()),2&r){var a=g.ac(2);g.Ab(4),g.gc("ngForOf",a.carImgLocalPaths)}}function T(r,e){1&r&&(g.Rb(0,"p"),g.wc(1,"Select Images"),g.Qb())}function N(r,e){1&r&&(g.Rb(0,"p"),g.wc(1,"Select More Images"),g.Qb())}function P(r,e){if(1&r&&(g.Rb(0,"p",25),g.wc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.xc(a.uploadCarImagesToFirestoreError)}}function j(r,e){if(1&r&&(g.Rb(0,"p",25),g.wc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.xc(a.updateSecondHandCarError)}}function x(r,e){if(1&r&&(g.Rb(0,"p",25),g.wc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.xc(a.setcarImgURLsError)}}function _(r,e){if(1&r&&(g.Rb(0,"p",25),g.wc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.xc(a.deleteOldImgError)}}function Y(r,e){if(1&r&&(g.Rb(0,"p",25),g.wc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.xc(a.getCarImgURLError)}}function V(r,e){if(1&r&&(g.Rb(0,"p",25),g.wc(1),g.Qb()),2&r){var a=g.ac(2);g.Ab(1),g.xc(a.uploadCarImgToFirestoreError)}}function H(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div",11),g.Rb(1,"form",12),g.Yb("ngSubmit",(function(){g.oc(a);var r=g.ac();return r.submitCarDetailChanges(r.changeCarDetailsForm)})),g.Rb(2,"div"),g.Rb(3,"input",13,14),g.Yb("change",(function(r){return g.oc(a),g.ac().onChooseCarImg(r)})),g.Qb(),g.Mb(5,"img",15),g.Rb(6,"button",6),g.Yb("click",(function(){return g.oc(a),g.mc(4).click()})),g.wc(7,"Change Car Image"),g.Qb(),g.Qb(),g.Rb(8,"div"),g.Mb(9,"textarea",16),g.Qb(),g.Rb(10,"div"),g.Mb(11,"input",17),g.Qb(),g.Rb(12,"div"),g.Rb(13,"div"),g.uc(14,E,3,0,"div",1),g.uc(15,U,4,1,"div",1),g.uc(16,O,5,1,"div",1),g.Qb(),g.Rb(17,"div"),g.Rb(18,"input",18,19),g.Yb("change",(function(r){return g.oc(a),g.ac().onChooseCarImgs(r)})),g.Qb(),g.Rb(20,"button",20),g.Yb("click",(function(){return g.oc(a),g.mc(19).click()})),g.uc(21,T,2,0,"p",1),g.uc(22,N,2,0,"p",1),g.Qb(),g.Qb(),g.Qb(),g.Rb(23,"div"),g.Rb(24,"button",21),g.wc(25,"Apply Changes"),g.Qb(),g.Rb(26,"button",6),g.Yb("click",(function(){return g.oc(a),g.ac().onCancel()})),g.wc(27,"Cancel"),g.Qb(),g.Qb(),g.Rb(28,"div"),g.uc(29,P,2,1,"p",22),g.uc(30,j,2,1,"p",22),g.uc(31,x,2,1,"p",22),g.uc(32,_,2,1,"p",22),g.uc(33,Y,2,1,"p",22),g.uc(34,V,2,1,"p",22),g.Qb(),g.Qb(),g.Qb()}if(2&r){var t=g.ac();g.Ab(1),g.gc("formGroup",t.changeCarDetailsForm),g.Ab(4),g.gc("src",t.carImgLocalPath,g.pc),g.Ab(9),g.gc("ngIf",!t.car.carImages),g.Ab(1),g.gc("ngIf",t.currentCarImages.length>0),g.Ab(1),g.gc("ngIf",t.carImgLocalPaths.length>0),g.Ab(5),g.gc("ngIf",!t.currentCarImages),g.Ab(1),g.gc("ngIf",t.currentCarImages),g.Ab(7),g.gc("ngIf",t.uploadCarImagesToFirestoreError),g.Ab(1),g.gc("ngIf",t.updateSecondHandCarError),g.Ab(1),g.gc("ngIf",t.setcarImgURLsError),g.Ab(1),g.gc("ngIf",t.deleteOldImgError),g.Ab(1),g.gc("ngIf",t.getCarImgURLError),g.Ab(1),g.gc("ngIf",t.uploadCarImgToFirestoreError)}}var q,$=function(r){return{"background-image":r}},B=((q=function(){function e(r,t,n,c,i,o){a(this,e),this.subjectService=r,this.formBuilder=t,this.firestore=n,this.additionUserInfoService=c,this.angularFireStorage=i,this.generateIdService=o,this.isInEditMode=!1,this.ownerEmail=null,this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.currentCarImages=[],this.uploadCarImagesToFirestoreError=null,this.updateSecondHandCarError=null,this.setcarImgURLsError=null,this.isLoading=!1,this.deleteOldImgError=null,this.getCarImgURLError=null,this.uploadCarImgToFirestoreError=null,this.currentImageForDelete=[]}return n(e,[{key:"ngOnInit",value:function(){var e=this;this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe((function(r){e.userAdditionalData=r,e.ownerEmail=e.userAdditionalData[0].email})),this.carShowImagesSub=this.subjectService.carShowImagesSubject.subscribe((function(r){e.carShowImages=r})),this.carIdSub=this.subjectService.carIdSubject.subscribe((function(r){e.carId=r})),this.changeCarDetailsForm=this.formBuilder.group({carImg:new l.d(null),model:new l.d(null),description:new l.d(null,l.p.required),price:new l.d(null,l.p.required),carImgs:new l.d(null)}),this.currentCarImages=r(this.car.carImages),this.carImgLocalPath=this.car.carImg}},{key:"ngOnDestroy",value:function(){this.carShowImagesSub.unsubscribe(),this.carIdSub.unsubscribe(),this.userAdditionalInfoSub.unsubscribe()}},{key:"onShowCarImages",value:function(r){this.subjectService.onShowCarImages(r)}},{key:"submitCarDetailChanges",value:function(r){var e=this;if(r.valid){this.isLoading=!0;var a=this.car.id,t=this.car.carImg,n=this.car.model;this.onUploadCarImageToFirestore(a).then((function(){if(r.value.carImg&&(t=r.value.carImg),e.currentImageForDelete.length>0){for(var c=0;c<e.currentImageForDelete.length;c++)e.firestore.delete(e.currentImageForDelete[c]);e.firestore.setSecondHanCurrentImages({doc:n,id:a,currentImgs:e.currentCarImages})}e.onUploadCarImagesToFirestore(a).then((function(){if(e.carImgNames.length>0)for(var c=0;c<e.carImgNames.length;c++)e.firestore.updateSecondHanImagesCar({doc:n,id:a,img:r.value.carImgs[c]});e.firestore.updateSecondHandCar({carImg:t,description:r.value.description,price:r.value.price,id:a,doc:n}).then((function(){e.isLoading=!1,e.updateSecondHandCarError=null,e.onCancel()}),(function(r){e.updateSecondHandCarError=r.message}))}))}))}}},{key:"onChooseCarImg",value:function(r){var e=this;if(this.carFile=r.target.files[0],this.carFile){var a=new FileReader;a.onload=function(r){e.carImgLocalPath=r.target.result},a.readAsDataURL(r.target.files[0])}else this.carImgLocalPath=this.car.carImg}},{key:"onUploadCarImageToFirestore",value:function(r){var e=this;return new Promise((function(a){e.carFile||a(),e.angularFireStorage.upload("/carsForSell/"+e.changeCarDetailsForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"/"+e.carFile.name,e.carFile).then((function(r){r.ref.getDownloadURL().then((function(r){e.changeCarDetailsForm.value.carImg=r,e.firestore.delete(e.car.carImg).then((function(){e.deleteOldImgError=null})).catch((function(r){e.deleteOldImgError=r.message})),e.getCarImgURLError=null,a()})).catch((function(r){e.getCarImgURLError=r.message})),e.uploadCarImgToFirestoreError=null})).catch((function(r){e.uploadCarImgToFirestoreError=r.message}))}))}},{key:"onChooseCarImgs",value:function(r){var e=this;if(this.carFiles=r.target.files,this.carFiles.length>0)for(var a=0;a<this.carFiles.length;a++){var t=new FileReader;t.onload=function(r){e.carImgLocalPaths.push(r.target.result)},t.readAsDataURL(r.target.files[a]),this.carImgNames.push(this.carFiles[a].name)}else this.carFiles=null,this.carImgLocalPaths=[],this.carImgNames=[],this.changeCarDetailsForm.controls.carImgs.setValue("")}},{key:"onUploadCarImagesToFirestore",value:function(r){var e=this;return new Promise((function(a){0==e.carImgNames.length&&a();for(var t=0;t<e.carImgNames.length;t++)e.angularFireStorage.upload("/carsForSell/"+e.changeCarDetailsForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"//carImages/"+e.generateIdService.generateId()+"-"+e.carImgNames[t],e.carFiles[t]).then((function(r){r.ref.getDownloadURL().then((function(r){e.carImgURLs.push(r),e.carImgURLs.length==e.carImgNames.length&&(e.changeCarDetailsForm.value.carImgs=e.carImgURLs,e.setcarImgURLsError=null,a())})).catch((function(r){e.setcarImgURLsError=r.message})),e.uploadCarImagesToFirestoreError=null})).catch((function(r){e.uploadCarImagesToFirestoreError=r.message}))}))}},{key:"onEdit",value:function(){this.changeCarDetailsForm.controls.description.setValue(this.car.description),this.changeCarDetailsForm.controls.price.setValue(this.car.price),this.changeCarDetailsForm.controls.model.setValue(this.car.model),this.isInEditMode=!0}},{key:"removeCarImg",value:function(r){this.carImgLocalPaths.splice(r,1),this.carImgNames.splice(r,1),0==this.carImgLocalPaths&&0==this.carImgNames&&(this.changeCarDetailsForm.value.carImgs=null)}},{key:"onCancel",value:function(){this.carFiles=null,this.carImgLocalPaths=[],this.carImgNames=[],this.changeCarDetailsForm.controls.carImgs.setValue(""),this.changeCarDetailsForm.controls.carImg.setValue(""),this.carImgLocalPath=this.car.carImg,this.currentCarImages=r(this.car.carImages),this.currentImageForDelete=[],this.isInEditMode=!1}},{key:"deleteCurrentImages",value:function(r,e){this.currentCarImages.splice(r,1),this.currentImageForDelete.push(e)}}]),e}()).\u0275fac=function(r){return new(r||q)(g.Lb(v.a),g.Lb(l.c),g.Lb(h.a),g.Lb(C.a),g.Lb(R.a),g.Lb(L.a))},q.\u0275cmp=g.Fb({type:q,selectors:[["app-buy-car-item"]],inputs:{car:"car"},decls:32,vars:41,consts:[[1,"car-item"],[4,"ngIf"],[1,"car-item__img",3,"src"],[1,"comment-img",3,"ngStyle"],["class","car-item__images",4,"ngIf"],["class","test",4,"ngIf"],["type","button",3,"click"],[1,"car-item__images"],[1,"btn-default","narrow-btn",3,"click"],[3,"carImgs",4,"ngIf"],[3,"carImgs"],[1,"test"],[3,"formGroup","ngSubmit"],["formControlName","carImg","type","file","accept",".png,.jpg,.jpeg,.svg,.heic",2,"display","none",3,"change"],["chooseCarImg",""],[3,"src"],["formControlName","description"],["type","number","name","price","formControlName","price"],["formControlName","carImgs","type","file","accept",".png,.jpg,.jpeg,.svg,.heic","multiple","multiple",2,"display","none",3,"change"],["chooseCarImgs",""],["type","button",1,"btn-default","narrow-btn","ng-star-inserted",3,"click"],["type","submit"],["class","error-msg",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"click"],[1,"error-msg"]],template:function(r,e){1&r&&(g.Rb(0,"div",0),g.uc(1,F,1,0,"app-loading-spinner",1),g.Mb(2,"img",2),g.Rb(3,"div"),g.Rb(4,"p"),g.wc(5),g.Qb(),g.Rb(6,"p"),g.wc(7),g.Qb(),g.Rb(8,"p"),g.wc(9),g.Qb(),g.Rb(10,"p"),g.wc(11),g.Qb(),g.Qb(),g.uc(12,A,3,0,"div",1),g.Rb(13,"p"),g.wc(14),g.bc(15,"date"),g.Qb(),g.Rb(16,"div"),g.Mb(17,"div",3),g.bc(18,"async"),g.bc(19,"getUserInfo"),g.Rb(20,"div"),g.wc(21),g.bc(22,"async"),g.bc(23,"getUserInfo"),g.bc(24,"async"),g.bc(25,"getUserInfo"),g.bc(26,"async"),g.bc(27,"getUserInfo"),g.Qb(),g.Qb(),g.Rb(28,"div"),g.uc(29,S,4,1,"div",4),g.uc(30,k,2,0,"p",1),g.Qb(),g.uc(31,H,35,13,"div",5),g.Qb()),2&r&&(g.Ab(1),g.gc("ngIf",e.isLoading),g.Ab(1),g.gc("src",e.car.carImg,g.pc),g.Ab(3),g.xc(e.car.model),g.Ab(2),g.xc(e.car.year),g.Ab(2),g.xc(e.car.description),g.Ab(2),g.xc(e.car.price),g.Ab(1),g.gc("ngIf",e.ownerEmail==e.car.owner),g.Ab(2),g.xc(g.dc(15,16,e.car.date.toDate(),"dd.MM.yyyy")),g.Ab(3),g.gc("ngStyle",g.jc(39,$,g.cc(18,19,g.dc(19,21,e.car.owner,"userImg")))),g.Ab(4),g.Ac(" ",g.cc(22,24,g.dc(23,26,e.car.owner,"name"))," ",g.cc(24,29,g.dc(25,31,e.car.owner,"phoneCode"))," ",g.cc(26,34,g.dc(27,36,e.car.owner,"phone"))," ",e.car.owner," "),g.Ab(8),g.gc("ngIf",e.car.carImages),g.Ab(1),g.gc("ngIf",!e.car.carImages),g.Ab(1),g.gc("ngIf",e.isInEditMode))},directives:[o.l,o.m,I.a,y.a,l.q,l.l,l.g,l.b,l.k,l.e,l.n,o.k],pipes:[o.e,o.b,w.a],styles:[".test[_ngcontent-%COMP%]{\n    position: fixed;\n    top: 50px;\n    left: 0;\n    width: 100%;\n    height: 100vh;\n    background-color: rgba(0, 0, 0, 0.5);\n  }\n\n  img[_ngcontent-%COMP%] {\n    width: 100px;\n  }"]}),q);function J(r,e){1&r&&(g.Rb(0,"div"),g.Mb(1,"app-loading-spinner"),g.Qb())}function X(r,e){1&r&&g.Mb(0,"app-buy-car-item",6),2&r&&g.gc("car",e.$implicit)}function G(r,e){if(1&r&&(g.Rb(0,"div",4),g.uc(1,X,1,1,"app-buy-car-item",5),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.gc("ngForOf",a.audiCars)}}function K(r,e){if(1&r&&(g.Rb(0,"p",7),g.wc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.xc(a.errorMsg)}}var W,z=((W=function(){function r(e){a(this,r),this.firestore=e,this.isLoading=!0,this.errorMsg=null}return n(r,[{key:"ngOnInit",value:function(){var r=this;this.firestore.getSecondHandAudi().subscribe((function(e){r.audiCars=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.isLoading=!1,r.errorMsg=null}),(function(e){r.isLoading=!1,r.errorMsg=e.message}))}}]),r}()).\u0275fac=function(r){return new(r||W)(g.Lb(h.a))},W.\u0275cmp=g.Fb({type:W,selectors:[["app-audi"]],decls:4,vars:3,consts:[[1,"cars-container"],[4,"ngIf"],["class","cars",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"cars"],[3,"car",4,"ngFor","ngForOf"],[3,"car"],[1,"error-msg"]],template:function(r,e){1&r&&(g.Rb(0,"div",0),g.uc(1,J,2,0,"div",1),g.uc(2,G,2,1,"div",2),g.uc(3,K,2,1,"p",3),g.Qb()),2&r&&(g.Ab(1),g.gc("ngIf",e.isLoading),g.Ab(1),g.gc("ngIf",!e.isLoading),g.Ab(1),g.gc("ngIf",e.errorMsg))},directives:[o.l,I.a,o.k,B],encapsulation:2}),W);function Z(r,e){1&r&&(g.Rb(0,"div"),g.Mb(1,"app-loading-spinner"),g.Qb())}function rr(r,e){1&r&&g.Mb(0,"app-buy-car-item",6),2&r&&g.gc("car",e.$implicit)}function er(r,e){if(1&r&&(g.Rb(0,"div",4),g.uc(1,rr,1,1,"app-buy-car-item",5),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.gc("ngForOf",a.bmwCars)}}function ar(r,e){if(1&r&&(g.Rb(0,"p",7),g.wc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.xc(a.errorMsg)}}var tr,nr=((tr=function(){function r(e){a(this,r),this.firestore=e,this.isLoading=!0,this.errorMsg=null}return n(r,[{key:"ngOnInit",value:function(){var r=this;this.firestore.getSecondHandBMW().subscribe((function(e){r.bmwCars=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.isLoading=!1,r.errorMsg=null}),(function(e){r.isLoading=!1,r.errorMsg=e.message}))}}]),r}()).\u0275fac=function(r){return new(r||tr)(g.Lb(h.a))},tr.\u0275cmp=g.Fb({type:tr,selectors:[["app-bmw"]],decls:4,vars:3,consts:[[1,"cars-container"],[4,"ngIf"],["class","cars",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"cars"],[3,"car",4,"ngFor","ngForOf"],[3,"car"],[1,"error-msg"]],template:function(r,e){1&r&&(g.Rb(0,"div",0),g.uc(1,Z,2,0,"div",1),g.uc(2,er,2,1,"div",2),g.uc(3,ar,2,1,"p",3),g.Qb()),2&r&&(g.Ab(1),g.gc("ngIf",e.isLoading),g.Ab(1),g.gc("ngIf",!e.isLoading),g.Ab(1),g.gc("ngIf",e.errorMsg))},directives:[o.l,I.a,o.k,B],encapsulation:2}),tr),cr=c("Wcq6"),ir=c("kmnG"),or=c("FKr1");function sr(r,e){1&r&&g.Mb(0,"app-loading-spinner")}function lr(r,e){if(1&r&&(g.Rb(0,"p",26),g.wc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.xc(a.getCarModelsError)}}function ur(r,e){if(1&r&&(g.Rb(0,"p",26),g.wc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.xc(a.getCarManufactureYearError)}}function gr(r,e){if(1&r&&(g.Rb(0,"mat-option",27),g.wc(1),g.Qb()),2&r){var a=e.$implicit;g.gc("value",a.name),g.Ab(1),g.yc(" ",a.name," ")}}function br(r,e){if(1&r&&(g.Rb(0,"mat-option",27),g.wc(1),g.Qb()),2&r){var a=e.$implicit;g.gc("value",a.year),g.Ab(1),g.yc(" ",a.year," ")}}function mr(r,e){if(1&r&&(g.Rb(0,"div",12),g.Mb(1,"img",13),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.gc("src",a.carDefaultImg,g.pc)}}function dr(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div",30),g.Mb(1,"img",13),g.Rb(2,"div",31),g.Yb("click",(function(){g.oc(a);var r=e.index;return g.ac(2).removeCarImg(r)})),g.wc(3,"X"),g.Qb(),g.Qb()}if(2&r){var t=e.$implicit;g.Ab(1),g.gc("src",t,g.pc)}}function fr(r,e){if(1&r&&(g.Rb(0,"div",28),g.uc(1,dr,4,1,"div",29),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.gc("ngForOf",a.carImgLocalPaths)}}function pr(r,e){if(1&r&&(g.Rb(0,"p",26),g.wc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.xc(a.sellCarError)}}function hr(r,e){if(1&r&&(g.Rb(0,"p",26),g.wc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.xc(a.uploadCarImgToFirestoreError)}}function Ir(r,e){if(1&r&&(g.Rb(0,"p",26),g.wc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.xc(a.uploadCarImagesToFirestoreError)}}function vr(r,e){if(1&r&&(g.Rb(0,"p",26),g.wc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.xc(a.getCarImgURLError)}}function Cr(r,e){if(1&r&&(g.Rb(0,"p",26),g.wc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.xc(a.getcarImgURLsError)}}var Rr,Lr=function(r){return{invalid:r}},yr=((Rr=function(){function r(e,t,n,c,i,o){a(this,r),this.formBuilder=e,this.firestore=t,this.additionUserInfoService=n,this.angularFireStorage=c,this.generateIdService=i,this.router=o,this.carDefaultImg="../../../assets/img/cell-buy-car/upload-img.png",this.carImgLocalPath=this.carDefaultImg,this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.carModels=[],this.carManufactureYears=[],this.getCarModelsError=null,this.getCarManufactureYearError=null,this.sellCarError=null,this.uploadCarImgToFirestoreError=null,this.uploadCarImagesToFirestoreError=null,this.getCarImgURLError=null,this.getcarImgURLsError=null,this.isLoading=!1}return n(r,[{key:"ngOnInit",value:function(){var r=this;this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe((function(e){r.userAdditionalData=e})),this.sellCarForm=this.formBuilder.group({model:new l.d(null,l.p.required),year:new l.d(null,l.p.required),carImg:new l.d(null,l.p.required),description:new l.d(null,l.p.required),price:new l.d(null,l.p.required),carImgs:new l.d(null)}),this.firestore.getSecondHandCarsLink().subscribe((function(e){r.carModels=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.getCarModelsError=null}),(function(e){r.getCarModelsError=e.message})),this.firestore.getCarManufactureYear().subscribe((function(e){r.carManufactureYears=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.getCarManufactureYearError=null}),(function(e){r.getCarManufactureYearError=e.message}))}},{key:"ngOnDestroy",value:function(){this.userAdditionalInfoSub.unsubscribe()}},{key:"onSubmit",value:function(r){var e=this;if(r.valid){this.isLoading=!0;var a=this.generateIdService.generateId();this.onUploadCarImgToFirestore(a).then((function(){e.onUploadCarImagesToFirestore(a).then((function(){var t=r.value.model,n=r.value.year,c=r.value.carImg,i=r.value.description.trim(),o=r.value.price,s=e.userAdditionalData[0].email,l=cr.firestore.Timestamp.now();e.firestore.setSecondHandCar({model:t,year:n,carImg:c,description:i,price:o,owner:s,id:a,date:l,carImages:r.value.carImgs}).then((function(){e.isLoading=!1,e.sellCarForm.reset(),localStorage.setItem("sell-buy-car/buy-LastVisitedLink",JSON.stringify("/sell-buy-car/buy/"+t.toLowerCase())),e.router.navigate(["/sell-buy-car/buy/"+t.toLowerCase()]),e.carImgNames=[],e.carImgLocalPaths=[],e.carImgURLs=[],e.carImgLocalPath=e.carDefaultImg,e.sellCarError=null})).catch((function(r){e.sellCarError=r.message}))}))}))}}},{key:"onChooseCarImg",value:function(r){var e=this;if(this.carFile=r.target.files[0],this.carFile){var a=new FileReader;a.onload=function(r){e.carImgLocalPath=r.target.result},a.readAsDataURL(r.target.files[0])}else this.carImgLocalPath=this.carDefaultImg}},{key:"onUploadCarImgToFirestore",value:function(r){var e=this;return new Promise((function(a){e.angularFireStorage.upload("/carsForSell/"+e.sellCarForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"/"+e.carFile.name,e.carFile).then((function(r){r.ref.getDownloadURL().then((function(r){e.sellCarForm.value.carImg=r,e.getCarImgURLError=null,a()})).catch((function(r){e.getCarImgURLError=r.message})),e.uploadCarImgToFirestoreError=null})).catch((function(r){e.uploadCarImgToFirestoreError=r.message}))}))}},{key:"onChooseCarImgs",value:function(r){var e=this;if(this.carFiles=r.target.files,this.carFiles.length>0)for(var a=0;a<this.carFiles.length;a++){var t=new FileReader;t.onload=function(r){e.carImgLocalPaths.push(r.target.result)},t.readAsDataURL(r.target.files[a]),this.carImgNames.push(this.carFiles[a].name)}else this.carFiles=null,this.carImgLocalPaths=[],this.carImgNames=[]}},{key:"onUploadCarImagesToFirestore",value:function(r){var e=this;return new Promise((function(a){0==e.carImgNames.length&&a();for(var t=0;t<e.carImgNames.length;t++)e.angularFireStorage.upload("/carsForSell/"+e.sellCarForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"//carImages/"+e.generateIdService.generateId()+"-"+e.carImgNames[t],e.carFiles[t]).then((function(r){r.ref.getDownloadURL().then((function(r){e.carImgURLs.push(r),e.carImgURLs.length==e.carImgNames.length&&(e.sellCarForm.value.carImgs=e.carImgURLs,e.getcarImgURLsError=null,a())})).catch((function(r){e.getcarImgURLsError=r.message})),e.uploadCarImagesToFirestoreError=null})).catch((function(r){e.uploadCarImagesToFirestoreError=r.message}))}))}},{key:"removeCarImg",value:function(r){this.carImgLocalPaths.splice(r,1),this.carImgNames.splice(r,1),0==this.carImgLocalPaths&&0==this.carImgNames&&(this.sellCarForm.value.carImgs=null)}}]),r}()).\u0275fac=function(r){return new(r||Rr)(g.Lb(l.c),g.Lb(h.a),g.Lb(C.a),g.Lb(R.a),g.Lb(L.a),g.Lb(s.b))},Rr.\u0275cmp=g.Fb({type:Rr,selectors:[["app-sell-car"]],decls:53,vars:18,consts:[[1,"sell-car-container"],[4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"sell-car-container__form",3,"formGroup","ngSubmit"],[1,"sell-car-container__form__drop-downs"],[1,"sell-car-container__form__drop-downs__el"],[1,"el-label"],[3,"ngClass"],["formControlName","model"],[3,"value",4,"ngFor","ngForOf"],["formControlName","year"],[1,"sell-car-container__form__hr"],[1,"defaut-img"],[3,"src"],["formControlName","carImg","type","file","accept",".png,.jpg,.jpeg,.svg,.heic",2,"display","none",3,"change"],["chooseCarImg",""],["type","button",1,"button","btn-default","narrow-btn","ng-star-inserted",3,"click"],["placeholder","Description...","formControlName","description",1,"textarea"],[1,"price"],["type","number","name","price","formControlName","price",1,""],[1,"sell-car-container__form__car-images"],["class","defaut-img",4,"ngIf"],["class","img-container",4,"ngIf"],["formControlName","carImgs","type","file","accept",".png,.jpg,.jpeg,.svg,.heic","multiple","multiple",2,"display","none",3,"change"],["chooseCarImgs",""],["type","submit",1,"button","btn-default","narrow-btn","ng-star-inserted",3,"disabled"],[1,"error-msg"],[3,"value"],[1,"img-container"],["class","img-element",4,"ngFor","ngForOf"],[1,"img-element"],[3,"click"]],template:function(r,e){if(1&r){var a=g.Sb();g.Rb(0,"div",0),g.uc(1,sr,1,0,"app-loading-spinner",1),g.Rb(2,"div"),g.uc(3,lr,2,1,"p",2),g.uc(4,ur,2,1,"p",2),g.Qb(),g.Rb(5,"form",3),g.Yb("ngSubmit",(function(){return e.onSubmit(e.sellCarForm)})),g.Rb(6,"div",4),g.Rb(7,"div",5),g.Rb(8,"p",6),g.wc(9,"Model"),g.Qb(),g.Rb(10,"div",7),g.Rb(11,"mat-form-field"),g.Rb(12,"mat-select",8),g.uc(13,gr,2,2,"mat-option",9),g.Qb(),g.Qb(),g.Qb(),g.Qb(),g.Rb(14,"div",5),g.Rb(15,"p",6),g.wc(16,"Year"),g.Qb(),g.Rb(17,"mat-form-field"),g.Rb(18,"mat-select",10),g.uc(19,br,2,2,"mat-option",9),g.Qb(),g.Qb(),g.Qb(),g.Qb(),g.Mb(20,"hr",11),g.Rb(21,"div"),g.Rb(22,"div",12),g.Mb(23,"img",13),g.Qb(),g.Rb(24,"input",14,15),g.Yb("change",(function(r){return e.onChooseCarImg(r)})),g.Qb(),g.Rb(26,"button",16),g.Yb("click",(function(){return g.oc(a),g.mc(25).click()})),g.wc(27,"Ch\u043eose Image"),g.Qb(),g.Qb(),g.Mb(28,"hr",11),g.Rb(29,"div"),g.Mb(30,"textarea",17),g.Qb(),g.Rb(31,"div",18),g.Rb(32,"p",6),g.wc(33,"Price in $"),g.Qb(),g.Mb(34,"input",19),g.Qb(),g.Mb(35,"hr",11),g.Rb(36,"div",20),g.uc(37,mr,2,1,"div",21),g.uc(38,fr,2,1,"div",22),g.Rb(39,"button",16),g.Yb("click",(function(){return g.oc(a),g.mc(42).click()})),g.wc(40,"Ch\u043eose Images"),g.Qb(),g.Rb(41,"input",23,24),g.Yb("change",(function(r){return e.onChooseCarImgs(r)})),g.Qb(),g.Qb(),g.Mb(43,"hr",11),g.Rb(44,"div"),g.Rb(45,"button",25),g.wc(46,"Add to the Shop"),g.Qb(),g.Qb(),g.Rb(47,"div"),g.uc(48,pr,2,1,"p",2),g.uc(49,hr,2,1,"p",2),g.uc(50,Ir,2,1,"p",2),g.uc(51,vr,2,1,"p",2),g.uc(52,Cr,2,1,"p",2),g.Qb(),g.Qb(),g.Qb()}2&r&&(g.Ab(1),g.gc("ngIf",e.isLoading),g.Ab(2),g.gc("ngIf",e.getCarModelsError),g.Ab(1),g.gc("ngIf",e.getCarManufactureYearError),g.Ab(1),g.gc("formGroup",e.sellCarForm),g.Ab(5),g.gc("ngClass",g.jc(16,Lr,!e.sellCarForm.get("model").valid&&e.sellCarForm.get("model").touched)),g.Ab(3),g.gc("ngForOf",e.carModels),g.Ab(6),g.gc("ngForOf",e.carManufactureYears),g.Ab(4),g.gc("src",e.carImgLocalPath,g.pc),g.Ab(14),g.gc("ngIf",0==e.carImgLocalPaths.length),g.Ab(1),g.gc("ngIf",e.carImgLocalPaths.length>0),g.Ab(7),g.gc("disabled",!e.sellCarForm.valid),g.Ab(3),g.gc("ngIf",e.sellCarError),g.Ab(1),g.gc("ngIf",e.uploadCarImgToFirestoreError),g.Ab(1),g.gc("ngIf",e.uploadCarImagesToFirestoreError),g.Ab(1),g.gc("ngIf",e.getCarImgURLError),g.Ab(1),g.gc("ngIf",e.getcarImgURLsError))},directives:[o.l,l.q,l.l,l.g,o.j,ir.b,u.a,l.k,l.e,o.k,l.b,l.n,I.a,or.f],encapsulation:2}),Rr),wr=c("XupT");function Fr(r,e){if(1&r&&(g.Rb(0,"p",2),g.wc(1),g.Qb()),2&r){var a=g.ac();g.Ab(1),g.xc(a.getCarLinksErrorMsg)}}var Ar,Qr,Sr=((Ar=function(){function r(e,t,n){a(this,r),this.firestore=e,this.subjectsService=t,this.router=n,this.carLinks=[]}return n(r,[{key:"ngOnInit",value:function(){var r=this;this.isLoadingSub=this.subjectsService.isLoadingSubject.subscribe((function(e){r.isLoading=e})),this.firestore.getSecondHandCarsLink().subscribe((function(e){r.carLinks=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.subjectsService.loaded(),r.getCarLinksErrorMsg=null}),(function(e){r.subjectsService.loaded(),r.getCarLinksErrorMsg=e.message}));var e=JSON.parse(localStorage.getItem("sell-buy-car/buy-LastVisitedLink")),a=JSON.parse(localStorage.getItem("sell-buy-car-LastVisitedLink"));e&&"/sell-buy-car/buy"==a.toString()&&this.router.navigate([e])}},{key:"ngOnDestroy",value:function(){this.isLoadingSub.unsubscribe()}}]),r}()).\u0275fac=function(r){return new(r||Ar)(g.Lb(h.a),g.Lb(v.a),g.Lb(s.b))},Ar.\u0275cmp=g.Fb({type:Ar,selectors:[["app-buy-car"]],decls:3,vars:3,consts:[["class","error-msg",4,"ngIf"],[3,"carLinks","currentLink"],[1,"error-msg"]],template:function(r,e){1&r&&(g.Rb(0,"div"),g.uc(1,Fr,2,1,"p",0),g.Mb(2,"app-categories-router",1),g.Qb()),2&r&&(g.Ab(1),g.gc("ngIf",e.getCarLinksErrorMsg),g.Ab(1),g.gc("carLinks",e.carLinks)("currentLink","sell-buy-car/buy"))},directives:[o.l,wr.a],encapsulation:2}),Ar),kr=c("PCNd"),Er=((Qr=function r(){a(this,r)}).\u0275mod=g.Jb({type:Qr}),Qr.\u0275inj=g.Ib({factory:function(r){return new(r||Qr)},imports:[[o.c,l.o,kr.a,u.b,s.e.forChild([{path:"",component:f,canActivate:[p.a],children:[{path:"buy",component:Sr,children:[{path:"audi",component:z},{path:"bmw",component:nr},{path:"**",redirectTo:"audi"}]},{path:"sell",component:yr},{path:"**",redirectTo:"buy"}]}])]]}),Qr)}}])}();