(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{UyQ7:function(t,e,n){"use strict";n.r(e),n.d(e,"CommentsModule",(function(){return K}));var o=n("ofXK"),r=n("3Pt+"),i=n("tyNb"),b=n("fXoL"),s=n("T/S4"),c=n("IYfF"),m=n("zy28");function a(t,e){1&t&&b.Jb(0,"app-loading-spinner")}function l(t,e){if(1&t&&(b.Lb(0,"div",17),b.Lb(1,"div",9),b.Lb(2,"p",10),b.ec(3),b.Kb(),b.Lb(4,"p",11),b.ec(5),b.Vb(6,"date"),b.Vb(7,"date"),b.Kb(),b.Kb(),b.Lb(8,"div",12),b.Lb(9,"p"),b.ec(10),b.Kb(),b.Kb(),b.Kb()),2&t){const t=e.$implicit;b.yb(3),b.gc(" ",t.name," "),b.yb(2),b.hc(" ",b.Wb(6,4,t.date,"dd.MM.yyyy")," at ",b.Wb(7,7,t.date,"HH:mm")," "),b.yb(5),b.fc(t.comment)}}function d(t,e){if(1&t){const t=b.Mb();b.Lb(0,"button",18),b.Sb("click",(function(){b.ac(t);const e=b.Ub().$implicit;return b.Ub().reply(e.id)})),b.ec(1,"Reply"),b.Kb()}}function u(t,e){if(1&t){const t=b.Mb();b.Lb(0,"button",18),b.Sb("click",(function(){return b.ac(t),b.Ub(2).isReply=null})),b.ec(1,"Colse Reply"),b.Kb()}}function p(t,e){if(1&t){const t=b.Mb();b.Lb(0,"form",19),b.Sb("ngSubmit",(function(){b.ac(t);const e=b.Ub().$implicit,n=b.Ub();return n.onReply(e.name,e.date,e.comment,e.id,n.replyForm)})),b.Lb(1,"div"),b.Jb(2,"textarea",20),b.Kb(),b.Lb(3,"div"),b.Lb(4,"button",21),b.ec(5,"Add your comment"),b.Kb(),b.Kb(),b.Lb(6,"p",22),b.ec(7),b.Kb(),b.Kb()}if(2&t){const t=b.Ub(2);b.Xb("formGroup",t.replyForm),b.yb(4),b.Xb("disabled",!t.replyForm.valid),b.yb(3),b.fc(t.errorMsg)}}function f(t,e){if(1&t&&(b.Lb(0,"div",8),b.Lb(1,"div",9),b.Lb(2,"p",10),b.ec(3),b.Kb(),b.Lb(4,"p",11),b.ec(5),b.Vb(6,"date"),b.Vb(7,"date"),b.Kb(),b.Kb(),b.Lb(8,"div",12),b.Lb(9,"p"),b.ec(10),b.Kb(),b.Lb(11,"div",13),b.dc(12,l,11,10,"div",14),b.Kb(),b.Lb(13,"div"),b.dc(14,d,2,0,"button",15),b.dc(15,u,2,0,"button",15),b.Kb(),b.dc(16,p,8,3,"form",16),b.Kb(),b.Kb()),2&t){const t=e.$implicit,n=b.Ub();b.yb(3),b.gc(" ",t.name," "),b.yb(2),b.hc(" ",b.Wb(6,8,t.date,"dd.MM.yyyy")," at ",b.Wb(7,11,t.date,"HH:mm")," "),b.yb(5),b.fc(t.comment),b.yb(2),b.Xb("ngForOf",t.replies),b.yb(2),b.Xb("ngIf",n.isAuth),b.yb(1),b.Xb("ngIf",n.isReply==t.id),b.yb(1),b.Xb("ngIf",n.isReply==t.id)}}function y(t,e){1&t&&(b.Lb(0,"div",23),b.Lb(1,"p"),b.ec(2,"Please Sign in to add your comment!"),b.Kb(),b.Kb())}function h(t,e){if(1&t){const t=b.Mb();b.Lb(0,"form",24),b.Sb("ngSubmit",(function(){b.ac(t);const e=b.Ub();return e.onSubmit(e.postForm)})),b.Lb(1,"div"),b.Jb(2,"textarea",25),b.Kb(),b.Lb(3,"div"),b.Lb(4,"button",21),b.ec(5,"Add your comment"),b.Kb(),b.Kb(),b.Lb(6,"p",22),b.ec(7),b.Kb(),b.Kb()}if(2&t){const t=b.Ub();b.Xb("formGroup",t.postForm),b.yb(4),b.Xb("disabled",!t.postForm.valid),b.yb(3),b.fc(t.errorMsg)}}let g=(()=>{class t{constructor(t,e,n){this.firestore=t,this.formBuilder=e,this.authService=n,this.isAuth=!1,this.isLoading=!1,this.errorMsg=null,this.isReply=null}ngOnInit(){this.subUser=this.authService.user.subscribe(t=>{this.isAuth=!!t}),this.isLoading=!0,this.firestore.getComments().subscribe(t=>{this.comments=t.map(t=>Object.assign({id:t.payload.doc.id},t.payload.doc.data())),this.isLoading=!1,this.errorMsg=null},t=>{this.isLoading=!1,this.errorMsg=t}),this.postForm=this.formBuilder.group({commentArea:new r.c(null,r.k.required)}),this.replyForm=this.formBuilder.group({replyArea:new r.c(null,r.k.required)})}ngOnDestroy(){this.subUser.unsubscribe()}onSubmit(t){if(!this.postForm.valid)return;const e=JSON.parse(localStorage.getItem("userAdditionalData"));if(!e)return;const n=e[0].name,o=(new Date).toLocaleString();this.firestore.createComment({name:n,date:o,comment:t.value.commentArea}).then(()=>{this.postForm.reset(),this.errorMsg=null}).catch(t=>{this.errorMsg=t})}reply(t){this.isReply=t}onReply(t,e,n,o,r){if(!this.replyForm.valid)return;const i=JSON.parse(localStorage.getItem("userAdditionalData"));if(!i)return;const b={name:t,date:e,comment:n,replies:[{name:i[0].name,date:(new Date).toLocaleString(),comment:r.value.replyArea}],id:o};this.firestore.updateComment(b).then(()=>{this.isReply=null,this.replyForm.reset(),this.errorMsg=null}).catch(t=>{this.errorMsg=t})}}return t.\u0275fac=function(e){return new(e||t)(b.Ib(s.a),b.Ib(r.b),b.Ib(c.a))},t.\u0275cmp=b.Cb({type:t,selectors:[["app-comments"]],decls:10,vars:4,consts:[[1,"container"],[1,"comments-container",2,"position","relative"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[1,"comment-header"],[1,"comment-name"],[1,"comment-date"],[1,"comment-content"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],["class","btn-default reply-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"reply"],[1,"btn-default","reply-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],[1,"error-msg"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(t,e){1&t&&(b.Lb(0,"div",0),b.Lb(1,"div",1),b.dc(2,a,1,0,"app-loading-spinner",2),b.Lb(3,"p",3),b.ec(4,"Comments"),b.Kb(),b.Lb(5,"div"),b.dc(6,f,17,14,"div",4),b.Jb(7,"hr",5),b.dc(8,y,3,0,"div",6),b.dc(9,h,8,3,"form",7),b.Kb(),b.Kb(),b.Kb()),2&t&&(b.yb(2),b.Xb("ngIf",e.isLoading),b.yb(4),b.Xb("ngForOf",e.comments),b.yb(2),b.Xb("ngIf",!e.isAuth),b.yb(1),b.Xb("ngIf",e.isAuth))},directives:[o.j,o.i,m.a,r.l,r.h,r.f,r.a,r.g,r.d],pipes:[o.d],encapsulation:2}),t})();var L=n("PCNd");let K=(()=>{class t{}return t.\u0275mod=b.Gb({type:t}),t.\u0275inj=b.Fb({factory:function(e){return new(e||t)},imports:[[o.b,L.a,r.j,i.f.forChild([{path:"",component:g}])]]}),t})()}}]);