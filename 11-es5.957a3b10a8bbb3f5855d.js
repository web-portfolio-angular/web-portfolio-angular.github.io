!function(){function r(r){return function(r){if(Array.isArray(r))return e(r)}(r)||function(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}(r)||function(r,a){if(!r)return;if("string"==typeof r)return e(r,a);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(r);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(r,a)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(r,e){(null==e||e>r.length)&&(e=r.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=r[a];return n}function a(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function n(r,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function c(r,e,a){return e&&n(r.prototype,e),a&&n(r,a),r}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{F15C:function(e,n,t){"use strict";t.r(n),t.d(n,"SellBuyCarModule",(function(){return xr}));var i,o=t("ofXK"),s=t("tyNb"),l=t("3Pt+"),g=t("d3UM"),u=t("fXoL"),b=t("1XCa"),m=function(){return["buy"]},d=function(){return["sell"]},f=((i=function(){function r(e){a(this,r),this.router=e}return c(r,[{key:"ngOnInit",value:function(){}}]),r}()).\u0275fac=function(r){return new(r||i)(u.Lb(s.b))},i.\u0275cmp=u.Fb({type:i,selectors:[["app-sell-buy-car"]],decls:9,vars:4,consts:[[1,"container"],[1,"sell-buy-car"],[1,"sell-buy-car__router-links"],["routerLinkActive","categories-active",3,"routerLink"]],template:function(r,e){1&r&&(u.Rb(0,"div",0),u.Mb(1,"app-categories-info"),u.Rb(2,"div",1),u.Rb(3,"ul",2),u.Rb(4,"li",3),u.xc(5,"Buy Second Hand Car"),u.Qb(),u.Rb(6,"li",3),u.xc(7," Sell Your Car"),u.Qb(),u.Qb(),u.Mb(8,"router-outlet"),u.Qb(),u.Qb()),2&r&&(u.Ab(4),u.gc("routerLink",u.jc(2,m)),u.Ab(2),u.gc("routerLink",u.jc(3,d)))},directives:[b.a,s.d,s.c,s.f],encapsulation:2}),i),p=t("2CTM"),h=t("T/S4"),v=t("zy28"),I=t("rL3l"),C=t("V86y"),R=t("Vaw3"),y=t("B02C"),F=t("fk3A"),L=t("odcQ");function Q(r,e){1&r&&u.Mb(0,"app-loading-spinner")}function A(r,e){if(1&r){var a=u.Sb();u.Rb(0,"div"),u.Rb(1,"button",16),u.Yb("click",(function(){return u.pc(a),u.ac().onEdit()})),u.xc(2,"Edit Car"),u.Qb(),u.Qb()}}function S(r,e){if(1&r&&u.Mb(0,"app-car-images",20),2&r){var a=u.ac(2);u.gc("carImgs",a.car.carImages)}}function w(r,e){if(1&r){var a=u.Sb();u.Rb(0,"div",17),u.Rb(1,"button",18),u.Yb("click",(function(){u.pc(a);var r=u.ac();return r.onShowCarImages(r.car.id)})),u.xc(2,"View Images"),u.Qb(),u.vc(3,S,1,1,"app-car-images",19),u.Qb()}if(2&r){var n=u.ac();u.Ab(3),u.gc("ngIf",n.carShowImages&&n.carId==n.car.id)}}function E(r,e){1&r&&(u.Rb(0,"p",21),u.xc(1,"No images uploaded"),u.Qb())}function k(r,e){1&r&&(u.Rb(0,"div"),u.Rb(1,"p",43),u.xc(2,"There are no images uploaded"),u.Qb(),u.Qb())}function M(r,e){if(1&r){var a=u.Sb();u.Rb(0,"div",47),u.Mb(1,"img",28),u.Rb(2,"div",48),u.Yb("click",(function(){u.pc(a);var r=e.index,n=e.$implicit;return u.ac(3).deleteCurrentImages(r,n)})),u.xc(3,"X"),u.Qb(),u.Qb()}if(2&r){var n=e.$implicit;u.Ab(1),u.gc("src",n,u.qc)}}function x(r,e){if(1&r&&(u.Rb(0,"div",44),u.Rb(1,"p",30),u.xc(2,"Current Images"),u.Qb(),u.Rb(3,"div",45),u.vc(4,M,4,1,"div",46),u.Qb(),u.Qb()),2&r){var a=u.ac(2);u.Ab(4),u.gc("ngForOf",a.currentCarImages)}}function _(r,e){if(1&r){var a=u.Sb();u.Rb(0,"div",47),u.Mb(1,"img",28),u.Rb(2,"div",48),u.Yb("click",(function(){u.pc(a);var r=e.index;return u.ac(3).removeCarImg(r)})),u.xc(3,"X"),u.Qb(),u.Qb()}if(2&r){var n=e.$implicit;u.Ab(1),u.gc("src",n,u.qc)}}function U(r,e){if(1&r&&(u.Rb(0,"div",44),u.Rb(1,"p",30),u.xc(2,"New Images"),u.Qb(),u.Rb(3,"div",45),u.vc(4,_,4,1,"div",46),u.Qb(),u.Qb()),2&r){var a=u.ac(2);u.Ab(4),u.gc("ngForOf",a.carImgLocalPaths)}}function D(r,e){if(1&r&&(u.Rb(0,"p",49),u.xc(1),u.Qb()),2&r){var a=u.ac(2);u.Ab(1),u.yc(a.uploadCarImagesToFirestoreError)}}function T(r,e){if(1&r&&(u.Rb(0,"p",49),u.xc(1),u.Qb()),2&r){var a=u.ac(2);u.Ab(1),u.yc(a.updateSecondHandCarError)}}function O(r,e){if(1&r&&(u.Rb(0,"p",49),u.xc(1),u.Qb()),2&r){var a=u.ac(2);u.Ab(1),u.yc(a.setcarImgURLsError)}}function j(r,e){if(1&r&&(u.Rb(0,"p",49),u.xc(1),u.Qb()),2&r){var a=u.ac(2);u.Ab(1),u.yc(a.deleteOldImgError)}}function N(r,e){if(1&r&&(u.Rb(0,"p",49),u.xc(1),u.Qb()),2&r){var a=u.ac(2);u.Ab(1),u.yc(a.getCarImgURLError)}}function P(r,e){if(1&r&&(u.Rb(0,"p",49),u.xc(1),u.Qb()),2&r){var a=u.ac(2);u.Ab(1),u.yc(a.uploadCarImgToFirestoreError)}}function Y(r,e){if(1&r){var a=u.Sb();u.Rb(0,"div",22),u.Rb(1,"form",23),u.Yb("ngSubmit",(function(){u.pc(a);var r=u.ac();return r.submitCarDetailChanges(r.changeCarDetailsForm)})),u.Rb(2,"div",24),u.Rb(3,"input",25,26),u.Yb("change",(function(r){return u.pc(a),u.ac().onChooseCarImg(r)})),u.Qb(),u.Rb(5,"div",27),u.Mb(6,"img",28),u.Qb(),u.Rb(7,"button",16),u.Yb("click",(function(){return u.pc(a),u.nc(4).click()})),u.xc(8,"Change Car Image"),u.Qb(),u.Qb(),u.Mb(9,"hr",4),u.Rb(10,"div",29),u.Rb(11,"p",30),u.xc(12,"Description"),u.Qb(),u.Mb(13,"textarea",31),u.Qb(),u.Rb(14,"div",32),u.Rb(15,"p",30),u.xc(16,"Price"),u.Qb(),u.Mb(17,"input",33),u.Qb(),u.Mb(18,"hr",4),u.Rb(19,"div",34),u.Rb(20,"div"),u.vc(21,k,3,0,"div",1),u.vc(22,x,5,1,"div",35),u.vc(23,U,5,1,"div",35),u.Qb(),u.Rb(24,"div",36),u.Rb(25,"input",37,38),u.Yb("change",(function(r){return u.pc(a),u.ac().onChooseCarImgs(r)})),u.Qb(),u.Rb(27,"button",39),u.Yb("click",(function(){return u.pc(a),u.nc(26).click()})),u.xc(28," Select Images "),u.Qb(),u.Qb(),u.Qb(),u.Mb(29,"hr",4),u.Rb(30,"div",40),u.Rb(31,"button",41),u.xc(32,"Apply Changes"),u.Qb(),u.Rb(33,"button",16),u.Yb("click",(function(){return u.pc(a),u.ac().onCancel()})),u.xc(34,"Cancel"),u.Qb(),u.Qb(),u.Rb(35,"div"),u.vc(36,D,2,1,"p",42),u.vc(37,T,2,1,"p",42),u.vc(38,O,2,1,"p",42),u.vc(39,j,2,1,"p",42),u.vc(40,N,2,1,"p",42),u.vc(41,P,2,1,"p",42),u.Qb(),u.Qb(),u.Qb()}if(2&r){var n=u.ac();u.Ab(1),u.gc("formGroup",n.changeCarDetailsForm),u.Ab(5),u.gc("src",n.carImgLocalPath,u.qc),u.Ab(15),u.gc("ngIf",!n.car.carImages||0==n.currentCarImages.length),u.Ab(1),u.gc("ngIf",n.currentCarImages.length>0),u.Ab(1),u.gc("ngIf",n.carImgLocalPaths.length>0),u.Ab(13),u.gc("ngIf",n.uploadCarImagesToFirestoreError),u.Ab(1),u.gc("ngIf",n.updateSecondHandCarError),u.Ab(1),u.gc("ngIf",n.setcarImgURLsError),u.Ab(1),u.gc("ngIf",n.deleteOldImgError),u.Ab(1),u.gc("ngIf",n.getCarImgURLError),u.Ab(1),u.gc("ngIf",n.uploadCarImgToFirestoreError)}}var q,H=function(r){return{"background-image":r}},V=((q=function(){function e(r,n,c,t,i,o){a(this,e),this.subjectService=r,this.formBuilder=n,this.firestore=c,this.additionUserInfoService=t,this.angularFireStorage=i,this.generateIdService=o,this.isInEditMode=!1,this.ownerEmail=null,this.carFiles=[],this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.currentCarImages=[],this.uploadCarImagesToFirestoreError=null,this.updateSecondHandCarError=null,this.setcarImgURLsError=null,this.isLoading=!1,this.deleteOldImgError=null,this.getCarImgURLError=null,this.uploadCarImgToFirestoreError=null,this.currentImageForDelete=[]}return c(e,[{key:"ngOnInit",value:function(){var e=this;this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe((function(r){e.userAdditionalData=r,e.ownerEmail=e.userAdditionalData[0].email})),this.carShowImagesSub=this.subjectService.carShowImagesSubject.subscribe((function(r){e.carShowImages=r})),this.carIdSub=this.subjectService.carIdSubject.subscribe((function(r){e.carId=r})),this.changeCarDetailsForm=this.formBuilder.group({carImg:new l.d(null),model:new l.d(null),description:new l.d(null,l.p.required),price:new l.d(null,l.p.required),carImgs:new l.d(null)}),this.currentCarImages=r(this.car.carImages),this.carImgLocalPath=this.car.carImg}},{key:"ngOnDestroy",value:function(){this.carShowImagesSub.unsubscribe(),this.carIdSub.unsubscribe(),this.userAdditionalInfoSub.unsubscribe()}},{key:"onShowCarImages",value:function(r){this.subjectService.onShowCarImages(r)}},{key:"submitCarDetailChanges",value:function(r){var e=this;if(r.valid){this.isLoading=!0;var a=this.car.id,n=this.car.carImg,c=this.car.model;this.onUploadCarImageToFirestore(a).then((function(){if(r.value.carImg&&(n=r.value.carImg),e.currentImageForDelete.length>0){for(var t=0;t<e.currentImageForDelete.length;t++)e.firestore.delete(e.currentImageForDelete[t]);e.firestore.setSecondHanCurrentImages({doc:c,id:a,currentImgs:e.currentCarImages})}e.onUploadCarImagesToFirestore(a).then((function(){if(e.carImgNames.length>0)for(var t=0;t<e.carImgNames.length;t++)e.firestore.updateSecondHanImagesCar({doc:c,id:a,img:r.value.carImgs[t]});e.firestore.updateSecondHandCar({carImg:n,description:r.value.description,price:r.value.price,id:a,doc:c}).then((function(){e.isLoading=!1,e.updateSecondHandCarError=null,e.onCancel()}),(function(r){e.updateSecondHandCarError=r.message}))}))}))}}},{key:"onChooseCarImg",value:function(r){var e=this;if(this.carFile=r.target.files[0],this.carFile){var a=new FileReader;a.onload=function(r){e.carImgLocalPath=r.target.result},a.readAsDataURL(r.target.files[0])}else this.carImgLocalPath=this.car.carImg}},{key:"onUploadCarImageToFirestore",value:function(r){var e=this;return new Promise((function(a){e.carFile||a(),e.angularFireStorage.upload("/carsForSell/"+e.changeCarDetailsForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"/"+e.carFile.name,e.carFile).then((function(r){r.ref.getDownloadURL().then((function(r){e.changeCarDetailsForm.value.carImg=r,e.firestore.delete(e.car.carImg).then((function(){e.deleteOldImgError=null})).catch((function(r){e.deleteOldImgError=r.message})),e.getCarImgURLError=null,a()})).catch((function(r){e.getCarImgURLError=r.message})),e.uploadCarImgToFirestoreError=null})).catch((function(r){e.uploadCarImgToFirestoreError=r.message}))}))}},{key:"onChooseCarImgs",value:function(r){for(var e=this,a=0;a<r.target.files.length;a++){this.carFiles.push(r.target.files[a]);var n=new FileReader;n.onload=function(r){e.carImgLocalPaths.push(r.target.result)},n.readAsDataURL(r.target.files[a]),this.carImgNames.push(this.carFiles[a].name)}}},{key:"onUploadCarImagesToFirestore",value:function(r){var e=this;return new Promise((function(a){0==e.carImgNames.length&&a();for(var n=0;n<e.carImgNames.length;n++)e.angularFireStorage.upload("/carsForSell/"+e.changeCarDetailsForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"//carImages/"+e.generateIdService.generateId()+"-"+e.carImgNames[n],e.carFiles[n]).then((function(r){r.ref.getDownloadURL().then((function(r){e.carImgURLs.push(r),e.carImgURLs.length==e.carImgNames.length&&(e.changeCarDetailsForm.value.carImgs=e.carImgURLs,e.setcarImgURLsError=null,a())})).catch((function(r){e.setcarImgURLsError=r.message})),e.uploadCarImagesToFirestoreError=null})).catch((function(r){e.uploadCarImagesToFirestoreError=r.message}))}))}},{key:"onEdit",value:function(){this.changeCarDetailsForm.controls.description.setValue(this.car.description),this.changeCarDetailsForm.controls.price.setValue(this.car.price),this.changeCarDetailsForm.controls.model.setValue(this.car.model),this.isInEditMode=!0}},{key:"removeCarImg",value:function(r){this.carImgLocalPaths.splice(r,1),this.carImgNames.splice(r,1),this.carFiles.splice(r,1),0==this.carFiles&&(this.changeCarDetailsForm.value.carImgs=null)}},{key:"onCancel",value:function(){this.carFiles=[],this.carImgLocalPaths=[],this.carImgNames=[],this.changeCarDetailsForm.controls.carImgs.setValue(""),this.changeCarDetailsForm.controls.carImg.setValue(""),this.carImgLocalPath=this.car.carImg,this.currentCarImages=r(this.car.carImages),this.currentImageForDelete=[],this.isInEditMode=!1}},{key:"deleteCurrentImages",value:function(r,e){this.currentCarImages.splice(r,1),this.currentImageForDelete.push(e)}}]),e}()).\u0275fac=function(r){return new(r||q)(u.Lb(I.a),u.Lb(l.c),u.Lb(h.a),u.Lb(C.a),u.Lb(R.a),u.Lb(y.a))},q.\u0275cmp=u.Fb({type:q,selectors:[["app-buy-car-item"]],inputs:{car:"car"},decls:58,vars:56,consts:[[1,"car-buy-item","car-item"],[4,"ngIf"],[1,"car-buy-item__car-img",3,"ngStyle"],[1,"car-buy-item__model"],[1,"car-item__hr"],[1,"car-buy-item__description"],[1,"car-item__prise"],[1,"add-to-cart"],[1,"car-buy-item__owner-info"],[1,"owner"],[1,"owner-avatar",3,"ngStyle"],[1,"owner-info"],[3,"href"],["class","car-item__images",4,"ngIf"],["class","no-car-images",4,"ngIf"],["class","edit-container",4,"ngIf"],["type","button",1,"btn-default","narrow-btn",3,"click"],[1,"car-item__images"],[1,"btn-default","narrow-btn",3,"click"],[3,"carImgs",4,"ngIf"],[3,"carImgs"],[1,"no-car-images"],[1,"edit-container"],[1,"edit-container__form",3,"formGroup","ngSubmit"],[1,"edit-container__form__car-img"],["formControlName","carImg","type","file","accept",".png,.jpg,.jpeg,.svg,.heic",2,"display","none",3,"change"],["chooseCarImg",""],[1,"car-img-container"],[3,"src"],[1,"edit-container__form__text-area"],[1,"label-el"],["formControlName","description"],[1,"edit-container__form__price"],["type","number","name","price","formControlName","price"],[1,"edit-container__form__car-images"],["class","images-container",4,"ngIf"],[1,"select-images"],["formControlName","carImgs","type","file","accept",".png,.jpg,.jpeg,.svg,.heic","multiple","multiple",2,"display","none",3,"change"],["chooseCarImgs",""],["type","button",1,"btn-default","narrow-btn","ng-star-inserted",3,"click"],[1,"edit-container__form__buttons"],["type","submit",1,"btn-default","narrow-btn","submit"],["class","error-msg",4,"ngIf"],[1,"label-el","no-images"],[1,"images-container"],[1,"images"],["class","img-element",4,"ngFor","ngForOf"],[1,"img-element"],[3,"click"],[1,"error-msg"]],template:function(r,e){1&r&&(u.Rb(0,"div",0),u.vc(1,Q,1,0,"app-loading-spinner",1),u.Mb(2,"div",2),u.Rb(3,"div",3),u.Rb(4,"p"),u.xc(5),u.Qb(),u.Rb(6,"p"),u.xc(7),u.Qb(),u.Qb(),u.Mb(8,"hr",4),u.Rb(9,"div",5),u.Rb(10,"p"),u.xc(11),u.Qb(),u.Qb(),u.Mb(12,"hr",4),u.Rb(13,"div",6),u.Rb(14,"div"),u.Rb(15,"p"),u.xc(16),u.Qb(),u.Qb(),u.Rb(17,"div",7),u.Rb(18,"p"),u.xc(19,"Add to Cart"),u.Qb(),u.Qb(),u.Qb(),u.Mb(20,"hr",4),u.Rb(21,"div",8),u.Rb(22,"div",9),u.Rb(23,"p"),u.xc(24,"Owner"),u.Qb(),u.vc(25,A,3,0,"div",1),u.Qb(),u.Mb(26,"div",10),u.bc(27,"async"),u.bc(28,"getUserInfo"),u.Rb(29,"div",11),u.Rb(30,"p"),u.xc(31),u.bc(32,"async"),u.bc(33,"getUserInfo"),u.Qb(),u.Rb(34,"p"),u.xc(35," Phone: "),u.Rb(36,"a",12),u.bc(37,"async"),u.bc(38,"getUserInfo"),u.bc(39,"async"),u.bc(40,"getUserInfo"),u.xc(41),u.bc(42,"async"),u.bc(43,"getUserInfo"),u.bc(44,"async"),u.bc(45,"getUserInfo"),u.Qb(),u.Qb(),u.Rb(46,"p"),u.xc(47,"Email: "),u.Rb(48,"a",12),u.xc(49),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Rb(50,"div"),u.Rb(51,"p"),u.xc(52),u.bc(53,"date"),u.Qb(),u.Qb(),u.Rb(54,"div"),u.vc(55,w,4,1,"div",13),u.vc(56,E,2,0,"p",14),u.Qb(),u.vc(57,Y,42,11,"div",15),u.Qb()),2&r&&(u.Ab(1),u.gc("ngIf",e.isLoading),u.Ab(1),u.gc("ngStyle",u.kc(52,H,"url('"+(null==e.car?null:e.car.carImg)+"')")),u.Ab(3),u.yc(e.car.model),u.Ab(2),u.yc(e.car.year),u.Ab(4),u.yc(e.car.description),u.Ab(5),u.zc("$ ",e.car.price,""),u.Ab(9),u.gc("ngIf",e.ownerEmail==e.car.owner),u.Ab(1),u.gc("ngStyle",u.kc(54,H,u.cc(27,19,u.dc(28,21,e.car.owner,"userImg")))),u.Ab(5),u.zc("Name: ",u.cc(32,24,u.dc(33,26,e.car.owner,"name")),""),u.Ab(5),u.ic("href","tel:\n              ",u.cc(37,29,u.dc(38,31,e.car.owner,"phoneCode")),"\n              ",u.cc(39,34,u.dc(40,36,e.car.owner,"phone")),"",u.qc),u.Ab(5),u.Ac(" +",u.cc(42,39,u.dc(43,41,e.car.owner,"phoneCode"))," ",u.cc(44,44,u.dc(45,46,e.car.owner,"phone"))," "),u.Ab(7),u.hc("href","mailto:",e.car.owner,"",u.qc),u.Ab(1),u.yc(e.car.owner),u.Ab(3),u.zc("Created: ",u.dc(53,49,e.car.date.toDate(),"dd.MM.yyyy"),""),u.Ab(3),u.gc("ngIf",e.car.carImages.length>0),u.Ab(1),u.gc("ngIf",0==e.car.carImages.length),u.Ab(1),u.gc("ngIf",e.isInEditMode))},directives:[o.l,o.m,v.a,F.a,l.q,l.l,l.g,l.b,l.k,l.e,l.n,o.k],pipes:[o.b,L.a,o.e],encapsulation:2}),q);function $(r,e){1&r&&(u.Rb(0,"div"),u.Mb(1,"app-loading-spinner"),u.Qb())}function B(r,e){1&r&&u.Mb(0,"app-buy-car-item",6),2&r&&u.gc("car",e.$implicit)}function X(r,e){if(1&r&&(u.Rb(0,"div",4),u.vc(1,B,1,1,"app-buy-car-item",5),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.gc("ngForOf",a.audiCars)}}function z(r,e){if(1&r&&(u.Rb(0,"p",7),u.xc(1),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.yc(a.errorMsg)}}var G,J=((G=function(){function r(e){a(this,r),this.firestore=e,this.isLoading=!0,this.errorMsg=null}return c(r,[{key:"ngOnInit",value:function(){var r=this;this.firestore.getSecondHandAudi().subscribe((function(e){r.audiCars=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.isLoading=!1,r.errorMsg=null}),(function(e){r.isLoading=!1,r.errorMsg=e.message}))}}]),r}()).\u0275fac=function(r){return new(r||G)(u.Lb(h.a))},G.\u0275cmp=u.Fb({type:G,selectors:[["app-audi"]],decls:4,vars:3,consts:[[1,"cars-container"],[4,"ngIf"],["class","cars",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"cars"],[3,"car",4,"ngFor","ngForOf"],[3,"car"],[1,"error-msg"]],template:function(r,e){1&r&&(u.Rb(0,"div",0),u.vc(1,$,2,0,"div",1),u.vc(2,X,2,1,"div",2),u.vc(3,z,2,1,"p",3),u.Qb()),2&r&&(u.Ab(1),u.gc("ngIf",e.isLoading),u.Ab(1),u.gc("ngIf",!e.isLoading),u.Ab(1),u.gc("ngIf",e.errorMsg))},directives:[o.l,v.a,o.k,V],encapsulation:2}),G);function K(r,e){1&r&&(u.Rb(0,"div"),u.Mb(1,"app-loading-spinner"),u.Qb())}function W(r,e){1&r&&u.Mb(0,"app-buy-car-item",6),2&r&&u.gc("car",e.$implicit)}function Z(r,e){if(1&r&&(u.Rb(0,"div",4),u.vc(1,W,1,1,"app-buy-car-item",5),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.gc("ngForOf",a.bmwCars)}}function rr(r,e){if(1&r&&(u.Rb(0,"p",7),u.xc(1),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.yc(a.errorMsg)}}var er,ar=((er=function(){function r(e){a(this,r),this.firestore=e,this.isLoading=!0,this.errorMsg=null}return c(r,[{key:"ngOnInit",value:function(){var r=this;this.firestore.getSecondHandBMW().subscribe((function(e){r.bmwCars=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.isLoading=!1,r.errorMsg=null}),(function(e){r.isLoading=!1,r.errorMsg=e.message}))}}]),r}()).\u0275fac=function(r){return new(r||er)(u.Lb(h.a))},er.\u0275cmp=u.Fb({type:er,selectors:[["app-bmw"]],decls:4,vars:3,consts:[[1,"cars-container"],[4,"ngIf"],["class","cars",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"cars"],[3,"car",4,"ngFor","ngForOf"],[3,"car"],[1,"error-msg"]],template:function(r,e){1&r&&(u.Rb(0,"div",0),u.vc(1,K,2,0,"div",1),u.vc(2,Z,2,1,"div",2),u.vc(3,rr,2,1,"p",3),u.Qb()),2&r&&(u.Ab(1),u.gc("ngIf",e.isLoading),u.Ab(1),u.gc("ngIf",!e.isLoading),u.Ab(1),u.gc("ngIf",e.errorMsg))},directives:[o.l,v.a,o.k,V],encapsulation:2}),er),nr=t("Wcq6"),cr=t("kmnG"),tr=t("FKr1");function ir(r,e){1&r&&u.Mb(0,"app-loading-spinner")}function or(r,e){if(1&r&&(u.Rb(0,"p",28),u.xc(1),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.yc(a.getCarModelsError)}}function sr(r,e){if(1&r&&(u.Rb(0,"p",28),u.xc(1),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.yc(a.getCarManufactureYearError)}}function lr(r,e){if(1&r&&(u.Rb(0,"mat-option",29),u.xc(1),u.Qb()),2&r){var a=e.$implicit;u.gc("value",a.name),u.Ab(1),u.zc(" ",a.name," ")}}function gr(r,e){1&r&&(u.Rb(0,"p",30),u.xc(1," The field is required! "),u.Qb())}function ur(r,e){if(1&r&&(u.Rb(0,"mat-option",29),u.xc(1),u.Qb()),2&r){var a=e.$implicit;u.gc("value",a.year),u.Ab(1),u.zc(" ",a.year," ")}}function br(r,e){1&r&&(u.Rb(0,"p",30),u.xc(1," The field is required! "),u.Qb())}function mr(r,e){1&r&&(u.Rb(0,"p",30),u.xc(1," The field is required! "),u.Qb())}function dr(r,e){1&r&&(u.Rb(0,"p",30),u.xc(1," Please enter information about the condition of your car! "),u.Qb())}function fr(r,e){if(1&r&&(u.Rb(0,"div",15),u.Mb(1,"img",16),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.gc("src",a.carDefaultImg,u.qc)}}function pr(r,e){if(1&r){var a=u.Sb();u.Rb(0,"div",33),u.Mb(1,"img",16),u.Rb(2,"div",34),u.Yb("click",(function(){u.pc(a);var r=e.index;return u.ac(2).removeCarImg(r)})),u.xc(3,"X"),u.Qb(),u.Qb()}if(2&r){var n=e.$implicit;u.Ab(1),u.gc("src",n,u.qc)}}function hr(r,e){if(1&r&&(u.Rb(0,"div",31),u.vc(1,pr,4,1,"div",32),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.gc("ngForOf",a.carImgLocalPaths)}}function vr(r,e){if(1&r&&(u.Rb(0,"p",28),u.xc(1),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.yc(a.sellCarError)}}function Ir(r,e){if(1&r&&(u.Rb(0,"p",28),u.xc(1),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.yc(a.uploadCarImgToFirestoreError)}}function Cr(r,e){if(1&r&&(u.Rb(0,"p",28),u.xc(1),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.yc(a.uploadCarImagesToFirestoreError)}}function Rr(r,e){if(1&r&&(u.Rb(0,"p",28),u.xc(1),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.yc(a.getCarImgURLError)}}function yr(r,e){if(1&r&&(u.Rb(0,"p",28),u.xc(1),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.yc(a.getcarImgURLsError)}}var Fr,Lr=function(r){return{"invalid no-border":r}},Qr=((Fr=function(){function r(e,n,c,t,i,o){a(this,r),this.formBuilder=e,this.firestore=n,this.additionUserInfoService=c,this.angularFireStorage=t,this.generateIdService=i,this.router=o,this.carDefaultImg="../../../assets/img/cell-buy-car/upload-img.png",this.carImgLocalPath=this.carDefaultImg,this.carFiles=[],this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.carModels=[],this.carManufactureYears=[],this.getCarModelsError=null,this.getCarManufactureYearError=null,this.sellCarError=null,this.uploadCarImgToFirestoreError=null,this.uploadCarImagesToFirestoreError=null,this.getCarImgURLError=null,this.getcarImgURLsError=null,this.isLoading=!1}return c(r,[{key:"ngOnInit",value:function(){var r=this;this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe((function(e){r.userAdditionalData=e})),this.sellCarForm=this.formBuilder.group({model:new l.d(null,l.p.required),year:new l.d(null,l.p.required),carImg:new l.d(null,l.p.required),description:new l.d(null,l.p.required),price:new l.d(null,l.p.required),carImgs:new l.d(null)}),this.firestore.getSecondHandCarsLink().subscribe((function(e){r.carModels=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.getCarModelsError=null}),(function(e){r.getCarModelsError=e.message})),this.firestore.getCarManufactureYear().subscribe((function(e){r.carManufactureYears=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.getCarManufactureYearError=null}),(function(e){r.getCarManufactureYearError=e.message}))}},{key:"ngOnDestroy",value:function(){this.userAdditionalInfoSub.unsubscribe()}},{key:"onSubmit",value:function(r){var e=this;if(r.valid){this.isLoading=!0;var a=this.generateIdService.generateId();this.onUploadCarImgToFirestore(a).then((function(){e.onUploadCarImagesToFirestore(a).then((function(){var n=r.value.model,c=r.value.year,t=r.value.carImg,i=r.value.description.trim(),o=r.value.price,s=e.userAdditionalData[0].email,l=nr.firestore.Timestamp.now();e.firestore.setSecondHandCar({model:n,year:c,carImg:t,description:i,price:o,owner:s,id:a,date:l,carImages:r.value.carImgs}).then((function(){e.isLoading=!1,e.sellCarForm.reset(),localStorage.setItem("sell-buy-car/buy-LastVisitedLink",JSON.stringify("/sell-buy-car/buy/"+n.toLowerCase())),e.router.navigate(["/sell-buy-car/buy/"+n.toLowerCase()]),e.carImgNames=[],e.carImgLocalPaths=[],e.carImgURLs=[],e.carImgLocalPath=e.carDefaultImg,e.sellCarError=null})).catch((function(r){e.sellCarError=r.message}))}))}))}}},{key:"onChooseCarImg",value:function(r){var e=this;if(this.carFile=r.target.files[0],this.carFile){var a=new FileReader;a.onload=function(r){e.carImgLocalPath=r.target.result},a.readAsDataURL(r.target.files[0])}else this.carImgLocalPath=this.carDefaultImg}},{key:"onUploadCarImgToFirestore",value:function(r){var e=this;return new Promise((function(a){e.angularFireStorage.upload("/carsForSell/"+e.sellCarForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"/"+e.carFile.name,e.carFile).then((function(r){r.ref.getDownloadURL().then((function(r){e.sellCarForm.value.carImg=r,e.getCarImgURLError=null,a()})).catch((function(r){e.getCarImgURLError=r.message})),e.uploadCarImgToFirestoreError=null})).catch((function(r){e.uploadCarImgToFirestoreError=r.message}))}))}},{key:"onChooseCarImgs",value:function(r){for(var e=this,a=0;a<r.target.files.length;a++){this.carFiles.push(r.target.files[a]);var n=new FileReader;n.onload=function(r){e.carImgLocalPaths.push(r.target.result)},n.readAsDataURL(r.target.files[a]),this.carImgNames.push(this.carFiles[a].name)}}},{key:"onUploadCarImagesToFirestore",value:function(r){var e=this;return new Promise((function(a){0==e.carImgNames.length&&(e.sellCarForm.value.carImgs=e.carImgURLs,a());for(var n=0;n<e.carImgNames.length;n++)e.angularFireStorage.upload("/carsForSell/"+e.sellCarForm.value.model+"/"+e.userAdditionalData[0].email+"/"+r+"//carImages/"+e.generateIdService.generateId()+"-"+e.carImgNames[n],e.carFiles[n]).then((function(r){r.ref.getDownloadURL().then((function(r){e.carImgURLs.push(r),e.carImgURLs.length==e.carImgNames.length&&(e.sellCarForm.value.carImgs=e.carImgURLs,e.getcarImgURLsError=null,a())})).catch((function(r){e.getcarImgURLsError=r.message})),e.uploadCarImagesToFirestoreError=null})).catch((function(r){e.uploadCarImagesToFirestoreError=r.message}))}))}},{key:"removeCarImg",value:function(r){this.carImgLocalPaths.splice(r,1),this.carImgNames.splice(r,1),this.carFiles.splice(r,1),0==this.carFiles&&(this.sellCarForm.value.carImgs=null)}}]),r}()).\u0275fac=function(r){return new(r||Fr)(u.Lb(l.c),u.Lb(h.a),u.Lb(C.a),u.Lb(R.a),u.Lb(y.a),u.Lb(s.b))},Fr.\u0275cmp=u.Fb({type:Fr,selectors:[["app-sell-car"]],decls:60,vars:25,consts:[[1,"sell-car-container"],[4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"sell-car-container__form",3,"formGroup","ngSubmit"],[1,"sell-car-container__form__drop-downs"],[1,"sell-car-container__form__drop-downs__el"],[1,"el-label"],[3,"ngClass"],["formControlName","model"],[3,"value",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],["formControlName","year"],[1,"sell-car-container__form__drop-downs__el","price"],["type","number","name","price","formControlName","price"],[1,"sell-car-container__form__hr"],[1,"defaut-img"],[3,"src"],["formControlName","carImg","type","file","accept",".png,.jpg,.jpeg,.svg,.heic",2,"display","none",3,"change"],["chooseCarImg",""],["type","button",1,"button","btn-default","narrow-btn","ng-star-inserted",3,"click"],[1,"info-text"],["placeholder","Description...","formControlName","description",1,"textarea"],[1,"sell-car-container__form__car-images"],["class","defaut-img",4,"ngIf"],["class","img-container",4,"ngIf"],["formControlName","carImgs","type","file","accept",".png,.jpg,.jpeg,.svg,.heic","multiple","multiple",2,"display","none",3,"change"],["chooseCarImgs",""],["type","submit",1,"button","btn-default","narrow-btn","ng-star-inserted",3,"disabled"],[1,"error-msg"],[3,"value"],[1,"error"],[1,"img-container"],["class","img-element",4,"ngFor","ngForOf"],[1,"img-element"],[3,"click"]],template:function(r,e){if(1&r){var a=u.Sb();u.Rb(0,"div",0),u.vc(1,ir,1,0,"app-loading-spinner",1),u.Rb(2,"div"),u.vc(3,or,2,1,"p",2),u.vc(4,sr,2,1,"p",2),u.Qb(),u.Rb(5,"form",3),u.Yb("ngSubmit",(function(){return e.onSubmit(e.sellCarForm)})),u.Rb(6,"div",4),u.Rb(7,"div",5),u.Rb(8,"p",6),u.xc(9,"Model"),u.Qb(),u.Rb(10,"mat-form-field",7),u.Rb(11,"mat-select",8),u.vc(12,lr,2,2,"mat-option",9),u.Qb(),u.Qb(),u.vc(13,gr,2,0,"p",10),u.Qb(),u.Rb(14,"div",5),u.Rb(15,"p",6),u.xc(16,"Year"),u.Qb(),u.Rb(17,"mat-form-field",7),u.Rb(18,"mat-select",11),u.vc(19,ur,2,2,"mat-option",9),u.Qb(),u.Qb(),u.vc(20,br,2,0,"p",10),u.Qb(),u.Rb(21,"div",12),u.Rb(22,"p",6),u.xc(23,"Price"),u.Qb(),u.Mb(24,"input",13),u.vc(25,mr,2,0,"p",10),u.Qb(),u.Qb(),u.Mb(26,"hr",14),u.Rb(27,"div"),u.Rb(28,"div",15),u.Mb(29,"img",16),u.Qb(),u.Rb(30,"input",17,18),u.Yb("change",(function(r){return e.onChooseCarImg(r)})),u.Qb(),u.Rb(32,"button",19),u.Yb("click",(function(){return u.pc(a),u.nc(31).click()})),u.xc(33,"Ch\u043eose Image"),u.Qb(),u.Rb(34,"p",20),u.xc(35,"(The field is mandatory)"),u.Qb(),u.Qb(),u.Mb(36,"hr",14),u.Rb(37,"div"),u.Mb(38,"textarea",21),u.vc(39,dr,2,0,"p",10),u.Qb(),u.Mb(40,"hr",14),u.Rb(41,"div",22),u.vc(42,fr,2,1,"div",23),u.vc(43,hr,2,1,"div",24),u.Rb(44,"button",19),u.Yb("click",(function(){return u.pc(a),u.nc(49).click()})),u.xc(45,"Ch\u043eose Images"),u.Qb(),u.Rb(46,"p",20),u.xc(47,"(You could add images later)"),u.Qb(),u.Rb(48,"input",25,26),u.Yb("change",(function(r){return e.onChooseCarImgs(r)})),u.Qb(),u.Qb(),u.Mb(50,"hr",14),u.Rb(51,"div"),u.Rb(52,"button",27),u.xc(53,"Add to the Shop"),u.Qb(),u.Qb(),u.Rb(54,"div"),u.vc(55,vr,2,1,"p",2),u.vc(56,Ir,2,1,"p",2),u.vc(57,Cr,2,1,"p",2),u.vc(58,Rr,2,1,"p",2),u.vc(59,yr,2,1,"p",2),u.Qb(),u.Qb(),u.Qb()}2&r&&(u.Ab(1),u.gc("ngIf",e.isLoading),u.Ab(2),u.gc("ngIf",e.getCarModelsError),u.Ab(1),u.gc("ngIf",e.getCarManufactureYearError),u.Ab(1),u.gc("formGroup",e.sellCarForm),u.Ab(5),u.gc("ngClass",u.kc(21,Lr,!e.sellCarForm.get("model").valid&&e.sellCarForm.get("model").touched)),u.Ab(2),u.gc("ngForOf",e.carModels),u.Ab(1),u.gc("ngIf",!e.sellCarForm.get("model").valid&&e.sellCarForm.get("model").touched),u.Ab(4),u.gc("ngClass",u.kc(23,Lr,!e.sellCarForm.get("year").valid&&e.sellCarForm.get("year").touched)),u.Ab(2),u.gc("ngForOf",e.carManufactureYears),u.Ab(1),u.gc("ngIf",!e.sellCarForm.get("year").valid&&e.sellCarForm.get("year").touched),u.Ab(5),u.gc("ngIf",!e.sellCarForm.get("price").valid&&e.sellCarForm.get("price").touched),u.Ab(4),u.gc("src",e.carImgLocalPath,u.qc),u.Ab(10),u.gc("ngIf",!e.sellCarForm.get("description").valid&&e.sellCarForm.get("description").touched),u.Ab(3),u.gc("ngIf",0==e.carImgLocalPaths.length),u.Ab(1),u.gc("ngIf",e.carImgLocalPaths.length>0),u.Ab(9),u.gc("disabled",!e.sellCarForm.valid),u.Ab(3),u.gc("ngIf",e.sellCarError),u.Ab(1),u.gc("ngIf",e.uploadCarImgToFirestoreError),u.Ab(1),u.gc("ngIf",e.uploadCarImagesToFirestoreError),u.Ab(1),u.gc("ngIf",e.getCarImgURLError),u.Ab(1),u.gc("ngIf",e.getcarImgURLsError))},directives:[o.l,l.q,l.l,l.g,cr.b,o.j,g.a,l.k,l.e,o.k,l.n,l.b,v.a,tr.f],encapsulation:2}),Fr),Ar=t("XupT");function Sr(r,e){if(1&r&&(u.Rb(0,"p",2),u.xc(1),u.Qb()),2&r){var a=u.ac();u.Ab(1),u.yc(a.getCarLinksErrorMsg)}}var wr,Er,kr=((wr=function(){function r(e,n,c){a(this,r),this.firestore=e,this.subjectsService=n,this.router=c,this.carLinks=[]}return c(r,[{key:"ngOnInit",value:function(){var r=this;this.isLoadingSub=this.subjectsService.isLoadingSubject.subscribe((function(e){r.isLoading=e})),this.firestore.getSecondHandCarsLink().subscribe((function(e){r.carLinks=e.map((function(r){return Object.assign({id:r.payload.doc.id},r.payload.doc.data())})),r.subjectsService.loaded(),r.getCarLinksErrorMsg=null}),(function(e){r.subjectsService.loaded(),r.getCarLinksErrorMsg=e.message}));var e=JSON.parse(localStorage.getItem("sell-buy-car/buy-LastVisitedLink"));e&&this.router.navigate([e])}},{key:"ngOnDestroy",value:function(){this.isLoadingSub.unsubscribe()}}]),r}()).\u0275fac=function(r){return new(r||wr)(u.Lb(h.a),u.Lb(I.a),u.Lb(s.b))},wr.\u0275cmp=u.Fb({type:wr,selectors:[["app-buy-car"]],decls:3,vars:3,consts:[["class","error-msg",4,"ngIf"],[3,"carLinks","currentLink"],[1,"error-msg"]],template:function(r,e){1&r&&(u.Rb(0,"div"),u.vc(1,Sr,2,1,"p",0),u.Mb(2,"app-categories-router",1),u.Qb()),2&r&&(u.Ab(1),u.gc("ngIf",e.getCarLinksErrorMsg),u.Ab(1),u.gc("carLinks",e.carLinks)("currentLink","sell-buy-car/buy"))},directives:[o.l,Ar.a],encapsulation:2}),wr),Mr=t("PCNd"),xr=((Er=function r(){a(this,r)}).\u0275mod=u.Jb({type:Er}),Er.\u0275inj=u.Ib({factory:function(r){return new(r||Er)},imports:[[o.c,l.o,Mr.a,g.b,s.e.forChild([{path:"",component:f,canActivate:[p.a],children:[{path:"buy",component:kr,children:[{path:"audi",component:J},{path:"bmw",component:ar},{path:"**",redirectTo:"audi"}]},{path:"sell",component:Qr},{path:"**",redirectTo:"buy"}]}])]]}),Er)}}])}();