(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{F15C:function(r,e,a){"use strict";a.r(e),a.d(e,"SellBuyCarModule",(function(){return wr}));var t=a("ofXK"),c=a("tyNb"),i=a("3Pt+"),s=a("d3UM"),n=a("fXoL"),o=a("1XCa");const l=function(){return["buy"]},g=function(){return["sell"]};let u=(()=>{class r{constructor(r){this.router=r}ngOnInit(){const r=JSON.parse(localStorage.getItem("sell-buy-car-LastVisitedLink"));r&&this.router.navigate([r])}saveLastVisitedLinkToLocalStore(r){localStorage.setItem("sell-buy-car-LastVisitedLink",JSON.stringify("/sell-buy-car/"+r))}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(c.b))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-sell-buy-car"]],decls:9,vars:4,consts:[[1,"container"],[1,"sell-buy-car"],[1,"sell-buy-car__router-links"],["routerLinkActive","categories-active",3,"routerLink","click"]],template:function(r,e){1&r&&(n.Rb(0,"div",0),n.Mb(1,"app-categories-info"),n.Rb(2,"div",1),n.Rb(3,"ul",2),n.Rb(4,"li",3),n.Yb("click",(function(){return e.saveLastVisitedLinkToLocalStore("buy")})),n.wc(5,"Buy Second Hand Car"),n.Qb(),n.Rb(6,"li",3),n.Yb("click",(function(){return e.saveLastVisitedLinkToLocalStore("sell")})),n.wc(7," Sell Your Car"),n.Qb(),n.Qb(),n.Mb(8,"router-outlet"),n.Qb(),n.Qb()),2&r&&(n.Ab(4),n.gc("routerLink",n.ic(2,l)),n.Ab(2),n.gc("routerLink",n.ic(3,g)))},directives:[o.a,c.d,c.c,c.f],encapsulation:2}),r})();var b=a("2CTM"),m=a("T/S4"),d=a("zy28"),h=a("rL3l"),p=a("V86y"),f=a("Vaw3"),I=a("B02C"),C=a("fk3A"),v=a("odcQ");function R(r,e){1&r&&n.Mb(0,"app-loading-spinner")}function L(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div"),n.Rb(1,"button",6),n.Yb("click",(function(){return n.oc(r),n.ac().onEdit()})),n.wc(2,"Edit"),n.Qb(),n.Qb()}}function F(r,e){if(1&r&&n.Mb(0,"app-car-images",10),2&r){const r=n.ac(2);n.gc("carImgs",r.car.carImages)}}function w(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div",7),n.Rb(1,"button",8),n.Yb("click",(function(){n.oc(r);const e=n.ac();return e.onShowCarImages(e.car.id)})),n.wc(2,"View Images"),n.Qb(),n.uc(3,F,1,1,"app-car-images",9),n.Qb()}if(2&r){const r=n.ac();n.Ab(3),n.gc("ngIf",r.carShowImages&&r.carId==r.car.id)}}function A(r,e){1&r&&(n.Rb(0,"p"),n.wc(1,"There are no images uploaded"),n.Qb())}function Q(r,e){1&r&&(n.Rb(0,"div"),n.Rb(1,"p"),n.wc(2,"There are no images uploaded"),n.Qb(),n.Qb())}function y(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div"),n.Mb(1,"img",15),n.Rb(2,"div",24),n.Yb("click",(function(){n.oc(r);const a=e.index,t=e.$implicit;return n.ac(3).deleteCurrentImages(a,t)})),n.wc(3,"X"),n.Qb(),n.Qb()}if(2&r){const r=e.$implicit;n.Ab(1),n.gc("src",r,n.pc)}}function S(r,e){if(1&r&&(n.Rb(0,"div"),n.Rb(1,"p"),n.wc(2,"Current Images"),n.Qb(),n.uc(3,y,4,1,"div",23),n.Qb()),2&r){const r=n.ac(2);n.Ab(3),n.gc("ngForOf",r.currentCarImages)}}function E(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div"),n.Mb(1,"img",15),n.Rb(2,"div",24),n.Yb("click",(function(){n.oc(r);const a=e.index;return n.ac(3).removeCarImg(a)})),n.wc(3,"X"),n.Qb(),n.Qb()}if(2&r){const r=e.$implicit;n.Ab(1),n.gc("src",r,n.pc)}}function M(r,e){if(1&r&&(n.Rb(0,"div"),n.Rb(1,"p"),n.wc(2,"New Images"),n.Qb(),n.Rb(3,"div"),n.uc(4,E,4,1,"div",23),n.Qb(),n.Qb()),2&r){const r=n.ac(2);n.Ab(4),n.gc("ngForOf",r.carImgLocalPaths)}}function k(r,e){1&r&&(n.Rb(0,"p"),n.wc(1,"Select Images"),n.Qb())}function U(r,e){1&r&&(n.Rb(0,"p"),n.wc(1,"Select More Images"),n.Qb())}function D(r,e){if(1&r&&(n.Rb(0,"p",25),n.wc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.xc(r.uploadCarImagesToFirestoreError)}}function T(r,e){if(1&r&&(n.Rb(0,"p",25),n.wc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.xc(r.updateSecondHandCarError)}}function N(r,e){if(1&r&&(n.Rb(0,"p",25),n.wc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.xc(r.setcarImgURLsError)}}function O(r,e){if(1&r&&(n.Rb(0,"p",25),n.wc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.xc(r.deleteOldImgError)}}function P(r,e){if(1&r&&(n.Rb(0,"p",25),n.wc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.xc(r.getCarImgURLError)}}function _(r,e){if(1&r&&(n.Rb(0,"p",25),n.wc(1),n.Qb()),2&r){const r=n.ac(2);n.Ab(1),n.xc(r.uploadCarImgToFirestoreError)}}function j(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div",11),n.Rb(1,"form",12),n.Yb("ngSubmit",(function(){n.oc(r);const e=n.ac();return e.submitCarDetailChanges(e.changeCarDetailsForm)})),n.Rb(2,"div"),n.Rb(3,"input",13,14),n.Yb("change",(function(e){return n.oc(r),n.ac().onChooseCarImg(e)})),n.Qb(),n.Mb(5,"img",15),n.Rb(6,"button",6),n.Yb("click",(function(){return n.oc(r),n.mc(4).click()})),n.wc(7,"Change Car Image"),n.Qb(),n.Qb(),n.Rb(8,"div"),n.Mb(9,"textarea",16),n.Qb(),n.Rb(10,"div"),n.Mb(11,"input",17),n.Qb(),n.Rb(12,"div"),n.Rb(13,"div"),n.uc(14,Q,3,0,"div",1),n.uc(15,S,4,1,"div",1),n.uc(16,M,5,1,"div",1),n.Qb(),n.Rb(17,"div"),n.Rb(18,"input",18,19),n.Yb("change",(function(e){return n.oc(r),n.ac().onChooseCarImgs(e)})),n.Qb(),n.Rb(20,"button",20),n.Yb("click",(function(){return n.oc(r),n.mc(19).click()})),n.uc(21,k,2,0,"p",1),n.uc(22,U,2,0,"p",1),n.Qb(),n.Qb(),n.Qb(),n.Rb(23,"div"),n.Rb(24,"button",21),n.wc(25,"Apply Changes"),n.Qb(),n.Rb(26,"button",6),n.Yb("click",(function(){return n.oc(r),n.ac().onCancel()})),n.wc(27,"Cancel"),n.Qb(),n.Qb(),n.Rb(28,"div"),n.uc(29,D,2,1,"p",22),n.uc(30,T,2,1,"p",22),n.uc(31,N,2,1,"p",22),n.uc(32,O,2,1,"p",22),n.uc(33,P,2,1,"p",22),n.uc(34,_,2,1,"p",22),n.Qb(),n.Qb(),n.Qb()}if(2&r){const r=n.ac();n.Ab(1),n.gc("formGroup",r.changeCarDetailsForm),n.Ab(4),n.gc("src",r.carImgLocalPath,n.pc),n.Ab(9),n.gc("ngIf",!r.car.carImages),n.Ab(1),n.gc("ngIf",r.currentCarImages.length>0),n.Ab(1),n.gc("ngIf",r.carImgLocalPaths.length>0),n.Ab(5),n.gc("ngIf",!r.currentCarImages),n.Ab(1),n.gc("ngIf",r.currentCarImages),n.Ab(7),n.gc("ngIf",r.uploadCarImagesToFirestoreError),n.Ab(1),n.gc("ngIf",r.updateSecondHandCarError),n.Ab(1),n.gc("ngIf",r.setcarImgURLsError),n.Ab(1),n.gc("ngIf",r.deleteOldImgError),n.Ab(1),n.gc("ngIf",r.getCarImgURLError),n.Ab(1),n.gc("ngIf",r.uploadCarImgToFirestoreError)}}const x=function(r){return{"background-image":r}};let Y=(()=>{class r{constructor(r,e,a,t,c,i){this.subjectService=r,this.formBuilder=e,this.firestore=a,this.additionUserInfoService=t,this.angularFireStorage=c,this.generateIdService=i,this.isInEditMode=!1,this.ownerEmail=null,this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.currentCarImages=[],this.uploadCarImagesToFirestoreError=null,this.updateSecondHandCarError=null,this.setcarImgURLsError=null,this.isLoading=!1,this.deleteOldImgError=null,this.getCarImgURLError=null,this.uploadCarImgToFirestoreError=null,this.currentImageForDelete=[]}ngOnInit(){this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe(r=>{this.userAdditionalData=r,this.ownerEmail=this.userAdditionalData[0].email}),this.carShowImagesSub=this.subjectService.carShowImagesSubject.subscribe(r=>{this.carShowImages=r}),this.carIdSub=this.subjectService.carIdSubject.subscribe(r=>{this.carId=r}),this.changeCarDetailsForm=this.formBuilder.group({carImg:new i.d(null),model:new i.d(null),description:new i.d(null,i.p.required),price:new i.d(null,i.p.required),carImgs:new i.d(null)}),this.currentCarImages=[...this.car.carImages],this.carImgLocalPath=this.car.carImg}ngOnDestroy(){this.carShowImagesSub.unsubscribe(),this.carIdSub.unsubscribe(),this.userAdditionalInfoSub.unsubscribe()}onShowCarImages(r){this.subjectService.onShowCarImages(r)}submitCarDetailChanges(r){if(!r.valid)return;this.isLoading=!0;const e=this.car.id;let a=this.car.carImg;const t=this.car.model;this.onUploadCarImageToFirestore(e).then(()=>{if(r.value.carImg&&(a=r.value.carImg),this.currentImageForDelete.length>0){for(let r=0;r<this.currentImageForDelete.length;r++)this.firestore.delete(this.currentImageForDelete[r]);this.firestore.setSecondHanCurrentImages({doc:t,id:e,currentImgs:this.currentCarImages})}this.onUploadCarImagesToFirestore(e).then(()=>{if(this.carImgNames.length>0)for(let a=0;a<this.carImgNames.length;a++)this.firestore.updateSecondHanImagesCar({doc:t,id:e,img:r.value.carImgs[a]});this.firestore.updateSecondHandCar({carImg:a,description:r.value.description,price:r.value.price,id:e,doc:t}).then(()=>{this.isLoading=!1,this.updateSecondHandCarError=null,this.onCancel()},r=>{this.updateSecondHandCarError=r.message})})})}onChooseCarImg(r){if(this.carFile=r.target.files[0],this.carFile){const e=new FileReader;e.onload=r=>{this.carImgLocalPath=r.target.result},e.readAsDataURL(r.target.files[0])}else this.carImgLocalPath=this.car.carImg}onUploadCarImageToFirestore(r){return new Promise(e=>{this.carFile||e(),this.angularFireStorage.upload("/carsForSell/"+this.changeCarDetailsForm.value.model+"/"+this.userAdditionalData[0].email+"/"+r+"/"+this.carFile.name,this.carFile).then(r=>{r.ref.getDownloadURL().then(r=>{this.changeCarDetailsForm.value.carImg=r,this.firestore.delete(this.car.carImg).then(()=>{this.deleteOldImgError=null}).catch(r=>{this.deleteOldImgError=r.message}),this.getCarImgURLError=null,e()}).catch(r=>{this.getCarImgURLError=r.message}),this.uploadCarImgToFirestoreError=null}).catch(r=>{this.uploadCarImgToFirestoreError=r.message})})}onChooseCarImgs(r){if(this.carFiles=r.target.files,this.carFiles.length>0)for(let e=0;e<this.carFiles.length;e++){const a=new FileReader;a.onload=r=>{this.carImgLocalPaths.push(r.target.result)},a.readAsDataURL(r.target.files[e]),this.carImgNames.push(this.carFiles[e].name)}else this.carFiles=null,this.carImgLocalPaths=[],this.carImgNames=[],this.changeCarDetailsForm.controls.carImgs.setValue("")}onUploadCarImagesToFirestore(r){return new Promise(e=>{0==this.carImgNames.length&&e();for(let a=0;a<this.carImgNames.length;a++)this.angularFireStorage.upload("/carsForSell/"+this.changeCarDetailsForm.value.model+"/"+this.userAdditionalData[0].email+"/"+r+"//carImages/"+this.generateIdService.generateId()+"-"+this.carImgNames[a],this.carFiles[a]).then(r=>{r.ref.getDownloadURL().then(r=>{this.carImgURLs.push(r),this.carImgURLs.length==this.carImgNames.length&&(this.changeCarDetailsForm.value.carImgs=this.carImgURLs,this.setcarImgURLsError=null,e())}).catch(r=>{this.setcarImgURLsError=r.message}),this.uploadCarImagesToFirestoreError=null}).catch(r=>{this.uploadCarImagesToFirestoreError=r.message})})}onEdit(){this.changeCarDetailsForm.controls.description.setValue(this.car.description),this.changeCarDetailsForm.controls.price.setValue(this.car.price),this.changeCarDetailsForm.controls.model.setValue(this.car.model),this.isInEditMode=!0}removeCarImg(r){this.carImgLocalPaths.splice(r,1),this.carImgNames.splice(r,1),0==this.carImgLocalPaths&&0==this.carImgNames&&(this.changeCarDetailsForm.value.carImgs=null)}onCancel(){this.carFiles=null,this.carImgLocalPaths=[],this.carImgNames=[],this.changeCarDetailsForm.controls.carImgs.setValue(""),this.changeCarDetailsForm.controls.carImg.setValue(""),this.carImgLocalPath=this.car.carImg,this.currentCarImages=[...this.car.carImages],this.currentImageForDelete=[],this.isInEditMode=!1}deleteCurrentImages(r,e){this.currentCarImages.splice(r,1),this.currentImageForDelete.push(e)}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(h.a),n.Lb(i.c),n.Lb(m.a),n.Lb(p.a),n.Lb(f.a),n.Lb(I.a))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-buy-car-item"]],inputs:{car:"car"},decls:32,vars:41,consts:[[1,"car-item"],[4,"ngIf"],[1,"car-item__img",3,"src"],[1,"comment-img",3,"ngStyle"],["class","car-item__images",4,"ngIf"],["class","test",4,"ngIf"],["type","button",3,"click"],[1,"car-item__images"],[1,"btn-default","narrow-btn",3,"click"],[3,"carImgs",4,"ngIf"],[3,"carImgs"],[1,"test"],[3,"formGroup","ngSubmit"],["formControlName","carImg","type","file","accept",".png,.jpg,.jpeg,.svg,.heic",2,"display","none",3,"change"],["chooseCarImg",""],[3,"src"],["formControlName","description"],["type","number","name","price","formControlName","price"],["formControlName","carImgs","type","file","accept",".png,.jpg,.jpeg,.svg,.heic","multiple","multiple",2,"display","none",3,"change"],["chooseCarImgs",""],["type","button",1,"btn-default","narrow-btn","ng-star-inserted",3,"click"],["type","submit"],["class","error-msg",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"click"],[1,"error-msg"]],template:function(r,e){1&r&&(n.Rb(0,"div",0),n.uc(1,R,1,0,"app-loading-spinner",1),n.Mb(2,"img",2),n.Rb(3,"div"),n.Rb(4,"p"),n.wc(5),n.Qb(),n.Rb(6,"p"),n.wc(7),n.Qb(),n.Rb(8,"p"),n.wc(9),n.Qb(),n.Rb(10,"p"),n.wc(11),n.Qb(),n.Qb(),n.uc(12,L,3,0,"div",1),n.Rb(13,"p"),n.wc(14),n.bc(15,"date"),n.Qb(),n.Rb(16,"div"),n.Mb(17,"div",3),n.bc(18,"async"),n.bc(19,"getUserInfo"),n.Rb(20,"div"),n.wc(21),n.bc(22,"async"),n.bc(23,"getUserInfo"),n.bc(24,"async"),n.bc(25,"getUserInfo"),n.bc(26,"async"),n.bc(27,"getUserInfo"),n.Qb(),n.Qb(),n.Rb(28,"div"),n.uc(29,w,4,1,"div",4),n.uc(30,A,2,0,"p",1),n.Qb(),n.uc(31,j,35,13,"div",5),n.Qb()),2&r&&(n.Ab(1),n.gc("ngIf",e.isLoading),n.Ab(1),n.gc("src",e.car.carImg,n.pc),n.Ab(3),n.xc(e.car.model),n.Ab(2),n.xc(e.car.year),n.Ab(2),n.xc(e.car.description),n.Ab(2),n.xc(e.car.price),n.Ab(1),n.gc("ngIf",e.ownerEmail==e.car.owner),n.Ab(2),n.xc(n.dc(15,16,e.car.date.toDate(),"dd.MM.yyyy")),n.Ab(3),n.gc("ngStyle",n.jc(39,x,n.cc(18,19,n.dc(19,21,e.car.owner,"userImg")))),n.Ab(4),n.Ac(" ",n.cc(22,24,n.dc(23,26,e.car.owner,"name"))," ",n.cc(24,29,n.dc(25,31,e.car.owner,"phoneCode"))," ",n.cc(26,34,n.dc(27,36,e.car.owner,"phone"))," ",e.car.owner," "),n.Ab(8),n.gc("ngIf",e.car.carImages),n.Ab(1),n.gc("ngIf",!e.car.carImages),n.Ab(1),n.gc("ngIf",e.isInEditMode))},directives:[t.l,t.m,d.a,C.a,i.q,i.l,i.g,i.b,i.k,i.e,i.n,t.k],pipes:[t.e,t.b,v.a],styles:[".test[_ngcontent-%COMP%]{\n    position: fixed;\n    top: 50px;\n    left: 0;\n    width: 100%;\n    height: 100vh;\n    background-color: rgba(0, 0, 0, 0.5);\n  }\n\n  img[_ngcontent-%COMP%] {\n    width: 100px;\n  }"]}),r})();function V(r,e){1&r&&(n.Rb(0,"div"),n.Mb(1,"app-loading-spinner"),n.Qb())}function H(r,e){1&r&&n.Mb(0,"app-buy-car-item",6),2&r&&n.gc("car",e.$implicit)}function q(r,e){if(1&r&&(n.Rb(0,"div",4),n.uc(1,H,1,1,"app-buy-car-item",5),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.gc("ngForOf",r.audiCars)}}function B(r,e){if(1&r&&(n.Rb(0,"p",7),n.wc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.xc(r.errorMsg)}}let J=(()=>{class r{constructor(r){this.firestore=r,this.isLoading=!0,this.errorMsg=null}ngOnInit(){this.firestore.getSecondHandAudi().subscribe(r=>{this.audiCars=r.map(r=>Object.assign({id:r.payload.doc.id},r.payload.doc.data())),this.isLoading=!1,this.errorMsg=null},r=>{this.isLoading=!1,this.errorMsg=r.message})}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(m.a))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-audi"]],decls:4,vars:3,consts:[[1,"cars-container"],[4,"ngIf"],["class","cars",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"cars"],[3,"car",4,"ngFor","ngForOf"],[3,"car"],[1,"error-msg"]],template:function(r,e){1&r&&(n.Rb(0,"div",0),n.uc(1,V,2,0,"div",1),n.uc(2,q,2,1,"div",2),n.uc(3,B,2,1,"p",3),n.Qb()),2&r&&(n.Ab(1),n.gc("ngIf",e.isLoading),n.Ab(1),n.gc("ngIf",!e.isLoading),n.Ab(1),n.gc("ngIf",e.errorMsg))},directives:[t.l,d.a,t.k,Y],encapsulation:2}),r})();function $(r,e){1&r&&(n.Rb(0,"div"),n.Mb(1,"app-loading-spinner"),n.Qb())}function X(r,e){1&r&&n.Mb(0,"app-buy-car-item",6),2&r&&n.gc("car",e.$implicit)}function G(r,e){if(1&r&&(n.Rb(0,"div",4),n.uc(1,X,1,1,"app-buy-car-item",5),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.gc("ngForOf",r.bmwCars)}}function K(r,e){if(1&r&&(n.Rb(0,"p",7),n.wc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.xc(r.errorMsg)}}let W=(()=>{class r{constructor(r){this.firestore=r,this.isLoading=!0,this.errorMsg=null}ngOnInit(){this.firestore.getSecondHandBMW().subscribe(r=>{this.bmwCars=r.map(r=>Object.assign({id:r.payload.doc.id},r.payload.doc.data())),this.isLoading=!1,this.errorMsg=null},r=>{this.isLoading=!1,this.errorMsg=r.message})}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(m.a))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-bmw"]],decls:4,vars:3,consts:[[1,"cars-container"],[4,"ngIf"],["class","cars",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"cars"],[3,"car",4,"ngFor","ngForOf"],[3,"car"],[1,"error-msg"]],template:function(r,e){1&r&&(n.Rb(0,"div",0),n.uc(1,$,2,0,"div",1),n.uc(2,G,2,1,"div",2),n.uc(3,K,2,1,"p",3),n.Qb()),2&r&&(n.Ab(1),n.gc("ngIf",e.isLoading),n.Ab(1),n.gc("ngIf",!e.isLoading),n.Ab(1),n.gc("ngIf",e.errorMsg))},directives:[t.l,d.a,t.k,Y],encapsulation:2}),r})();var z=a("Wcq6"),Z=a("kmnG"),rr=a("FKr1");function er(r,e){1&r&&n.Mb(0,"app-loading-spinner")}function ar(r,e){if(1&r&&(n.Rb(0,"p",27),n.wc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.xc(r.getCarModelsError)}}function tr(r,e){if(1&r&&(n.Rb(0,"p",27),n.wc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.xc(r.getCarManufactureYearError)}}function cr(r,e){if(1&r&&(n.Rb(0,"mat-option",28),n.wc(1),n.Qb()),2&r){const r=e.$implicit;n.gc("value",r.name),n.Ab(1),n.yc(" ",r.name," ")}}function ir(r,e){1&r&&(n.Rb(0,"p",29),n.wc(1," The field is required! "),n.Qb())}function sr(r,e){if(1&r&&(n.Rb(0,"mat-option",28),n.wc(1),n.Qb()),2&r){const r=e.$implicit;n.gc("value",r.year),n.Ab(1),n.yc(" ",r.year," ")}}function nr(r,e){1&r&&(n.Rb(0,"p",29),n.wc(1," The field is required! "),n.Qb())}function or(r,e){1&r&&(n.Rb(0,"p",29),n.wc(1," The field is required! "),n.Qb())}function lr(r,e){1&r&&(n.Rb(0,"p",29),n.wc(1," Please enter information about the condition of your car! "),n.Qb())}function gr(r,e){if(1&r&&(n.Rb(0,"div",15),n.Mb(1,"img",16),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.gc("src",r.carDefaultImg,n.pc)}}function ur(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div",32),n.Mb(1,"img",16),n.Rb(2,"div",33),n.Yb("click",(function(){n.oc(r);const a=e.index;return n.ac(2).removeCarImg(a)})),n.wc(3,"X"),n.Qb(),n.Qb()}if(2&r){const r=e.$implicit;n.Ab(1),n.gc("src",r,n.pc)}}function br(r,e){if(1&r&&(n.Rb(0,"div",30),n.uc(1,ur,4,1,"div",31),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.gc("ngForOf",r.carImgLocalPaths)}}function mr(r,e){if(1&r&&(n.Rb(0,"p",27),n.wc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.xc(r.sellCarError)}}function dr(r,e){if(1&r&&(n.Rb(0,"p",27),n.wc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.xc(r.uploadCarImgToFirestoreError)}}function hr(r,e){if(1&r&&(n.Rb(0,"p",27),n.wc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.xc(r.uploadCarImagesToFirestoreError)}}function pr(r,e){if(1&r&&(n.Rb(0,"p",27),n.wc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.xc(r.getCarImgURLError)}}function fr(r,e){if(1&r&&(n.Rb(0,"p",27),n.wc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.xc(r.getcarImgURLsError)}}const Ir=function(r){return{"invalid no-border":r}};let Cr=(()=>{class r{constructor(r,e,a,t,c,i){this.formBuilder=r,this.firestore=e,this.additionUserInfoService=a,this.angularFireStorage=t,this.generateIdService=c,this.router=i,this.carDefaultImg="../../../assets/img/cell-buy-car/upload-img.png",this.carImgLocalPath=this.carDefaultImg,this.carFiles=[],this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.carModels=[],this.carManufactureYears=[],this.getCarModelsError=null,this.getCarManufactureYearError=null,this.sellCarError=null,this.uploadCarImgToFirestoreError=null,this.uploadCarImagesToFirestoreError=null,this.getCarImgURLError=null,this.getcarImgURLsError=null,this.isLoading=!1}ngOnInit(){this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe(r=>{this.userAdditionalData=r}),this.sellCarForm=this.formBuilder.group({model:new i.d(null,i.p.required),year:new i.d(null,i.p.required),carImg:new i.d(null,i.p.required),description:new i.d(null,i.p.required),price:new i.d(null,i.p.required),carImgs:new i.d(null)}),this.firestore.getSecondHandCarsLink().subscribe(r=>{this.carModels=r.map(r=>Object.assign({id:r.payload.doc.id},r.payload.doc.data())),this.getCarModelsError=null},r=>{this.getCarModelsError=r.message}),this.firestore.getCarManufactureYear().subscribe(r=>{this.carManufactureYears=r.map(r=>Object.assign({id:r.payload.doc.id},r.payload.doc.data())),this.getCarManufactureYearError=null},r=>{this.getCarManufactureYearError=r.message})}ngOnDestroy(){this.userAdditionalInfoSub.unsubscribe()}onSubmit(r){if(!r.valid)return;this.isLoading=!0;const e=this.generateIdService.generateId();this.onUploadCarImgToFirestore(e).then(()=>{this.onUploadCarImagesToFirestore(e).then(()=>{const a=r.value.model,t=r.value.year,c=r.value.carImg,i=r.value.description.trim(),s=r.value.price,n=this.userAdditionalData[0].email,o=z.firestore.Timestamp.now();this.firestore.setSecondHandCar({model:a,year:t,carImg:c,description:i,price:s,owner:n,id:e,date:o,carImages:r.value.carImgs}).then(()=>{this.isLoading=!1,this.sellCarForm.reset(),localStorage.setItem("sell-buy-car/buy-LastVisitedLink",JSON.stringify("/sell-buy-car/buy/"+a.toLowerCase())),this.router.navigate(["/sell-buy-car/buy/"+a.toLowerCase()]),this.carImgNames=[],this.carImgLocalPaths=[],this.carImgURLs=[],this.carImgLocalPath=this.carDefaultImg,this.sellCarError=null}).catch(r=>{this.sellCarError=r.message})})})}onChooseCarImg(r){if(this.carFile=r.target.files[0],this.carFile){const e=new FileReader;e.onload=r=>{this.carImgLocalPath=r.target.result},e.readAsDataURL(r.target.files[0])}else this.carImgLocalPath=this.carDefaultImg}onUploadCarImgToFirestore(r){return new Promise(e=>{this.angularFireStorage.upload("/carsForSell/"+this.sellCarForm.value.model+"/"+this.userAdditionalData[0].email+"/"+r+"/"+this.carFile.name,this.carFile).then(r=>{r.ref.getDownloadURL().then(r=>{this.sellCarForm.value.carImg=r,this.getCarImgURLError=null,e()}).catch(r=>{this.getCarImgURLError=r.message}),this.uploadCarImgToFirestoreError=null}).catch(r=>{this.uploadCarImgToFirestoreError=r.message})})}onChooseCarImgs(r){for(let e=0;e<r.target.files.length;e++){this.carFiles.push(r.target.files[e]);const a=new FileReader;a.onload=r=>{this.carImgLocalPaths.push(r.target.result)},a.readAsDataURL(r.target.files[e]),this.carImgNames.push(this.carFiles[e].name)}}onUploadCarImagesToFirestore(r){return new Promise(e=>{0==this.carImgNames.length&&e();for(let a=0;a<this.carImgNames.length;a++)this.angularFireStorage.upload("/carsForSell/"+this.sellCarForm.value.model+"/"+this.userAdditionalData[0].email+"/"+r+"//carImages/"+this.generateIdService.generateId()+"-"+this.carImgNames[a],this.carFiles[a]).then(r=>{r.ref.getDownloadURL().then(r=>{this.carImgURLs.push(r),this.carImgURLs.length==this.carImgNames.length&&(this.sellCarForm.value.carImgs=this.carImgURLs,this.getcarImgURLsError=null,e())}).catch(r=>{this.getcarImgURLsError=r.message}),this.uploadCarImagesToFirestoreError=null}).catch(r=>{this.uploadCarImagesToFirestoreError=r.message})})}removeCarImg(r){this.carImgLocalPaths.splice(r,1),this.carImgNames.splice(r,1),0==this.carImgLocalPaths&&0==this.carImgNames&&(this.sellCarForm.value.carImgs=null)}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(i.c),n.Lb(m.a),n.Lb(p.a),n.Lb(f.a),n.Lb(I.a),n.Lb(c.b))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-sell-car"]],decls:56,vars:25,consts:[[1,"sell-car-container"],[4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"sell-car-container__form",3,"formGroup","ngSubmit"],[1,"sell-car-container__form__drop-downs"],[1,"sell-car-container__form__drop-downs__el"],[1,"el-label"],[3,"ngClass"],["formControlName","model"],[3,"value",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],["formControlName","year"],[1,"sell-car-container__form__drop-downs__el","price"],["type","number","name","price","formControlName","price"],[1,"sell-car-container__form__hr"],[1,"defaut-img"],[3,"src"],["formControlName","carImg","type","file","accept",".png,.jpg,.jpeg,.svg,.heic",2,"display","none",3,"change"],["chooseCarImg",""],["type","button",1,"button","btn-default","narrow-btn","ng-star-inserted",3,"click"],["placeholder","Description...","formControlName","description",1,"textarea"],[1,"sell-car-container__form__car-images"],["class","defaut-img",4,"ngIf"],["class","img-container",4,"ngIf"],["formControlName","carImgs","type","file","accept",".png,.jpg,.jpeg,.svg,.heic","multiple","multiple",2,"display","none",3,"change"],["chooseCarImgs",""],["type","submit",1,"button","btn-default","narrow-btn","ng-star-inserted",3,"disabled"],[1,"error-msg"],[3,"value"],[1,"error"],[1,"img-container"],["class","img-element",4,"ngFor","ngForOf"],[1,"img-element"],[3,"click"]],template:function(r,e){if(1&r){const r=n.Sb();n.Rb(0,"div",0),n.uc(1,er,1,0,"app-loading-spinner",1),n.Rb(2,"div"),n.uc(3,ar,2,1,"p",2),n.uc(4,tr,2,1,"p",2),n.Qb(),n.Rb(5,"form",3),n.Yb("ngSubmit",(function(){return e.onSubmit(e.sellCarForm)})),n.Rb(6,"div",4),n.Rb(7,"div",5),n.Rb(8,"p",6),n.wc(9,"Model"),n.Qb(),n.Rb(10,"mat-form-field",7),n.Rb(11,"mat-select",8),n.uc(12,cr,2,2,"mat-option",9),n.Qb(),n.Qb(),n.uc(13,ir,2,0,"p",10),n.Qb(),n.Rb(14,"div",5),n.Rb(15,"p",6),n.wc(16,"Year"),n.Qb(),n.Rb(17,"mat-form-field",7),n.Rb(18,"mat-select",11),n.uc(19,sr,2,2,"mat-option",9),n.Qb(),n.Qb(),n.uc(20,nr,2,0,"p",10),n.Qb(),n.Rb(21,"div",12),n.Rb(22,"p",6),n.wc(23,"Price"),n.Qb(),n.Mb(24,"input",13),n.uc(25,or,2,0,"p",10),n.Qb(),n.Qb(),n.Mb(26,"hr",14),n.Rb(27,"div"),n.Rb(28,"div",15),n.Mb(29,"img",16),n.Qb(),n.Rb(30,"input",17,18),n.Yb("change",(function(r){return e.onChooseCarImg(r)})),n.Qb(),n.Rb(32,"button",19),n.Yb("click",(function(){return n.oc(r),n.mc(31).click()})),n.wc(33,"Ch\u043eose Image"),n.Qb(),n.Qb(),n.Mb(34,"hr",14),n.Rb(35,"div"),n.Mb(36,"textarea",20),n.uc(37,lr,2,0,"p",10),n.Qb(),n.Mb(38,"hr",14),n.Rb(39,"div",21),n.uc(40,gr,2,1,"div",22),n.uc(41,br,2,1,"div",23),n.Rb(42,"button",19),n.Yb("click",(function(){return n.oc(r),n.mc(45).click()})),n.wc(43,"Ch\u043eose Images"),n.Qb(),n.Rb(44,"input",24,25),n.Yb("change",(function(r){return e.onChooseCarImgs(r)})),n.Qb(),n.Qb(),n.Mb(46,"hr",14),n.Rb(47,"div"),n.Rb(48,"button",26),n.wc(49,"Add to the Shop"),n.Qb(),n.Qb(),n.Rb(50,"div"),n.uc(51,mr,2,1,"p",2),n.uc(52,dr,2,1,"p",2),n.uc(53,hr,2,1,"p",2),n.uc(54,pr,2,1,"p",2),n.uc(55,fr,2,1,"p",2),n.Qb(),n.Qb(),n.Qb()}2&r&&(n.Ab(1),n.gc("ngIf",e.isLoading),n.Ab(2),n.gc("ngIf",e.getCarModelsError),n.Ab(1),n.gc("ngIf",e.getCarManufactureYearError),n.Ab(1),n.gc("formGroup",e.sellCarForm),n.Ab(5),n.gc("ngClass",n.jc(21,Ir,!e.sellCarForm.get("model").valid&&e.sellCarForm.get("model").touched)),n.Ab(2),n.gc("ngForOf",e.carModels),n.Ab(1),n.gc("ngIf",!e.sellCarForm.get("model").valid&&e.sellCarForm.get("model").touched),n.Ab(4),n.gc("ngClass",n.jc(23,Ir,!e.sellCarForm.get("year").valid&&e.sellCarForm.get("year").touched)),n.Ab(2),n.gc("ngForOf",e.carManufactureYears),n.Ab(1),n.gc("ngIf",!e.sellCarForm.get("year").valid&&e.sellCarForm.get("year").touched),n.Ab(5),n.gc("ngIf",!e.sellCarForm.get("price").valid&&e.sellCarForm.get("price").touched),n.Ab(4),n.gc("src",e.carImgLocalPath,n.pc),n.Ab(8),n.gc("ngIf",!e.sellCarForm.get("description").valid&&e.sellCarForm.get("description").touched),n.Ab(3),n.gc("ngIf",0==e.carImgLocalPaths.length),n.Ab(1),n.gc("ngIf",e.carImgLocalPaths.length>0),n.Ab(7),n.gc("disabled",!e.sellCarForm.valid),n.Ab(3),n.gc("ngIf",e.sellCarError),n.Ab(1),n.gc("ngIf",e.uploadCarImgToFirestoreError),n.Ab(1),n.gc("ngIf",e.uploadCarImagesToFirestoreError),n.Ab(1),n.gc("ngIf",e.getCarImgURLError),n.Ab(1),n.gc("ngIf",e.getcarImgURLsError))},directives:[t.l,i.q,i.l,i.g,Z.b,t.j,s.a,i.k,i.e,t.k,i.n,i.b,d.a,rr.f],encapsulation:2}),r})();var vr=a("XupT");function Rr(r,e){if(1&r&&(n.Rb(0,"p",2),n.wc(1),n.Qb()),2&r){const r=n.ac();n.Ab(1),n.xc(r.getCarLinksErrorMsg)}}let Lr=(()=>{class r{constructor(r,e,a){this.firestore=r,this.subjectsService=e,this.router=a,this.carLinks=[]}ngOnInit(){this.isLoadingSub=this.subjectsService.isLoadingSubject.subscribe(r=>{this.isLoading=r}),this.firestore.getSecondHandCarsLink().subscribe(r=>{this.carLinks=r.map(r=>Object.assign({id:r.payload.doc.id},r.payload.doc.data())),this.subjectsService.loaded(),this.getCarLinksErrorMsg=null},r=>{this.subjectsService.loaded(),this.getCarLinksErrorMsg=r.message});const r=JSON.parse(localStorage.getItem("sell-buy-car/buy-LastVisitedLink")),e=JSON.parse(localStorage.getItem("sell-buy-car-LastVisitedLink"));r&&"/sell-buy-car/buy"==e.toString()&&this.router.navigate([r])}ngOnDestroy(){this.isLoadingSub.unsubscribe()}}return r.\u0275fac=function(e){return new(e||r)(n.Lb(m.a),n.Lb(h.a),n.Lb(c.b))},r.\u0275cmp=n.Fb({type:r,selectors:[["app-buy-car"]],decls:3,vars:3,consts:[["class","error-msg",4,"ngIf"],[3,"carLinks","currentLink"],[1,"error-msg"]],template:function(r,e){1&r&&(n.Rb(0,"div"),n.uc(1,Rr,2,1,"p",0),n.Mb(2,"app-categories-router",1),n.Qb()),2&r&&(n.Ab(1),n.gc("ngIf",e.getCarLinksErrorMsg),n.Ab(1),n.gc("carLinks",e.carLinks)("currentLink","sell-buy-car/buy"))},directives:[t.l,vr.a],encapsulation:2}),r})();var Fr=a("PCNd");let wr=(()=>{class r{}return r.\u0275mod=n.Jb({type:r}),r.\u0275inj=n.Ib({factory:function(e){return new(e||r)},imports:[[t.c,i.o,Fr.a,s.b,c.e.forChild([{path:"",component:u,canActivate:[b.a],children:[{path:"buy",component:Lr,children:[{path:"audi",component:J},{path:"bmw",component:W},{path:"**",redirectTo:"audi"}]},{path:"sell",component:Cr},{path:"**",redirectTo:"buy"}]}])]]}),r})()}}]);