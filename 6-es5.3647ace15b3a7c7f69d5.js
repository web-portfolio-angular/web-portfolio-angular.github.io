!function(){function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UyQ7:function(t,r,o){"use strict";o.r(r),o.d(r,"CommentsModule",(function(){return w}));var i=o("ofXK"),b=o("3Pt+"),c=o("tyNb"),a=o("Wcq6"),m=o("fXoL"),s=o("T/S4"),l=o("IYfF"),u=o("zy28");function f(e,n){1&e&&m.Lb(0,"app-loading-spinner")}function d(e,n){if(1&e&&(m.Nb(0,"div",19),m.Nb(1,"div",9),m.Nb(2,"p",10),m.kc(3),m.Mb(),m.Nb(4,"p",11),m.kc(5),m.Xb(6,"date"),m.Xb(7,"date"),m.Mb(),m.Mb(),m.Nb(8,"div",12),m.Nb(9,"p",13),m.kc(10),m.Mb(),m.Mb(),m.Mb()),2&e){var t=n.$implicit;m.Ab(3),m.mc(" ",t.name," "),m.Ab(2),m.nc(" ",m.Yb(6,4,t.date.toDate(),"dd.MM.yyyy")," at ",m.Yb(7,7,t.date.toDate(),"HH:mm")," "),m.Ab(5),m.lc(t.comment)}}function p(e,n){if(1&e){var t=m.Ob();m.Nb(0,"button",20),m.Ub("click",(function(){m.gc(t);var e=m.Wb().$implicit;return m.Wb().isReply=e.id})),m.kc(1,"Reply"),m.Mb()}}function g(e,n){if(1&e){var t=m.Ob();m.Nb(0,"button",20),m.Ub("click",(function(){return m.gc(t),m.Wb(2).isReply=null})),m.kc(1,"Close Reply"),m.Mb()}}function y(e,n){if(1&e&&(m.Nb(0,"p",25),m.kc(1),m.Mb()),2&e){var t=m.Wb(3);m.Ab(1),m.lc(t.errorMsgOnReply)}}function v(e,n){if(1&e){var t=m.Ob();m.Nb(0,"form",21),m.Ub("ngSubmit",(function(){m.gc(t);var e=m.Wb().$implicit,n=m.Wb();return n.onReply(e.name,e.date,e.comment,e.id,n.replyForm)})),m.Nb(1,"div"),m.Lb(2,"textarea",22),m.Mb(),m.Nb(3,"div"),m.Nb(4,"button",23),m.kc(5,"Add your comment"),m.Mb(),m.jc(6,y,2,1,"p",24),m.Mb(),m.Mb()}if(2&e){var r=m.Wb(2);m.bc("formGroup",r.replyForm),m.Ab(4),m.bc("disabled",!r.replyForm.valid),m.Ab(2),m.bc("ngIf",r.errorMsgOnReply)}}function M(e,n){if(1&e&&(m.Nb(0,"div",8),m.Nb(1,"div",9),m.Nb(2,"p",10),m.kc(3),m.Mb(),m.Nb(4,"p",11),m.kc(5),m.Xb(6,"date"),m.Xb(7,"date"),m.Mb(),m.Mb(),m.Nb(8,"div",12),m.Nb(9,"p",13),m.kc(10),m.Mb(),m.Nb(11,"div",14),m.jc(12,d,11,10,"div",15),m.Mb(),m.Nb(13,"div",16),m.jc(14,p,2,0,"button",17),m.jc(15,g,2,0,"button",17),m.Mb(),m.jc(16,v,7,3,"form",18),m.Mb(),m.Mb()),2&e){var t=n.$implicit,r=m.Wb();m.Ab(3),m.mc(" ",t.name," "),m.Ab(2),m.nc(" ",m.Yb(6,8,t.date.toDate(),"dd.MM.yyyy")," at ",m.Yb(7,11,t.date.toDate(),"HH:mm")," "),m.Ab(5),m.lc(t.comment),m.Ab(2),m.bc("ngForOf",t.replies),m.Ab(2),m.bc("ngIf",r.isAuth),m.Ab(1),m.bc("ngIf",r.isReply==t.id),m.Ab(1),m.bc("ngIf",r.isReply==t.id)}}function h(e,n){1&e&&(m.Nb(0,"div",26),m.Nb(1,"p"),m.kc(2,"Please Sign in to add your comment!"),m.Mb(),m.Mb())}function N(e,n){if(1&e&&(m.Nb(0,"p",25),m.kc(1),m.Mb()),2&e){var t=m.Wb(2);m.Ab(1),m.lc(t.errorMsgOnSubmit)}}function A(e,n){if(1&e&&(m.Nb(0,"p",25),m.kc(1),m.Mb()),2&e){var t=m.Wb(2);m.Ab(1),m.lc(t.errorMsgOnloadComments)}}function O(e,n){if(1&e){var t=m.Ob();m.Nb(0,"form",27),m.Ub("ngSubmit",(function(){m.gc(t);var e=m.Wb();return e.onSubmit(e.postForm)})),m.Nb(1,"div"),m.Lb(2,"textarea",28),m.Mb(),m.Nb(3,"div"),m.Nb(4,"button",23),m.kc(5,"Add your comment"),m.Mb(),m.jc(6,N,2,1,"p",24),m.Mb(),m.jc(7,A,2,1,"p",24),m.Mb()}if(2&e){var r=m.Wb();m.bc("formGroup",r.postForm),m.Ab(4),m.bc("disabled",!r.postForm.valid),m.Ab(2),m.bc("ngIf",r.errorMsgOnSubmit),m.Ab(1),m.bc("ngIf",r.errorMsgOnloadComments)}}var k,F,S=((k=function(){function t(n,r,o){e(this,t),this.firestore=n,this.formBuilder=r,this.authService=o,this.isAuth=!1,this.isLoading=!1,this.isReply=null,this.errorMsgOnloadComments=null,this.errorMsgOnSubmit=null,this.errorMsgOnReply=null}var r,o,i;return r=t,(o=[{key:"ngOnInit",value:function(){var e=this;this.subUser=this.authService.user.subscribe((function(n){e.isAuth=!!n})),this.isLoading=!0,this.firestore.getComments().subscribe((function(n){e.comments=n.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())})),e.isLoading=!1,e.errorMsgOnloadComments=null}),(function(n){e.isLoading=!1,e.errorMsgOnloadComments=n.message})),this.postForm=this.formBuilder.group({commentArea:new b.d(null,b.n.required)}),this.replyForm=this.formBuilder.group({replyArea:new b.d(null,b.n.required)})}},{key:"ngOnDestroy",value:function(){this.subUser.unsubscribe()}},{key:"onSubmit",value:function(e){var n=this;if(this.postForm.valid){var t=JSON.parse(localStorage.getItem("userAdditionalData"));if(t){var r=t[0].name,o=a.firestore.Timestamp.now();this.firestore.createComment({name:r,date:o,comment:e.value.commentArea}).then((function(){n.postForm.reset(),n.errorMsgOnSubmit=null})).catch((function(e){n.errorMsgOnSubmit=e.message}))}}}},{key:"onReply",value:function(e,n,t,r,o){var i=this;if(this.replyForm.valid){var b=JSON.parse(localStorage.getItem("userAdditionalData"));if(b){var c={name:e,date:n,comment:t,replies:[{name:b[0].name,date:a.firestore.Timestamp.now(),comment:o.value.replyArea}],id:r};this.firestore.updateComment(c).then((function(){i.isReply=null,i.replyForm.reset(),i.errorMsgOnReply=null})).catch((function(e){i.errorMsgOnReply=e.message}))}}}}])&&n(r.prototype,o),i&&n(r,i),t}()).\u0275fac=function(e){return new(e||k)(m.Kb(s.a),m.Kb(b.c),m.Kb(l.a))},k.\u0275cmp=m.Eb({type:k,selectors:[["app-comments"]],decls:10,vars:4,consts:[[1,"container"],[1,"comments-container",2,"position","relative"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[1,"comment-header"],[1,"comment-name"],[1,"comment-date"],[1,"comment-content"],[1,"comment-content-text"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply-btns"],["class","btn-default narrow-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"reply"],[1,"btn-default","narrow-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],["class","error-msg",4,"ngIf"],[1,"error-msg"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(e,n){1&e&&(m.Nb(0,"div",0),m.Nb(1,"div",1),m.jc(2,f,1,0,"app-loading-spinner",2),m.Nb(3,"p",3),m.kc(4,"Comments"),m.Mb(),m.Nb(5,"div"),m.jc(6,M,17,14,"div",4),m.Lb(7,"hr",5),m.jc(8,h,3,0,"div",6),m.jc(9,O,8,4,"form",7),m.Mb(),m.Mb(),m.Mb()),2&e&&(m.Ab(2),m.bc("ngIf",n.isLoading),m.Ab(4),m.bc("ngForOf",n.comments),m.Ab(2),m.bc("ngIf",!n.isAuth),m.Ab(1),m.bc("ngIf",n.isAuth&&null==n.isReply))},directives:[i.k,i.j,u.a,b.o,b.k,b.g,b.b,b.j,b.e],pipes:[i.d],encapsulation:2}),k),I=o("PCNd"),w=((F=function n(){e(this,n)}).\u0275mod=m.Ib({type:F}),F.\u0275inj=m.Hb({factory:function(e){return new(e||F)},imports:[[i.b,I.a,b.m,c.f.forChild([{path:"",component:S}])]]}),F)}}])}();