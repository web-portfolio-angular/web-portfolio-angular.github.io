(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UyQ7:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentsModule",(function(){return Z}));var c=n("ofXK"),i=n("3Pt+"),o=n("tyNb"),s=n("Wcq6"),r=n("fXoL"),b=n("T/S4"),a=n("IYfF"),m=n("V86y"),l=n("zy28"),d=n("lJxs");let u=(()=>{class e{constructor(e){this.firestore=e}transform(e,t){return this.firestore.getRegistration(e).pipe(Object(d.a)(e=>{const n=e.map(e=>Object.assign({id:e.payload.doc.id},e.payload.doc.data()));switch(t){case"name":return n[0].name;case"phoneCode":return n[0].phoneCode;case"phone":return n[0].phone;case"userImg":return n[0].userImg}}))}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(b.a))},e.\u0275pipe=r.Kb({name:"getImage",type:e,pure:!0}),e})();function f(e,t){1&e&&r.Mb(0,"app-loading-spinner")}const p=function(e){return{"background-image":e}};function g(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",22),r.Qb(1,"div",23),r.Qb(2,"div",24),r.Xb("click",(function(){return r.lc(e),r.Zb(2).closeUserInfo()})),r.sc(3,"X"),r.Pb(),r.Mb(4,"div",25),r.ac(5,"async"),r.ac(6,"getImage"),r.Qb(7,"div",26),r.Qb(8,"div",27),r.Mb(9,"img",28),r.Pb(),r.Qb(10,"div"),r.sc(11),r.ac(12,"async"),r.ac(13,"getImage"),r.Pb(),r.Pb(),r.Qb(14,"div",26),r.Qb(15,"div",27),r.Mb(16,"img",29),r.Pb(),r.Qb(17,"div"),r.Qb(18,"span"),r.sc(19),r.ac(20,"async"),r.ac(21,"getImage"),r.Pb(),r.Qb(22,"span"),r.sc(23),r.ac(24,"async"),r.ac(25,"getImage"),r.Pb(),r.Pb(),r.Pb(),r.Qb(26,"div",26),r.Qb(27,"div",27),r.Mb(28,"img",30),r.Pb(),r.Qb(29,"div"),r.Qb(30,"a",31),r.sc(31),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(32,"div",32),r.Xb("click",(function(){return r.lc(e),r.Zb(2).closeUserInfo()})),r.Pb(),r.Pb()}if(2&e){const e=r.Zb().$implicit;r.Ab(4),r.fc("ngStyle",r.ic(26,p,"url("+r.bc(5,6,r.cc(6,8,e.email,"userImg"))+")")),r.Ab(7),r.uc(" ",r.bc(12,11,r.cc(13,13,e.email,"name"))," "),r.Ab(8),r.uc(" +",r.bc(20,16,r.cc(21,18,e.email,"phoneCode"))," "),r.Ab(4),r.uc(" ",r.bc(24,21,r.cc(25,23,e.email,"phone"))," "),r.Ab(7),r.gc("href","mailto:",e.email,"",r.mc),r.Ab(1),r.tc(e.email)}}function h(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",22),r.Qb(1,"div",23),r.Qb(2,"div",24),r.Xb("click",(function(){return r.lc(e),r.Zb(3).closeUserInfo()})),r.sc(3,"X"),r.Pb(),r.Mb(4,"div",25),r.ac(5,"async"),r.ac(6,"getImage"),r.Qb(7,"div",26),r.Qb(8,"div",27),r.Mb(9,"img",28),r.Pb(),r.Qb(10,"div"),r.sc(11),r.ac(12,"async"),r.ac(13,"getImage"),r.Pb(),r.Pb(),r.Qb(14,"div",26),r.Qb(15,"div",27),r.Mb(16,"img",29),r.Pb(),r.Qb(17,"div"),r.Qb(18,"span"),r.sc(19),r.ac(20,"async"),r.ac(21,"getImage"),r.Pb(),r.Qb(22,"span"),r.sc(23),r.ac(24,"async"),r.ac(25,"getImage"),r.Pb(),r.Pb(),r.Pb(),r.Qb(26,"div",26),r.Qb(27,"div",27),r.Mb(28,"img",30),r.Pb(),r.Qb(29,"div"),r.Qb(30,"a",31),r.sc(31),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(32,"div",32),r.Xb("click",(function(){return r.lc(e),r.Zb(3).closeUserInfo()})),r.Pb(),r.Pb()}if(2&e){const e=r.Zb().$implicit;r.Ab(4),r.fc("ngStyle",r.ic(26,p,"url("+r.bc(5,6,r.cc(6,8,e.email,"userImg"))+")")),r.Ab(7),r.uc(" ",r.bc(12,11,r.cc(13,13,e.email,"name"))," "),r.Ab(8),r.uc(" +",r.bc(20,16,r.cc(21,18,e.email,"phoneCode"))," "),r.Ab(4),r.uc(" ",r.bc(24,21,r.cc(25,23,e.email,"phone"))," "),r.Ab(7),r.gc("href","mailto:",e.email,"",r.mc),r.Ab(1),r.tc(e.email)}}function y(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",33),r.Qb(1,"div",9),r.Qb(2,"div",10),r.Xb("click",(function(){r.lc(e);const n=t.$implicit;return r.Zb(2).onShowUserInfo(n.id)})),r.Mb(3,"div",11),r.ac(4,"async"),r.ac(5,"getImage"),r.Qb(6,"p",12),r.sc(7),r.Pb(),r.Pb(),r.Qb(8,"p",13),r.sc(9),r.ac(10,"date"),r.ac(11,"date"),r.Pb(),r.rc(12,h,33,28,"div",14),r.Pb(),r.Qb(13,"div",15),r.Qb(14,"p",16),r.sc(15),r.Pb(),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.Zb(2);r.Ab(3),r.fc("ngStyle",r.ic(17,p,"url("+r.bc(4,6,r.cc(5,8,e.email,"userImg"))+")")),r.Ab(4),r.uc(" ",e.name," "),r.Ab(2),r.vc(" ",r.cc(10,11,e.date.toDate(),"dd.MM.yyyy")," at ",r.cc(11,14,e.date.toDate(),"HH:mm")," "),r.Ab(3),r.fc("ngIf",n.commentId==e.id&&n.showUserInfo),r.Ab(3),r.tc(e.comment)}}function v(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",34),r.Xb("click",(function(){r.lc(e);const t=r.Zb().$implicit;return r.Zb().isReply=t.id})),r.sc(1,"Reply"),r.Pb()}}function P(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",34),r.Xb("click",(function(){return r.lc(e),r.Zb(2).closeReplay()})),r.sc(1,"Close Reply"),r.Pb()}}function Q(e,t){if(1&e&&(r.Qb(0,"p",39),r.sc(1),r.Pb()),2&e){const e=r.Zb(3);r.Ab(1),r.tc(e.errorMsgOnReply)}}function I(e,t){if(1&e){const e=r.Rb();r.Qb(0,"form",35),r.Xb("ngSubmit",(function(){r.lc(e);const t=r.Zb().$implicit,n=r.Zb();return n.onReply(t.id,n.replyForm)})),r.Qb(1,"div"),r.Mb(2,"textarea",36),r.Pb(),r.Qb(3,"div"),r.Qb(4,"button",37),r.sc(5,"Add your comment"),r.Pb(),r.rc(6,Q,2,1,"p",38),r.Pb(),r.Pb()}if(2&e){const e=r.Zb(2);r.fc("formGroup",e.replyForm),r.Ab(4),r.fc("disabled",!e.replyForm.valid),r.Ab(2),r.fc("ngIf",e.errorMsgOnReply)}}function A(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",8),r.Qb(1,"div",9),r.Qb(2,"div",10),r.Xb("click",(function(){r.lc(e);const n=t.$implicit;return r.Zb().onShowUserInfo(n.id)})),r.Mb(3,"div",11),r.ac(4,"async"),r.ac(5,"getImage"),r.Qb(6,"p",12),r.sc(7),r.Pb(),r.Pb(),r.Qb(8,"p",13),r.sc(9),r.ac(10,"date"),r.ac(11,"date"),r.Pb(),r.rc(12,g,33,28,"div",14),r.Pb(),r.Qb(13,"div",15),r.Qb(14,"p",16),r.sc(15),r.Pb(),r.Qb(16,"div",17),r.rc(17,y,16,19,"div",18),r.Pb(),r.Qb(18,"div",19),r.rc(19,v,2,0,"button",20),r.rc(20,P,2,0,"button",20),r.Pb(),r.rc(21,I,7,3,"form",21),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.Zb();r.Ab(3),r.fc("ngStyle",r.ic(21,p,"url("+r.bc(4,10,r.cc(5,12,e.email,"userImg"))+")")),r.Ab(4),r.uc(" ",e.name," "),r.Ab(2),r.vc(" ",r.cc(10,15,e.date.toDate(),"dd.MM.yyyy")," at ",r.cc(11,18,e.date.toDate(),"HH:mm")," "),r.Ab(3),r.fc("ngIf",n.commentId==e.id&&n.showUserInfo),r.Ab(3),r.tc(e.comment),r.Ab(2),r.fc("ngForOf",e.replies),r.Ab(2),r.fc("ngIf",n.isAuth),r.Ab(1),r.fc("ngIf",n.isReply==e.id),r.Ab(1),r.fc("ngIf",n.isReply==e.id)}}function M(e,t){1&e&&(r.Qb(0,"div",40),r.Qb(1,"p"),r.sc(2,"Please Sign in to add your comment!"),r.Pb(),r.Pb())}function S(e,t){if(1&e&&(r.Qb(0,"p",39),r.sc(1),r.Pb()),2&e){const e=r.Zb(2);r.Ab(1),r.tc(e.errorMsgOnSubmit)}}function R(e,t){if(1&e&&(r.Qb(0,"p",39),r.sc(1),r.Pb()),2&e){const e=r.Zb(2);r.Ab(1),r.tc(e.errorMsgOnloadComments)}}function w(e,t){if(1&e){const e=r.Rb();r.Qb(0,"form",41),r.Xb("ngSubmit",(function(){r.lc(e);const t=r.Zb();return t.onSubmit(t.postForm)})),r.Qb(1,"div"),r.Mb(2,"textarea",42),r.Pb(),r.Qb(3,"div"),r.Qb(4,"button",37),r.sc(5,"Add your comment"),r.Pb(),r.rc(6,S,2,1,"p",38),r.Pb(),r.rc(7,R,2,1,"p",38),r.Pb()}if(2&e){const e=r.Zb();r.fc("formGroup",e.postForm),r.Ab(4),r.fc("disabled",!e.postForm.valid),r.Ab(2),r.fc("ngIf",e.errorMsgOnSubmit),r.Ab(1),r.fc("ngIf",e.errorMsgOnloadComments)}}let O=(()=>{class e{constructor(e,t,n,c){this.firestore=e,this.formBuilder=t,this.authService=n,this.additionUserInfoService=c,this.isAuth=!1,this.isLoading=!1,this.isReply=null,this.errorMsgOnloadComments=null,this.errorMsgOnSubmit=null,this.errorMsgOnReply=null,this.showUserInfo=!1,this.commentId=null}ngOnInit(){this.subUser=this.authService.user.subscribe(e=>{this.isAuth=!!e}),this.additionUserInfoService.getUserAdditionalData(),this.userAdditionalDataSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe(e=>{this.userAdditionalData=e}),this.isLoading=!0,this.firestore.getComments().subscribe(e=>{this.comments=e.map(e=>Object.assign({id:e.payload.doc.id},e.payload.doc.data())),this.isLoading=!1,this.errorMsgOnloadComments=null},e=>{this.isLoading=!1,this.errorMsgOnloadComments=e.message}),this.postForm=this.formBuilder.group({commentArea:new i.d(null,i.p.required)}),this.replyForm=this.formBuilder.group({replyArea:new i.d(null,i.p.required)})}ngOnDestroy(){this.subUser.unsubscribe(),this.userAdditionalDataSub.unsubscribe()}onSubmit(e){if(!this.postForm.valid)return;const t=this.userAdditionalData[0].name,n=this.userAdditionalData[0].email,c=s.firestore.Timestamp.now();this.firestore.createComment({name:t,email:n,date:c,comment:e.value.commentArea}).then(()=>{this.postForm.reset(),this.errorMsgOnSubmit=null}).catch(e=>{this.errorMsgOnSubmit=e.message})}onReply(e,t){if(!this.replyForm.valid)return;const n=this.userAdditionalData[0].name,c=this.userAdditionalData[0].email,i=s.firestore.Timestamp.now(),o=t.value.replyArea,r=this.generateReplayId();this.firestore.updateComment({name:n,email:c,date:i,comment:o,id:r,commentId:e}).then(()=>{this.isReply=null,this.replyForm.reset(),this.errorMsgOnReply=null}).catch(e=>{this.errorMsgOnReply=e.message})}generateReplayId(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=t.length;for(var c=0;c<20;c++)e+=t.charAt(Math.floor(Math.random()*n));return e}closeReplay(){this.isReply=null,this.replyForm.reset()}onShowUserInfo(e){this.commentId=e,this.showUserInfo=!0}closeUserInfo(){this.commentId=null,this.showUserInfo=!1}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(b.a),r.Lb(i.c),r.Lb(a.a),r.Lb(m.a))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-comments"]],decls:10,vars:4,consts:[[1,"container"],[1,"comments-container",2,"position","relative"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[1,"comment-header"],[1,"comment-header-left",3,"click"],[1,"comment-img",3,"ngStyle"],[1,"comment-name"],[1,"comment-date"],["class","comment-user-info-container",4,"ngIf"],[1,"comment-content"],[1,"comment-content-text"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply-btns"],["class","btn-default narrow-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment-user-info-container"],[1,"comment-user-info"],[1,"comment-user-info__close-btn",3,"click"],[1,"comment-user-info__avatar",3,"ngStyle"],[1,"comment-user-info__element"],[1,"comment-info-img"],["src","../../assets//img/sign/user.png"],["src","../../assets//img/sign/phone.png"],["src","../../assets//img/sign/email.png"],[3,"href"],[1,"comment-user-overlay",3,"click"],[1,"reply"],[1,"btn-default","narrow-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],["class","error-msg",4,"ngIf"],[1,"error-msg"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"div",1),r.rc(2,f,1,0,"app-loading-spinner",2),r.Qb(3,"p",3),r.sc(4,"Comments"),r.Pb(),r.Qb(5,"div"),r.rc(6,A,22,23,"div",4),r.Mb(7,"hr",5),r.rc(8,M,3,0,"div",6),r.rc(9,w,8,4,"form",7),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.Ab(2),r.fc("ngIf",t.isLoading),r.Ab(4),r.fc("ngForOf",t.comments),r.Ab(2),r.fc("ngIf",!t.isAuth),r.Ab(1),r.fc("ngIf",t.isAuth&&null==t.isReply))},directives:[c.l,c.k,l.a,c.m,i.q,i.l,i.g,i.b,i.k,i.e],pipes:[c.b,u,c.e],encapsulation:2}),e})();var F=n("PCNd");let Z=(()=>{class e{}return e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({factory:function(t){return new(t||e)},imports:[[c.c,F.a,i.o,o.e.forChild([{path:"",component:O}])]]}),e})()}}]);