!function(){function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UyQ7:function(n,r,o){"use strict";o.r(r),o.d(r,"CommentsModule",(function(){return _}));var i=o("ofXK"),s=o("3Pt+"),c=o("tyNb"),a=o("Wcq6"),b=o("fXoL"),m=o("T/S4"),u=o("IYfF"),l=o("V86y"),f=o("rL3l"),d=o("B02C"),p=o("zy28"),g=o("odcQ");function h(e,n){if(1&e&&(b.Rb(0,"p",8),b.xc(1),b.Qb()),2&e){var t=b.ac();b.Ab(1),b.yc(t.errorMsgOnGetUser)}}var v,y,R=function(e){return{"background-image":e}},A=((v=function(){function n(t,r){e(this,n),this.subjectsService=t,this.firestore=r,this.errorMsgOnGetUser=null}return t(n,[{key:"ngOnInit",value:function(){var e=this;this.shownUserSub=this.subjectsService.shownUserSubject.subscribe((function(n){e.shownUser=n}))}},{key:"ngOnDestroy",value:function(){this.shownUserSub.unsubscribe()}},{key:"onShowUserInfo",value:function(e){var n=this;this.firestore.getRegistration(e).subscribe((function(e){var t=e.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())}));n.subjectsService.onShowUserInfo({userImg:t[0].userImg,name:t[0].name,phoneCode:t[0].phoneCode,phone:t[0].phone,email:t[0].email}),n.errorMsgOnGetUser=null}),(function(e){n.errorMsgOnGetUser=e.message}))}}]),n}()).\u0275fac=function(e){return new(e||v)(b.Lb(f.a),b.Lb(m.a))},v.\u0275cmp=b.Fb({type:v,selectors:[["app-comment"]],inputs:{comment:"comment"},decls:15,vars:19,consts:[[1,"comment-header"],[1,"comment-header-left",3,"click"],[1,"comment-img",3,"ngStyle"],[1,"comment-name"],[1,"comment-date"],["class","error-msg",4,"ngIf"],[1,"comment-content"],[1,"comment-content-text"],[1,"error-msg"]],template:function(e,n){1&e&&(b.Rb(0,"div",0),b.Rb(1,"div",1),b.Yb("click",(function(){return n.onShowUserInfo(n.comment.email)})),b.Mb(2,"div",2),b.bc(3,"async"),b.bc(4,"getUserInfo"),b.Rb(5,"p",3),b.xc(6),b.Qb(),b.Qb(),b.Rb(7,"p",4),b.xc(8),b.bc(9,"date"),b.bc(10,"date"),b.Qb(),b.Qb(),b.vc(11,h,2,1,"p",5),b.Rb(12,"div",6),b.Rb(13,"p",7),b.xc(14),b.Qb(),b.Qb()),2&e&&(b.Ab(2),b.gc("ngStyle",b.kc(17,R,b.cc(3,6,b.dc(4,8,n.comment.email,"userImg")))),b.Ab(4),b.zc(" ",n.comment.name," "),b.Ab(2),b.Ac(" ",b.dc(9,11,n.comment.date.toDate(),"dd.MM.yyyy")," at ",b.dc(10,14,n.comment.date.toDate(),"HH:mm")," "),b.Ab(3),b.gc("ngIf",n.errorMsgOnGetUser),b.Ab(3),b.yc(n.comment.comment))},directives:[i.m,i.l],pipes:[i.b,g.a,i.e],encapsulation:2}),v),S=function(e){return{"background-image":e}},w=((y=function(){function n(t){e(this,n),this.subjectsService=t}return t(n,[{key:"ngOnInit",value:function(){}},{key:"closeUserInfo",value:function(){this.subjectsService.overlayClick()}}]),n}()).\u0275fac=function(e){return new(e||y)(b.Lb(f.a))},y.\u0275cmp=b.Fb({type:y,selectors:[["app-comment-user-info"]],inputs:{shownUser:"shownUser"},decls:22,vars:10,consts:[[1,"comment-user-info-container"],[1,"comment-user-info"],[1,"comment-user-info__close-btn",3,"click"],[1,"comment-user-info__avatar",3,"ngStyle"],[1,"comment-user-info__element"],[1,"comment-info-img"],["src","../../assets//img/sign/user.png"],["src","../../assets//img/sign/phone.png"],[3,"href"],["src","../../assets//img/sign/email.png"]],template:function(e,n){1&e&&(b.Rb(0,"div",0),b.Rb(1,"div",1),b.Rb(2,"div",2),b.Yb("click",(function(){return n.closeUserInfo()})),b.xc(3,"X"),b.Qb(),b.Mb(4,"div",3),b.Rb(5,"div",4),b.Rb(6,"div",5),b.Mb(7,"img",6),b.Qb(),b.Rb(8,"div"),b.xc(9),b.Qb(),b.Qb(),b.Rb(10,"div",4),b.Rb(11,"div",5),b.Mb(12,"img",7),b.Qb(),b.Rb(13,"div"),b.Rb(14,"a",8),b.xc(15),b.Qb(),b.Qb(),b.Qb(),b.Rb(16,"div",4),b.Rb(17,"div",5),b.Mb(18,"img",9),b.Qb(),b.Rb(19,"div"),b.Rb(20,"a",8),b.xc(21),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb()),2&e&&(b.Ab(4),b.gc("ngStyle",b.kc(8,S,"url("+n.shownUser.userImg+")")),b.Ab(5),b.zc(" ",n.shownUser.name," "),b.Ab(5),b.ic("href","tel:",n.shownUser.phoneCode,"",n.shownUser.phone,"",b.qc),b.Ab(1),b.Ac("+",n.shownUser.phoneCode,"",n.shownUser.phone,""),b.Ab(5),b.hc("href","mailto:",n.shownUser.email,"",b.qc),b.Ab(1),b.yc(n.shownUser.email))},directives:[i.m],encapsulation:2}),y);function I(e,n){1&e&&b.Mb(0,"app-loading-spinner")}function Q(e,n){if(1&e&&(b.Rb(0,"div",16),b.Mb(1,"app-comment",10),b.Qb()),2&e){var t=n.$implicit;b.Ab(1),b.gc("comment",t)}}function U(e,n){if(1&e){var t=b.Sb();b.Rb(0,"button",17),b.Yb("click",(function(){b.pc(t);var e=b.ac().$implicit;return b.ac().isReply=e.id})),b.xc(1,"Reply "),b.Qb()}}function M(e,n){if(1&e){var t=b.Sb();b.Rb(0,"button",17),b.Yb("click",(function(){return b.pc(t),b.ac(2).closeReplay()})),b.xc(1,"Close Reply "),b.Qb()}}function O(e,n){if(1&e&&(b.Rb(0,"p",22),b.xc(1),b.Qb()),2&e){var t=b.ac(3);b.Ab(1),b.yc(t.errorMsgOnReply)}}function k(e,n){if(1&e){var t=b.Sb();b.Rb(0,"form",18),b.Yb("ngSubmit",(function(){b.pc(t);var e=b.ac().$implicit,n=b.ac();return n.onReply(e.id,n.replyForm)})),b.Rb(1,"div"),b.Rb(2,"textarea",19),b.xc(3,"            "),b.Qb(),b.Qb(),b.Rb(4,"div"),b.Rb(5,"button",20),b.xc(6,"Add your comment"),b.Qb(),b.vc(7,O,2,1,"p",21),b.Qb(),b.Qb()}if(2&e){var r=b.ac().$implicit,o=b.ac();b.gc("formGroup",o.replyForm),b.Ab(5),b.gc("disabled",!o.replyForm.valid),b.Ab(2),b.gc("ngIf",o.errorMsgOnReply&&o.isReply==r.id)}}function F(e,n){if(1&e&&(b.Rb(0,"div",9),b.Mb(1,"app-comment",10),b.Rb(2,"div",11),b.vc(3,Q,2,1,"div",12),b.Qb(),b.Rb(4,"div",13),b.vc(5,U,2,0,"button",14),b.vc(6,M,2,0,"button",14),b.Qb(),b.vc(7,k,8,3,"form",15),b.Qb()),2&e){var t=n.$implicit,r=b.ac();b.Ab(1),b.gc("comment",t),b.Ab(2),b.gc("ngForOf",t.replies),b.Ab(2),b.gc("ngIf",r.isAuth),b.Ab(1),b.gc("ngIf",r.isReply==t.id),b.Ab(1),b.gc("ngIf",r.isReply==t.id)}}function x(e,n){if(1&e&&b.Mb(0,"app-comment-user-info",23),2&e){var t=b.ac();b.gc("shownUser",t.shownUser)}}function C(e,n){1&e&&(b.Rb(0,"div",24),b.Rb(1,"p"),b.xc(2,"Please Sign in to add your comment!"),b.Qb(),b.Qb())}function j(e,n){if(1&e&&(b.Rb(0,"p",22),b.xc(1),b.Qb()),2&e){var t=b.ac(2);b.Ab(1),b.yc(t.errorMsgOnSubmit)}}function L(e,n){if(1&e&&(b.Rb(0,"p",22),b.xc(1),b.Qb()),2&e){var t=b.ac(2);b.Ab(1),b.yc(t.errorMsgOnloadComments)}}function G(e,n){if(1&e){var t=b.Sb();b.Rb(0,"form",25),b.Yb("ngSubmit",(function(){b.pc(t);var e=b.ac();return e.onSubmit(e.postForm)})),b.Rb(1,"div"),b.Mb(2,"textarea",26),b.Qb(),b.Rb(3,"div"),b.Rb(4,"button",20),b.xc(5,"Add your comment"),b.Qb(),b.vc(6,j,2,1,"p",21),b.Qb(),b.vc(7,L,2,1,"p",21),b.Qb()}if(2&e){var r=b.ac();b.gc("formGroup",r.postForm),b.Ab(4),b.gc("disabled",!r.postForm.valid),b.Ab(2),b.gc("ngIf",r.errorMsgOnSubmit),b.Ab(1),b.gc("ngIf",r.errorMsgOnloadComments)}}var D,Y,q=((D=function(){function n(t,r,o,i,s,c){e(this,n),this.firestore=t,this.formBuilder=r,this.authService=o,this.additionUserInfoService=i,this.subjectsService=s,this.generateIdService=c,this.isAuth=!1,this.isLoading=!1,this.isReply=null,this.errorMsgOnloadComments=null,this.errorMsgOnSubmit=null,this.errorMsgOnReply=null}return t(n,[{key:"ngOnInit",value:function(){var e=this;this.subUser=this.authService.user.subscribe((function(n){e.isAuth=!!n})),this.userAdditionalInfoSub=this.additionUserInfoService.userAdditionalDataSubject.subscribe((function(n){e.userAdditionalData=n})),this.isLoading=!0,this.firestore.getComments().subscribe((function(n){e.comments=n.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())})),e.isLoading=!1,e.errorMsgOnloadComments=null}),(function(n){e.isLoading=!1,e.errorMsgOnloadComments=n.message})),this.postForm=this.formBuilder.group({commentArea:new s.d(null,s.p.required)}),this.replyForm=this.formBuilder.group({replyArea:new s.d(null,s.p.required)}),this.shownUserSub=this.subjectsService.shownUserSubject.subscribe((function(n){e.shownUser=n})),this.showUserInfoSub=this.subjectsService.showUserInfoSubject.subscribe((function(n){e.showUserInfo=n}))}},{key:"ngOnDestroy",value:function(){this.subUser.unsubscribe(),this.showUserInfoSub.unsubscribe(),this.shownUserSub.unsubscribe(),this.userAdditionalInfoSub.unsubscribe()}},{key:"onSubmit",value:function(e){var n=this;if(this.postForm.valid){var t=this.userAdditionalData[0].name,r=this.userAdditionalData[0].email,o=a.firestore.Timestamp.now(),i=e.value.commentArea.trim();""!=i?this.firestore.createComment({name:t,email:r,date:o,comment:i}).then((function(){n.postForm.reset(),n.errorMsgOnSubmit=null})).catch((function(e){n.errorMsgOnSubmit=e.message})):this.postForm.reset()}}},{key:"onReply",value:function(e,n){var t=this;if(this.replyForm.valid){var r=this.userAdditionalData[0].name,o=this.userAdditionalData[0].email,i=a.firestore.Timestamp.now(),s=n.value.replyArea.trim(),c=this.generateIdService.generateId();""!=s?this.firestore.updateComment({name:r,email:o,date:i,comment:s,id:c,commentId:e}).then((function(){t.isReply=null,t.replyForm.reset(),t.errorMsgOnReply=null})).catch((function(e){t.errorMsgOnReply=e.message})):this.replyForm.reset()}}},{key:"closeReplay",value:function(){this.isReply=null,this.replyForm.reset()}}]),n}()).\u0275fac=function(e){return new(e||D)(b.Lb(m.a),b.Lb(s.c),b.Lb(u.a),b.Lb(l.a),b.Lb(f.a),b.Lb(d.a))},D.\u0275cmp=b.Fb({type:D,selectors:[["app-comments"]],decls:11,vars:5,consts:[[1,"container"],[1,"comments-container"],[4,"ngIf"],[1,"comments-count"],["class","comment",4,"ngFor","ngForOf"],[3,"shownUser",4,"ngIf"],[1,"hr-border"],["class","comments-auth",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"comment"],[3,"comment"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply-btns"],["class","btn-default narrow-btn",3,"click",4,"ngIf"],["class","replyForm",3,"formGroup","ngSubmit",4,"ngIf"],[1,"reply"],[1,"btn-default","narrow-btn",3,"click"],[1,"replyForm",3,"formGroup","ngSubmit"],["placeholder","Type your reply...","formControlName","replyArea",1,"comments-textarea"],["type","submit",1,"btn-default","btn-default-center",3,"disabled"],["class","error-msg",4,"ngIf"],[1,"error-msg"],[3,"shownUser"],[1,"comments-auth"],[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"]],template:function(e,n){1&e&&(b.Rb(0,"div",0),b.Rb(1,"div",1),b.vc(2,I,1,0,"app-loading-spinner",2),b.Rb(3,"p",3),b.xc(4,"Comments"),b.Qb(),b.Rb(5,"div"),b.vc(6,F,8,5,"div",4),b.vc(7,x,1,1,"app-comment-user-info",5),b.Qb(),b.Mb(8,"hr",6),b.vc(9,C,3,0,"div",7),b.vc(10,G,8,4,"form",8),b.Qb(),b.Qb()),2&e&&(b.Ab(2),b.gc("ngIf",n.isLoading),b.Ab(4),b.gc("ngForOf",n.comments),b.Ab(1),b.gc("ngIf",n.showUserInfo),b.Ab(2),b.gc("ngIf",!n.isAuth),b.Ab(1),b.gc("ngIf",n.isAuth&&null==n.isReply))},directives:[i.l,i.k,p.a,A,s.q,s.l,s.g,s.b,s.k,s.e,w],encapsulation:2}),D),T=o("PCNd"),_=((Y=function n(){e(this,n)}).\u0275mod=b.Jb({type:Y}),Y.\u0275inj=b.Ib({factory:function(e){return new(e||Y)},imports:[[i.c,T.a,s.o,c.e.forChild([{path:"",component:q}])]]}),Y)}}])}();